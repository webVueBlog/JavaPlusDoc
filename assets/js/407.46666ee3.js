(window.webpackJsonp=window.webpackJsonp||[]).push([[407],{1234:function(t,e,a){"use strict";a.r(e);var _=a(1),v=Object(_.a)({},(function(){var t=this,e=t._self._c;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("blockquote",[e("p",[t._v("ç‚¹å‡»å‹˜è¯¯"),e("a",{attrs:{href:"https://github.com/webVueBlog/JavaPlusDoc/issues",target:"_blank",rel:"noopener noreferrer"}},[t._v("issues"),e("OutboundLink")],1),t._v("ï¼Œå“ªå’æ„Ÿè°¢å¤§å®¶çš„é˜…è¯»")])]),t._v(" "),e("img",{attrs:{align:"right",width:"100",src:"https://cdn.jsdelivr.net/gh/YunYouJun/yun/images/yun-alpha-compressed.png"}}),t._v(" "),e("h2",{attrs:{id:"é¢è¯•äº†ä¸€ä½åä¸ºçš„è¿ç»´ç¨‹åºå‘˜"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#é¢è¯•äº†ä¸€ä½åä¸ºçš„è¿ç»´ç¨‹åºå‘˜"}},[t._v("#")]),t._v(" é¢è¯•äº†ä¸€ä½åä¸ºçš„è¿ç»´ç¨‹åºå‘˜")]),t._v(" "),e("p",[t._v("åŠ ç¾¤è”ç³»ä½œè€…vxï¼šxiaoda0423")]),t._v(" "),e("p",[t._v("ä»“åº“åœ°å€ï¼š"),e("a",{attrs:{href:"https://webvueblog.github.io/JavaPlusDoc/",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://webvueblog.github.io/JavaPlusDoc/"),e("OutboundLink")],1)]),t._v(" "),e("p",[e("a",{attrs:{href:"https://1024bat.cn/",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://1024bat.cn/"),e("OutboundLink")],1)]),t._v(" "),e("p",[e("a",{attrs:{href:"https://github.com/webVueBlog/fastapi_plus",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/webVueBlog/fastapi_plus"),e("OutboundLink")],1)]),t._v(" "),e("p",[e("a",{attrs:{href:"https://webvueblog.github.io/JavaPlusDoc/",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://webvueblog.github.io/JavaPlusDoc/"),e("OutboundLink")],1)]),t._v(" "),e("p",[e("img",{attrs:{src:"https://p0-xtjj-private.juejin.cn/tos-cn-i-73owjymdk6/910a42c0866944828050590a08aa1c0b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oiR5piv5ZOq5ZCS:q75.awebp?policy=eyJ2bSI6MywidWlkIjoiMTQ1MTAxMTA4MTI0OTE3NSJ9&rk3s=f64ab15b&x-orig-authkey=f32326d3454f2ac7e96d3d06cdbb035152127018&x-orig-expires=1748148710&x-orig-sign=qKUomqA5tCDkjtLqHJ3sfEQIDyw%3D",alt:"1747398531175.png"}})]),t._v(" "),e("p",[e("img",{attrs:{src:"https://p0-xtjj-private.juejin.cn/tos-cn-i-73owjymdk6/e80abd3e725f4df2bd88d1048e95abd1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oiR5piv5ZOq5ZCS:q75.awebp?policy=eyJ2bSI6MywidWlkIjoiMTQ1MTAxMTA4MTI0OTE3NSJ9&rk3s=f64ab15b&x-orig-authkey=f32326d3454f2ac7e96d3d06cdbb035152127018&x-orig-expires=1748148710&x-orig-sign=Ea0%2Fa2UV%2Fy4bYaECd7qbFI2wAX0%3D",alt:"c107163de49f6fc1cbd68a89b3efbb7.png"}})]),t._v(" "),e("p",[e("img",{attrs:{src:"https://p0-xtjj-private.juejin.cn/tos-cn-i-73owjymdk6/d288677a72d5439fbb382c242ca14f84~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oiR5piv5ZOq5ZCS:q75.awebp?policy=eyJ2bSI6MywidWlkIjoiMTQ1MTAxMTA4MTI0OTE3NSJ9&rk3s=f64ab15b&x-orig-authkey=f32326d3454f2ac7e96d3d06cdbb035152127018&x-orig-expires=1748148710&x-orig-sign=7v6Y2IND67CYYhkbNaFhr8A2gRw%3D",alt:"6327739dd05338076e9df089567c865.png"}})]),t._v(" "),e("p",[e("img",{attrs:{src:"https://p0-xtjj-private.juejin.cn/tos-cn-i-73owjymdk6/ae94d9aa64c04a8b9b13b08a6d56d270~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oiR5piv5ZOq5ZCS:q75.awebp?policy=eyJ2bSI6MywidWlkIjoiMTQ1MTAxMTA4MTI0OTE3NSJ9&rk3s=f64ab15b&x-orig-authkey=f32326d3454f2ac7e96d3d06cdbb035152127018&x-orig-expires=1748148710&x-orig-sign=CYzSjy6dzN4wMQLaA7a6QZBSFYE%3D",alt:"14bb523191893f5cdd95664610aed22.png"}})]),t._v(" "),e("h2",{attrs:{id:"âœ…-ä¸€ã€ä½¿ç”¨-nginx-æˆ–-apache-é…ç½®åå‘ä»£ç†ä¸è´Ÿè½½å‡è¡¡"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#âœ…-ä¸€ã€ä½¿ç”¨-nginx-æˆ–-apache-é…ç½®åå‘ä»£ç†ä¸è´Ÿè½½å‡è¡¡"}},[t._v("#")]),t._v(" âœ… ä¸€ã€ä½¿ç”¨ Nginx æˆ– Apache é…ç½®åå‘ä»£ç†ä¸è´Ÿè½½å‡è¡¡")]),t._v(" "),e("h3",{attrs:{id:"ğŸ”¹-nginx-é…ç½®-æ¨èç”¨äºç°ä»£éƒ¨ç½²"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ”¹-nginx-é…ç½®-æ¨èç”¨äºç°ä»£éƒ¨ç½²"}},[t._v("#")]),t._v(" ğŸ”¹ Nginx é…ç½®ï¼ˆæ¨èç”¨äºç°ä»£éƒ¨ç½²ï¼‰")]),t._v(" "),e("h4",{attrs:{id:"_1-å®‰è£…-nginx-ä»¥-centos-ä¸ºä¾‹"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-å®‰è£…-nginx-ä»¥-centos-ä¸ºä¾‹"}},[t._v("#")]),t._v(" 1. å®‰è£… Nginxï¼ˆä»¥ CentOS ä¸ºä¾‹ï¼‰ï¼š")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",[e("code",[t._v("sudo yum install nginx -y\nsudo systemctl enable nginx\nsudo systemctl start nginx\n")])])]),e("h4",{attrs:{id:"_2-é…ç½®åå‘ä»£ç†-etc-nginx-conf-d-ops-dashboard-conf"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-é…ç½®åå‘ä»£ç†-etc-nginx-conf-d-ops-dashboard-conf"}},[t._v("#")]),t._v(" 2. é…ç½®åå‘ä»£ç† "),e("code",[t._v("/etc/nginx/conf.d/ops_dashboard.conf")])]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",[e("code",[t._v("server {\n    listen 80;\n    server_name your-domain.com;\n\n    location / {\n        root /path/to/frontend;  # æ›¿æ¢æˆ index.html æ‰€åœ¨ç›®å½•\n        index index.html;\n        try_files $uri $uri/ /index.html;\n    }\n\n    location /api/ {\n        proxy_pass http://127.0.0.1:5000;  # Flask åç«¯\n        proxy_set_header Host $host;\n        proxy_set_header X-Real-IP $remote_addr;\n        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n    }\n}\n")])])]),e("h4",{attrs:{id:"_3-è´Ÿè½½å‡è¡¡-å¦‚å¤šä¸ª-flask-åç«¯"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-è´Ÿè½½å‡è¡¡-å¦‚å¤šä¸ª-flask-åç«¯"}},[t._v("#")]),t._v(" 3. è´Ÿè½½å‡è¡¡ï¼ˆå¦‚å¤šä¸ª Flask åç«¯ï¼‰ï¼š")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",[e("code",[t._v("upstream backend {\n    server 127.0.0.1:5000;\n    server 127.0.0.1:5001;\n}\n\nserver {\n    listen 80;\n    server_name your-domain.com;\n\n    location /api/ {\n        proxy_pass http://backend;\n    }\n}\n")])])]),e("hr"),t._v(" "),e("h3",{attrs:{id:"ğŸ”¹-apache-é…ç½®-å¦‚æœä½ å·²æœ‰-apache-ç¯å¢ƒ"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ”¹-apache-é…ç½®-å¦‚æœä½ å·²æœ‰-apache-ç¯å¢ƒ"}},[t._v("#")]),t._v(" ğŸ”¹ Apache é…ç½®ï¼ˆå¦‚æœä½ å·²æœ‰ Apache ç¯å¢ƒï¼‰")]),t._v(" "),e("h4",{attrs:{id:"_1-å¯ç”¨æ¨¡å—-ä»…é¦–æ¬¡"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-å¯ç”¨æ¨¡å—-ä»…é¦–æ¬¡"}},[t._v("#")]),t._v(" 1. å¯ç”¨æ¨¡å—ï¼ˆä»…é¦–æ¬¡ï¼‰ï¼š")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",[e("code",[t._v("a2enmod proxy\na2enmod proxy_http\na2enmod headers\n")])])]),e("h4",{attrs:{id:"_2-é…ç½®-etc-apache2-sites-available-ops-dashboard-conf"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-é…ç½®-etc-apache2-sites-available-ops-dashboard-conf"}},[t._v("#")]),t._v(" 2. é…ç½® "),e("code",[t._v("/etc/apache2/sites-available/ops_dashboard.conf")]),t._v("ï¼š")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",[e("code",[t._v("<VirtualHost *:80>\n    ServerName your-domain.com\n\n    DocumentRoot /var/www/html/frontend\n\n    <Directory /var/www/html/frontend>\n        Options Indexes FollowSymLinks\n        AllowOverride All\n        Require all granted\n    </Directory>\n\n    ProxyPreserveHost On\n    ProxyPass /api/ http://127.0.0.1:5000/api/\n    ProxyPassReverse /api/ http://127.0.0.1:5000/api/\n</VirtualHost>\n")])])]),e("hr"),t._v(" "),e("h2",{attrs:{id:"âœ…-äºŒã€ç³»ç»Ÿå†…æ ¸æ€§èƒ½ä¼˜åŒ–å»ºè®®-sysctl-conf"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#âœ…-äºŒã€ç³»ç»Ÿå†…æ ¸æ€§èƒ½ä¼˜åŒ–å»ºè®®-sysctl-conf"}},[t._v("#")]),t._v(" âœ… äºŒã€ç³»ç»Ÿå†…æ ¸æ€§èƒ½ä¼˜åŒ–å»ºè®®ï¼ˆsysctl.confï¼‰")]),t._v(" "),e("p",[t._v("ç¼–è¾‘ "),e("code",[t._v("/etc/sysctl.conf")]),t._v(" æ·»åŠ å¦‚ä¸‹é…ç½®ï¼Œç„¶åæ‰§è¡Œ "),e("code",[t._v("sysctl -p")]),t._v(" ç”Ÿæ•ˆï¼š")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",[e("code",[t._v("# æé«˜æ–‡ä»¶å¥æŸ„æ•°é‡\nfs.file-max = 1048576\n\n# TCP ä¼˜åŒ–\nnet.core.somaxconn = 65535\nnet.ipv4.tcp_max_syn_backlog = 8192\nnet.ipv4.tcp_syncookies = 1\nnet.ipv4.tcp_tw_reuse = 1\n\n# å‡å°‘ TIME_WAIT æ•°é‡\nnet.ipv4.tcp_fin_timeout = 15\nnet.ipv4.tcp_keepalive_time = 600\n\n# ç¦ç”¨ ICMP é‡å®šå‘ï¼ˆå®‰å…¨ï¼‰\nnet.ipv4.conf.all.accept_redirects = 0\nnet.ipv4.conf.all.send_redirects = 0\n")])])]),e("h3",{attrs:{id:"ğŸ§±-åŒæ—¶é…ç½®-limits-conf-æé«˜èµ„æºä¸Šé™"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ§±-åŒæ—¶é…ç½®-limits-conf-æé«˜èµ„æºä¸Šé™"}},[t._v("#")]),t._v(" ğŸ§± åŒæ—¶é…ç½® limits.conf æé«˜èµ„æºä¸Šé™")]),t._v(" "),e("p",[t._v("ç¼–è¾‘ "),e("code",[t._v("/etc/security/limits.conf")]),t._v("ï¼š")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",[e("code",[t._v("* soft nofile 1048576\n* hard nofile 1048576\n* soft nproc 65535\n* hard nproc 65535\n")])])]),e("hr"),t._v(" "),e("h2",{attrs:{id:"âœ…-ä¸‰ã€ç¦ç”¨æ— ç”¨æœåŠ¡-centos-rhel-ç³»ç»Ÿ"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#âœ…-ä¸‰ã€ç¦ç”¨æ— ç”¨æœåŠ¡-centos-rhel-ç³»ç»Ÿ"}},[t._v("#")]),t._v(" âœ… ä¸‰ã€ç¦ç”¨æ— ç”¨æœåŠ¡ï¼ˆCentOS/RHEL ç³»ç»Ÿï¼‰")]),t._v(" "),e("p",[t._v("ä½¿ç”¨ "),e("code",[t._v("systemctl")]),t._v(" æŸ¥çœ‹å¹¶å…³é—­ä¸å¿…è¦æœåŠ¡ï¼š")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",[e("code",[t._v("# æŸ¥çœ‹å¼€æœºå¯åŠ¨æœåŠ¡\nsystemctl list-unit-files --type=service | grep enabled\n\n# ç¦ç”¨ç¤ºä¾‹æœåŠ¡\nsudo systemctl disable bluetooth.service\nsudo systemctl disable firewalld.service\nsudo systemctl disable cups.service\nsudo systemctl disable avahi-daemon.service\n")])])]),e("p",[t._v("âš ï¸ æ³¨æ„ï¼šå…³é—­å‰è¯·ç¡®è®¤è¯¥æœåŠ¡å¯¹ä½ å½“å‰æœåŠ¡å™¨æ˜¯å¦å¿…è¦ã€‚")]),t._v(" "),e("ul",[e("li",[e("p",[e("strong",[t._v("CPU")]),t._v("ï¼šæ€»ã€åˆ†æ ¸ã€æ—¶é—´åˆ†å¸ƒã€æ ¸æ•°")])]),t._v(" "),e("li",[e("p",[e("strong",[t._v("å†…å­˜")]),t._v("ï¼šç‰©ç†å†…å­˜ã€Swapã€buffersã€cached")])]),t._v(" "),e("li",[e("p",[e("strong",[t._v("ç£ç›˜")]),t._v("ï¼šåˆ†åŒºä½¿ç”¨ï¼‹åˆ†ç›˜ IO ç»Ÿè®¡")])]),t._v(" "),e("li",[e("p",[e("strong",[t._v("ç½‘ç»œ")]),t._v("ï¼šæ¯ä¸ªç½‘å¡çš„æ”¶å‘æµé‡ç»Ÿè®¡")])]),t._v(" "),e("li",[e("p",[e("strong",[t._v("æ€»è§ˆæ¥å£")]),t._v(" "),e("code",[t._v("/api/monitor")]),t._v(" è¿”å›ç»“æ„åŒ– JSON")])]),t._v(" "),e("li",[e("p",[e("strong",[t._v("å¯¼å‡ºæ¥å£")]),t._v(" "),e("code",[t._v("/api/export")]),t._v(" å°†å…³é”®æŒ‡æ ‡å†™å…¥ Excel")])])]),t._v(" "),e("h2",{attrs:{id:"âœ…-1-éƒ¨ç½²æµç¨‹ä¸å‘å¸ƒæ–°ç‰ˆæœ¬"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#âœ…-1-éƒ¨ç½²æµç¨‹ä¸å‘å¸ƒæ–°ç‰ˆæœ¬"}},[t._v("#")]),t._v(" âœ… 1. éƒ¨ç½²æµç¨‹ä¸å‘å¸ƒæ–°ç‰ˆæœ¬")]),t._v(" "),e("h3",{attrs:{id:"ğŸš€-å¸¸è§éƒ¨ç½²æµç¨‹-devops-æµæ°´çº¿"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#ğŸš€-å¸¸è§éƒ¨ç½²æµç¨‹-devops-æµæ°´çº¿"}},[t._v("#")]),t._v(" ğŸš€ å¸¸è§éƒ¨ç½²æµç¨‹ï¼ˆDevOps æµæ°´çº¿ï¼‰")]),t._v(" "),e("ol",[e("li",[e("p",[e("strong",[t._v("ä»£ç æ„å»º")])]),t._v(" "),e("ul",[e("li",[t._v("ä½¿ç”¨ GitLab CI / Jenkins / GitHub Actions è‡ªåŠ¨æ‹‰å–ä»£ç ï¼Œæ‰§è¡Œæ„å»ºä»»åŠ¡ï¼ˆå¦‚ Mavenã€Webpackï¼‰")])])]),t._v(" "),e("li",[e("p",[e("strong",[t._v("æ‰“åŒ…å‘å¸ƒ")])]),t._v(" "),e("ul",[e("li",[t._v("æ„å»ºæˆ Docker é•œåƒï¼Œæ¨é€è‡³ç§æœ‰ä»“åº“ï¼ˆHarborï¼‰")]),t._v(" "),e("li",[t._v("æˆ–æ‰“æˆå‹ç¼©åŒ… / JAR åŒ…é€šè¿‡ SCP åˆ†å‘")])])]),t._v(" "),e("li",[e("p",[e("strong",[t._v("éƒ¨ç½²å‘å¸ƒ")])]),t._v(" "),e("ul",[e("li",[t._v("ä½¿ç”¨ Ansible / Shell è„šæœ¬éƒ¨ç½²åˆ°æœåŠ¡å™¨")]),t._v(" "),e("li",[t._v("æˆ–ä½¿ç”¨ K8sã€Docker Compose ç¼–æ’å‘å¸ƒæœåŠ¡")]),t._v(" "),e("li",[t._v("çƒ­éƒ¨ç½²ä½¿ç”¨ "),e("code",[t._v("soft reload")]),t._v("ï¼Œç°åº¦å‘å¸ƒä½¿ç”¨ Nginx + æ ‡ç­¾ç­–ç•¥ï¼ˆå¦‚ Istioï¼‰")])])]),t._v(" "),e("li",[e("p",[e("strong",[t._v("å›æ»šæœºåˆ¶")])]),t._v(" "),e("ul",[e("li",[t._v("ä¿ç•™æœ€è¿‘å‡ æ¬¡æ„å»ºåŒ… / é•œåƒ")]),t._v(" "),e("li",[t._v("æ”¯æŒå¿«é€Ÿä¸€é”®å›æ»š")])])])]),t._v(" "),e("hr"),t._v(" "),e("h2",{attrs:{id:"âœ…-2-é…ç½®å¼€æœºè‡ªå¯æœåŠ¡-å¤šç§æ–¹å¼"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#âœ…-2-é…ç½®å¼€æœºè‡ªå¯æœåŠ¡-å¤šç§æ–¹å¼"}},[t._v("#")]),t._v(" âœ… 2. é…ç½®å¼€æœºè‡ªå¯æœåŠ¡ï¼ˆå¤šç§æ–¹å¼ï¼‰")]),t._v(" "),e("h3",{attrs:{id:"âœ…-systemd-centos-7-ubuntu-16-æ¨è"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#âœ…-systemd-centos-7-ubuntu-16-æ¨è"}},[t._v("#")]),t._v(" âœ… Systemdï¼ˆCentOS 7+/Ubuntu 16+ æ¨èï¼‰")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",[e("code",[t._v("sudo vim /etc/systemd/system/myapp.service\n")])])]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",[e("code",[t._v("[Unit]\nDescription=My Flask Dashboard\nAfter=network.target\n\n[Service]\nUser=root\nWorkingDirectory=/opt/monitor-dashboard\nExecStart=/usr/bin/python3 /opt/monitor-dashboard/app.py\nRestart=always\n\n[Install]\nWantedBy=multi-user.target\n")])])]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",[e("code",[t._v("sudo systemctl daemon-reexec\nsudo systemctl enable myapp\nsudo systemctl start myapp\n")])])]),e("hr"),t._v(" "),e("h2",{attrs:{id:"âœ…-3-ç³»ç»Ÿèµ„æºä¼˜åŒ–æªæ–½-cpuã€å†…å­˜ã€ioã€ç½‘ç»œ"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#âœ…-3-ç³»ç»Ÿèµ„æºä¼˜åŒ–æªæ–½-cpuã€å†…å­˜ã€ioã€ç½‘ç»œ"}},[t._v("#")]),t._v(" âœ… 3. ç³»ç»Ÿèµ„æºä¼˜åŒ–æªæ–½ï¼ˆCPUã€å†…å­˜ã€IOã€ç½‘ç»œï¼‰")]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",[t._v("èµ„æºé¡¹")]),t._v(" "),e("th",[t._v("ä¼˜åŒ–æªæ–½ç¤ºä¾‹")])])]),t._v(" "),e("tbody",[e("tr",[e("td",[e("strong",[t._v("CPU")])]),t._v(" "),e("td",[t._v("åˆç†çº¿ç¨‹æ± é…ç½®ï¼ˆå¦‚ gunicornã€Java executorï¼‰ã€é¿å…æ­»å¾ªç¯ã€çƒ­ç‚¹ç¼“å­˜")])]),t._v(" "),e("tr",[e("td",[e("strong",[t._v("å†…å­˜")])]),t._v(" "),e("td",[t._v("ä½¿ç”¨ jemalloc / G1 GCï¼ˆJVMï¼‰ã€é‡Šæ”¾æ— ç”¨ç¼“å­˜ã€å®šæ—¶é‡å¯é•¿ç”Ÿå‘½å‘¨æœŸæœåŠ¡")])]),t._v(" "),e("tr",[e("td",[e("strong",[t._v("ç£ç›˜")])]),t._v(" "),e("td",[t._v("é…ç½® "),e("code",[t._v("logrotate")]),t._v("ã€ç›‘æ§ "),e("code",[t._v("/var/log")]),t._v("ã€å®šæœŸæ¸…ç†ç¼“å­˜")])]),t._v(" "),e("tr",[e("td",[e("strong",[t._v("IO")])]),t._v(" "),e("td",[t._v("ä½¿ç”¨ SSDã€å¼€å¯ "),e("code",[t._v("noatime")]),t._v("ã€å°½é‡ä½¿ç”¨å†…å­˜ç¼“å­˜è€Œéç£ç›˜ä¸­è½¬")])]),t._v(" "),e("tr",[e("td",[e("strong",[t._v("ç½‘ç»œ")])]),t._v(" "),e("td",[t._v("å†…éƒ¨æµé‡èµ°å†…ç½‘ã€ä½¿ç”¨ CDN åŠ é€Ÿã€è°ƒä¼˜ MTU / TCP å‚æ•°")])])])]),t._v(" "),e("blockquote",[e("p",[t._v("å¯ä½¿ç”¨ "),e("code",[t._v("vmstat")]),t._v(" / "),e("code",[t._v("iostat")]),t._v(" / "),e("code",[t._v("nmon")]),t._v(" / "),e("code",[t._v("htop")]),t._v(" / "),e("code",[t._v("free -m")]),t._v(" ç­‰å®æ—¶æŸ¥çœ‹èµ„æºç“¶é¢ˆ")])]),t._v(" "),e("hr"),t._v(" "),e("h2",{attrs:{id:"âœ…-4-å¸¸ç”¨çš„ç›‘æ§ç³»ç»Ÿ-åŠéƒ¨ç½²ç»éªŒ"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#âœ…-4-å¸¸ç”¨çš„ç›‘æ§ç³»ç»Ÿ-åŠéƒ¨ç½²ç»éªŒ"}},[t._v("#")]),t._v(" âœ… 4. å¸¸ç”¨çš„ç›‘æ§ç³»ç»Ÿï¼ˆåŠéƒ¨ç½²ç»éªŒï¼‰")]),t._v(" "),e("h3",{attrs:{id:"ğŸ§ -ä¸»æµç›‘æ§æ–¹æ¡ˆ"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ§ -ä¸»æµç›‘æ§æ–¹æ¡ˆ"}},[t._v("#")]),t._v(" ğŸ§  ä¸»æµç›‘æ§æ–¹æ¡ˆï¼š")]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",[t._v("å·¥å…·/å¹³å°")]),t._v(" "),e("th",[t._v("åŠŸèƒ½")]),t._v(" "),e("th",[t._v("éƒ¨ç½²ç»éªŒç®€è¿°")])])]),t._v(" "),e("tbody",[e("tr",[e("td",[e("strong",[t._v("Prometheus + Grafana")])]),t._v(" "),e("td",[t._v("åº”ç”¨æŒ‡æ ‡ç›‘æ§ï¼Œæ”¯æŒæŠ¥è­¦å’Œå¯è§†åŒ–")]),t._v(" "),e("td",[t._v("è‡ªå»ºæˆ– K8s å†…é›†æˆï¼ŒExporter å¤š")])]),t._v(" "),e("tr",[e("td",[e("strong",[t._v("Zabbix")])]),t._v(" "),e("td",[t._v("å…¨æ ˆç›‘æ§ï¼ˆä¸»æœº/ç«¯å£/æ—¥å¿—ï¼‰")]),t._v(" "),e("td",[t._v("é€‚åˆä¼ ç»Ÿæœºæˆ¿/å¤§å±å±•ç¤ºï¼ŒWeb é…ç½®")])]),t._v(" "),e("tr",[e("td",[e("strong",[t._v("ELK + Filebeat")])]),t._v(" "),e("td",[t._v("æ—¥å¿—é‡‡é›† + å®æ—¶æœç´¢ + å¯è§†åŒ–")]),t._v(" "),e("td",[t._v("æ—¥å¿—ç³»ç»Ÿé¦–é€‰ï¼ŒKibana åšå¤§å±")])]),t._v(" "),e("tr",[e("td",[e("strong",[t._v("Node Exporter")])]),t._v(" "),e("td",[t._v("é‡‡é›†ä¸»æœº CPU/å†…å­˜/ç£ç›˜ç­‰ç¡¬ä»¶æŒ‡æ ‡")]),t._v(" "),e("td",[t._v("ä¸ Prometheus é…åˆéƒ¨ç½²")])]),t._v(" "),e("tr",[e("td",[e("strong",[t._v("Alertmanager")])]),t._v(" "),e("td",[t._v("å‘Šè­¦é€šçŸ¥ï¼ˆé’‰é’‰/ä¼ä¸šå¾®ä¿¡/é‚®ä»¶ï¼‰")]),t._v(" "),e("td",[t._v("ä¸ Prometheus æ— ç¼é›†æˆ")])]),t._v(" "),e("tr",[e("td",[e("strong",[t._v("Skywalking / Jaeger")])]),t._v(" "),e("td",[t._v("é“¾è·¯è¿½è¸ªï¼ˆå¾®æœåŠ¡ï¼‰")]),t._v(" "),e("td",[t._v("ç”¨äºåˆ†æè¯·æ±‚ç“¶é¢ˆå’Œæ…¢æ¥å£")])])])]),t._v(" "),e("hr"),t._v(" "),e("h2",{attrs:{id:"ğŸ§©-ç¤ºä¾‹-ä¸€å¥—å®ç”¨çš„è¿ç»´ä½“ç³»ç»“æ„å›¾"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ§©-ç¤ºä¾‹-ä¸€å¥—å®ç”¨çš„è¿ç»´ä½“ç³»ç»“æ„å›¾"}},[t._v("#")]),t._v(" ğŸ§© ç¤ºä¾‹ï¼šä¸€å¥—å®ç”¨çš„è¿ç»´ä½“ç³»ç»“æ„å›¾")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",[e("code",[t._v("         +----------------------+\n         |      Prometheus      |\n         |      Alertmanager    |\n         +----------------------+\n             â†‘         â†‘\n     +-------------+  +-------------+\n     | NodeExporter|  | Flask Exporter|\n     +-------------+  +-------------+\n             â†“\n        +---------+\n        | Grafana |     --\x3e å›¾è¡¨ & å¤§å±å±•ç¤º\n        +---------+\n\n       +---------------------------+\n       |     Filebeat â†’ Logstash  |\n       |     Elasticsearch â†’ Kibana|\n       +---------------------------+\n")])])]),e("h3",{attrs:{id:"ä¸€ã€åŸºæœ¬ä¿¡æ¯"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#ä¸€ã€åŸºæœ¬ä¿¡æ¯"}},[t._v("#")]),t._v(" ä¸€ã€åŸºæœ¬ä¿¡æ¯")]),t._v(" "),e("ul",[e("li",[e("strong",[t._v("nginx version: nginx/1.20.1")]),e("br"),t._v("\nNginx ä¸»ç‰ˆæœ¬å·æ˜¯ "),e("strong",[t._v("1.20.1")]),t._v("ã€‚")]),t._v(" "),e("li",[e("strong",[t._v("built by gcc 4.8.5 20150623 (Red Hat 4.8.5-44) (GCC)")]),e("br"),t._v("\nç¼–è¯‘ Nginx æ—¶ä½¿ç”¨çš„æ˜¯ "),e("strong",[t._v("GCC 4.8.5")]),t._v(" ç¼–è¯‘å™¨ã€‚")]),t._v(" "),e("li",[e("strong",[t._v("built with OpenSSL 1.1.1g FIPS 21 Apr 2020")]),e("br"),t._v("\né›†æˆçš„ "),e("strong",[t._v("OpenSSL")]),t._v(" ç‰ˆæœ¬æ˜¯ "),e("strong",[t._v("1.1.1g")]),t._v("ï¼Œå¹¶å¼€å¯äº† FIPSï¼ˆè”é‚¦ä¿¡æ¯å¤„ç†æ ‡å‡†ï¼‰æ”¯æŒï¼Œå‘å¸ƒæ—¥æœŸä¸º "),e("strong",[t._v("2020-04-21")]),t._v("ã€‚")]),t._v(" "),e("li",[e("strong",[t._v("TLS SNI support enabled")]),e("br"),t._v("\nå¯ç”¨äº† "),e("strong",[t._v("SNIï¼ˆServer Name Indicationï¼‰")]),t._v(" ï¼Œå¯ä»¥è®©åŒä¸€ä¸ª IP/ç«¯å£æ‰˜ç®¡å¤šä¸ª HTTPS åŸŸåã€‚")])]),t._v(" "),e("hr"),t._v(" "),e("h3",{attrs:{id:"äºŒã€è·¯å¾„é…ç½®"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#äºŒã€è·¯å¾„é…ç½®"}},[t._v("#")]),t._v(" äºŒã€è·¯å¾„é…ç½®")]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",[t._v("å‚æ•°")]),t._v(" "),e("th",[t._v("è¯´æ˜")])])]),t._v(" "),e("tbody",[e("tr",[e("td",[e("code",[t._v("--prefix=/usr/share/nginx")])]),t._v(" "),e("td",[t._v("å®‰è£…ç›®å½•çš„æ ¹è·¯å¾„")])]),t._v(" "),e("tr",[e("td",[e("code",[t._v("--sbin-path=/usr/sbin/nginx")])]),t._v(" "),e("td",[t._v("nginx å¯æ‰§è¡Œæ–‡ä»¶çš„å®Œæ•´è·¯å¾„")])]),t._v(" "),e("tr",[e("td",[e("code",[t._v("--modules-path=/usr/lib64/nginx/modules")])]),t._v(" "),e("td",[t._v("åŠ¨æ€æ¨¡å—ï¼ˆ"),e("code",[t._v(".so")]),t._v("ï¼‰é»˜è®¤æœç´¢è·¯å¾„")])]),t._v(" "),e("tr",[e("td",[e("code",[t._v("--conf-path=/etc/nginx/nginx.conf")])]),t._v(" "),e("td",[t._v("ä¸»é…ç½®æ–‡ä»¶è·¯å¾„")])]),t._v(" "),e("tr",[e("td",[e("code",[t._v("--error-log-path=/var/log/nginx/error.log")])]),t._v(" "),e("td",[t._v("é”™è¯¯æ—¥å¿—æ–‡ä»¶è·¯å¾„")])]),t._v(" "),e("tr",[e("td",[e("code",[t._v("--http-log-path=/var/log/nginx/access.log")])]),t._v(" "),e("td",[t._v("è®¿é—®æ—¥å¿—æ–‡ä»¶è·¯å¾„")])]),t._v(" "),e("tr",[e("td",[e("code",[t._v("--http-client-body-temp-path=/var/lib/nginx/tmp/client_body``--http-proxy-temp-path=/var/lib/nginx/tmp/proxy``--http-fastcgi-temp-path=/var/lib/nginx/tmp/fastcgi``--http-uwsgi-temp-path=/var/lib/nginx/tmp/uwsgi``--http-scgi-temp-path=/var/lib/nginx/tmp/scgi")])]),t._v(" "),e("td",[t._v("å„ç§ä¸´æ—¶æ–‡ä»¶ï¼ˆå®¢æˆ·ç«¯è¯·æ±‚ä½“ã€ä»£ç†ã€FastCGIã€uWSGIã€SCGIï¼‰çš„å­˜æ”¾ç›®å½•")])]),t._v(" "),e("tr",[e("td",[e("code",[t._v("--pid-path=/run/nginx.pid")])]),t._v(" "),e("td",[t._v("å­˜æ”¾ nginx ä¸»è¿›ç¨‹ PID æ–‡ä»¶çš„è·¯å¾„")])]),t._v(" "),e("tr",[e("td",[e("code",[t._v("--lock-path=/run/lock/subsys/nginx")])]),t._v(" "),e("td",[t._v("é”æ–‡ä»¶è·¯å¾„")])]),t._v(" "),e("tr",[e("td",[e("code",[t._v("--user=nginx --group=nginx")])]),t._v(" "),e("td",[t._v("è¿è¡Œ nginx worker è¿›ç¨‹æ‰€ç”¨çš„ç³»ç»Ÿç”¨æˆ·å’Œç”¨æˆ·ç»„")])])])]),t._v(" "),e("hr"),t._v(" "),e("h3",{attrs:{id:"ä¸‰ã€åŠŸèƒ½æ¨¡å—æ”¯æŒ"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#ä¸‰ã€åŠŸèƒ½æ¨¡å—æ”¯æŒ"}},[t._v("#")]),t._v(" ä¸‰ã€åŠŸèƒ½æ¨¡å—æ”¯æŒ")]),t._v(" "),e("ul",[e("li",[e("p",[e("strong",[t._v("å…¼å®¹æ€§ä¸è°ƒè¯•")])]),t._v(" "),e("ul",[e("li",[e("code",[t._v("--with-compat")]),t._v("ï¼šå…è®¸æ—§ç‰ˆæ¨¡å—äºŒè¿›åˆ¶å…¼å®¹")]),t._v(" "),e("li",[e("code",[t._v("--with-debug")]),t._v("ï¼šç¼–è¯‘æ—¶å¯ç”¨è°ƒè¯•æ—¥å¿—åŠŸèƒ½")])])]),t._v(" "),e("li",[e("p",[e("strong",[t._v("å¼‚æ­¥ä¸æ€§èƒ½")])]),t._v(" "),e("ul",[e("li",[e("code",[t._v("--with-file-aio")]),t._v("ï¼šæ–‡ä»¶å¼‚æ­¥ I/O æ”¯æŒ")]),t._v(" "),e("li",[e("code",[t._v("--with-google_perftools_module")]),t._v("ï¼šé›†æˆ Google æ€§èƒ½åˆ†æå·¥å…·ï¼ˆgperftoolsï¼‰æ¨¡å—")]),t._v(" "),e("li",[e("code",[t._v("--with-threads")]),t._v("ï¼šå¼€å¯å¤šçº¿ç¨‹æ”¯æŒ")])])]),t._v(" "),e("li",[e("p",[e("strong",[t._v("HTTP åŸºæœ¬æ‰©å±•")])]),t._v(" "),e("ul",[e("li",[e("code",[t._v("--with-http_addition_module")]),t._v("ï¼šå¯åœ¨å“åº”å°¾éƒ¨æˆ–å¤´éƒ¨æ·»åŠ å†…å®¹")]),t._v(" "),e("li",[e("code",[t._v("--with-http_auth_request_module")]),t._v("ï¼šæ”¯æŒå¤–éƒ¨æˆæƒå­è¯·æ±‚")]),t._v(" "),e("li",[e("code",[t._v("--with-http_dav_module")]),t._v("ï¼šWebDAV åè®®æ”¯æŒ")]),t._v(" "),e("li",[e("code",[t._v("--with-http_degradation_module")]),t._v("ï¼šè‡ªåŠ¨é™çº§æ¨¡å—")]),t._v(" "),e("li",[e("code",[t._v("--with-http_flv_module")]),t._v("ï¼šFLV è§†é¢‘æµæ”¯æŒ")]),t._v(" "),e("li",[e("code",[t._v("--with-http_gunzip_module")]),t._v("ï¼šåŠ¨æ€è§£å‹ gzip å†…å®¹")]),t._v(" "),e("li",[e("code",[t._v("--with-http_gzip_static_module")]),t._v("ï¼šé¢„å‹ç¼©æ–‡ä»¶ï¼ˆ.gzï¼‰ç›´æ¥æä¾›")]),t._v(" "),e("li",[e("code",[t._v("--with-http_mp4_module")]),t._v("ï¼šMP4 è§†é¢‘æµæ”¯æŒ")]),t._v(" "),e("li",[e("code",[t._v("--with-http_sub_module")]),t._v("ï¼šå“åº”å†…å®¹æ›¿æ¢ï¼ˆsub filterï¼‰")]),t._v(" "),e("li",[e("code",[t._v("--with-http_realip_module")]),t._v("ï¼šä»å¤´éƒ¨è·å–å®¢æˆ·ç«¯çœŸå® IP")]),t._v(" "),e("li",[e("code",[t._v("--with-http_secure_link_module")]),t._v("ï¼šå®‰å…¨é“¾æ¥éªŒè¯")]),t._v(" "),e("li",[e("code",[t._v("--with-http_slice_module")]),t._v("ï¼šSlice åˆ†ç‰‡ä¸‹è½½/åˆ†å‘")]),t._v(" "),e("li",[e("code",[t._v("--with-http_ssl_module")]),t._v("ï¼šSSL/TLS æ”¯æŒ")]),t._v(" "),e("li",[e("code",[t._v("--with-http_v2_module")]),t._v("ï¼šHTTP/2 æ”¯æŒ")]),t._v(" "),e("li",[e("code",[t._v("--with-http_stub_status_module")]),t._v("ï¼šå†…ç½®çŠ¶æ€ç›‘æ§æ¥å£ï¼ˆ"),e("code",[t._v("stub_status")]),t._v("ï¼‰")])])]),t._v(" "),e("li",[e("p",[e("strong",[t._v("åŠ¨æ€å¯é€‰æ¨¡å—")])]),t._v(" "),e("ul",[e("li",[e("code",[t._v("--with-http_image_filter_module=dynamic")]),t._v("ï¼šå›¾åƒå¤„ç†æ¨¡å—æŒ‰éœ€åŠ è½½")]),t._v(" "),e("li",[e("code",[t._v("--with-http_xslt_module=dynamic")]),t._v("ï¼šXSLT å¤„ç†æ¨¡å—æŒ‰éœ€åŠ è½½")]),t._v(" "),e("li",[e("code",[t._v("--with-http_perl_module=dynamic")]),t._v("ï¼šåµŒå…¥ Perl è„šæœ¬æ¨¡å—æŒ‰éœ€åŠ è½½")]),t._v(" "),e("li",[e("code",[t._v("--with-mail=dynamic --with-mail_ssl_module")]),t._v("ï¼šé‚®ä»¶ï¼ˆSMTP/IMAP/POP3ï¼‰ä»£ç†åŠ SSL æ¨¡å—æŒ‰éœ€åŠ è½½")]),t._v(" "),e("li",[e("code",[t._v("--with-stream=dynamic --with-stream_ssl_module --with-stream_ssl_preread_module")]),t._v("ï¼šTCP/UDP æµä»£ç†åŠ SSL æ”¯æŒæŒ‰éœ€åŠ è½½")])])]),t._v(" "),e("li",[e("p",[e("strong",[t._v("å…¶ä»–")])]),t._v(" "),e("ul",[e("li",[e("code",[t._v("--with-randrom_index_module")]),t._v("ï¼šéšæœºè¿”å›ç´¢å¼•æ–‡ä»¶")]),t._v(" "),e("li",[e("code",[t._v("--with-pcre --with-pcre-jit")]),t._v("ï¼šåŸºäº PCRE çš„æ­£åˆ™æ”¯æŒåŠ JIT åŠ é€Ÿ")])])])]),t._v(" "),e("hr"),t._v(" "),e("h3",{attrs:{id:"å››ã€ç¼–è¯‘ä¼˜åŒ–å‚æ•°"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#å››ã€ç¼–è¯‘ä¼˜åŒ–å‚æ•°"}},[t._v("#")]),t._v(" å››ã€ç¼–è¯‘ä¼˜åŒ–å‚æ•°")]),t._v(" "),e("ul",[e("li",[e("p",[e("code",[t._v("--with-cc-opt='-O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions -fstack-protector-strong --param=ssp-buffer-size=4 -grecord-gcc-switches -specs=/usr/lib/rpm/redhat/redhat-hardened-cc1 -m64 -mtune=generic'")])]),t._v(" "),e("ul",[e("li",[e("strong",[t._v("-O2")]),t._v("ï¼šä¼˜åŒ–çº§åˆ«")]),t._v(" "),e("li",[e("strong",[t._v("-g")]),t._v("ï¼šä¿ç•™è°ƒè¯•ç¬¦å·")]),t._v(" "),e("li",[e("strong",[t._v("-fstack-protector-strong")]),t._v("ï¼šå¼€å¯å †æ ˆæº¢å‡ºä¿æŠ¤")]),t._v(" "),e("li",[e("strong",[t._v("_FORTIFY_SOURCE")]),t._v("ï¼šå¢å¼ºè¿è¡Œæ—¶å®‰å…¨æ£€æŸ¥")]),t._v(" "),e("li",[e("strong",[t._v("-mtune=generic")]),t._v("ï¼šé’ˆå¯¹é€šç”¨ x86_64 ä¼˜åŒ–")])])]),t._v(" "),e("li",[e("p",[e("code",[t._v("--with-ld-opt='-Wl,-z,relro -specs=/usr/lib/rpm/redhat/redhat-hardened-ld -Wl,-E'")])]),t._v(" "),e("ul",[e("li",[e("strong",[t._v("-z relro")]),t._v("ï¼šåªè¯»é‡å®šä½èŠ‚ï¼Œå¢å¼ºäºŒè¿›åˆ¶å®‰å…¨")]),t._v(" "),e("li",[e("strong",[t._v("-Wl,-E")]),t._v("ï¼šå¯¼å‡ºç¬¦å·è¡¨ï¼Œå…¼å®¹åŠ¨æ€æ¨¡å—")])])])]),t._v(" "),e("hr")])}),[],!1,null,null,null);e.default=v.exports}}]);