(window.webpackJsonp=window.webpackJsonp||[]).push([[407],{1234:function(t,e,a){"use strict";a.r(e);var _=a(1),v=Object(_.a)({},(function(){var t=this,e=t._self._c;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("blockquote",[e("p",[t._v("点击勘误"),e("a",{attrs:{href:"https://github.com/webVueBlog/JavaPlusDoc/issues",target:"_blank",rel:"noopener noreferrer"}},[t._v("issues"),e("OutboundLink")],1),t._v("，哪吒感谢大家的阅读")])]),t._v(" "),e("img",{attrs:{align:"right",width:"100",src:"https://cdn.jsdelivr.net/gh/YunYouJun/yun/images/yun-alpha-compressed.png"}}),t._v(" "),e("h2",{attrs:{id:"面试了一位华为的运维程序员"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#面试了一位华为的运维程序员"}},[t._v("#")]),t._v(" 面试了一位华为的运维程序员")]),t._v(" "),e("p",[t._v("加群联系作者vx：xiaoda0423")]),t._v(" "),e("p",[t._v("仓库地址："),e("a",{attrs:{href:"https://webvueblog.github.io/JavaPlusDoc/",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://webvueblog.github.io/JavaPlusDoc/"),e("OutboundLink")],1)]),t._v(" "),e("p",[e("a",{attrs:{href:"https://1024bat.cn/",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://1024bat.cn/"),e("OutboundLink")],1)]),t._v(" "),e("p",[e("a",{attrs:{href:"https://github.com/webVueBlog/fastapi_plus",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/webVueBlog/fastapi_plus"),e("OutboundLink")],1)]),t._v(" "),e("p",[e("a",{attrs:{href:"https://webvueblog.github.io/JavaPlusDoc/",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://webvueblog.github.io/JavaPlusDoc/"),e("OutboundLink")],1)]),t._v(" "),e("p",[e("img",{attrs:{src:"https://p0-xtjj-private.juejin.cn/tos-cn-i-73owjymdk6/910a42c0866944828050590a08aa1c0b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oiR5piv5ZOq5ZCS:q75.awebp?policy=eyJ2bSI6MywidWlkIjoiMTQ1MTAxMTA4MTI0OTE3NSJ9&rk3s=f64ab15b&x-orig-authkey=f32326d3454f2ac7e96d3d06cdbb035152127018&x-orig-expires=1748148710&x-orig-sign=qKUomqA5tCDkjtLqHJ3sfEQIDyw%3D",alt:"1747398531175.png"}})]),t._v(" "),e("p",[e("img",{attrs:{src:"https://p0-xtjj-private.juejin.cn/tos-cn-i-73owjymdk6/e80abd3e725f4df2bd88d1048e95abd1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oiR5piv5ZOq5ZCS:q75.awebp?policy=eyJ2bSI6MywidWlkIjoiMTQ1MTAxMTA4MTI0OTE3NSJ9&rk3s=f64ab15b&x-orig-authkey=f32326d3454f2ac7e96d3d06cdbb035152127018&x-orig-expires=1748148710&x-orig-sign=Ea0%2Fa2UV%2Fy4bYaECd7qbFI2wAX0%3D",alt:"c107163de49f6fc1cbd68a89b3efbb7.png"}})]),t._v(" "),e("p",[e("img",{attrs:{src:"https://p0-xtjj-private.juejin.cn/tos-cn-i-73owjymdk6/d288677a72d5439fbb382c242ca14f84~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oiR5piv5ZOq5ZCS:q75.awebp?policy=eyJ2bSI6MywidWlkIjoiMTQ1MTAxMTA4MTI0OTE3NSJ9&rk3s=f64ab15b&x-orig-authkey=f32326d3454f2ac7e96d3d06cdbb035152127018&x-orig-expires=1748148710&x-orig-sign=7v6Y2IND67CYYhkbNaFhr8A2gRw%3D",alt:"6327739dd05338076e9df089567c865.png"}})]),t._v(" "),e("p",[e("img",{attrs:{src:"https://p0-xtjj-private.juejin.cn/tos-cn-i-73owjymdk6/ae94d9aa64c04a8b9b13b08a6d56d270~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oiR5piv5ZOq5ZCS:q75.awebp?policy=eyJ2bSI6MywidWlkIjoiMTQ1MTAxMTA4MTI0OTE3NSJ9&rk3s=f64ab15b&x-orig-authkey=f32326d3454f2ac7e96d3d06cdbb035152127018&x-orig-expires=1748148710&x-orig-sign=CYzSjy6dzN4wMQLaA7a6QZBSFYE%3D",alt:"14bb523191893f5cdd95664610aed22.png"}})]),t._v(" "),e("h2",{attrs:{id:"✅-一、使用-nginx-或-apache-配置反向代理与负载均衡"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#✅-一、使用-nginx-或-apache-配置反向代理与负载均衡"}},[t._v("#")]),t._v(" ✅ 一、使用 Nginx 或 Apache 配置反向代理与负载均衡")]),t._v(" "),e("h3",{attrs:{id:"🔹-nginx-配置-推荐用于现代部署"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#🔹-nginx-配置-推荐用于现代部署"}},[t._v("#")]),t._v(" 🔹 Nginx 配置（推荐用于现代部署）")]),t._v(" "),e("h4",{attrs:{id:"_1-安装-nginx-以-centos-为例"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-安装-nginx-以-centos-为例"}},[t._v("#")]),t._v(" 1. 安装 Nginx（以 CentOS 为例）：")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",[e("code",[t._v("sudo yum install nginx -y\nsudo systemctl enable nginx\nsudo systemctl start nginx\n")])])]),e("h4",{attrs:{id:"_2-配置反向代理-etc-nginx-conf-d-ops-dashboard-conf"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-配置反向代理-etc-nginx-conf-d-ops-dashboard-conf"}},[t._v("#")]),t._v(" 2. 配置反向代理 "),e("code",[t._v("/etc/nginx/conf.d/ops_dashboard.conf")])]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",[e("code",[t._v("server {\n    listen 80;\n    server_name your-domain.com;\n\n    location / {\n        root /path/to/frontend;  # 替换成 index.html 所在目录\n        index index.html;\n        try_files $uri $uri/ /index.html;\n    }\n\n    location /api/ {\n        proxy_pass http://127.0.0.1:5000;  # Flask 后端\n        proxy_set_header Host $host;\n        proxy_set_header X-Real-IP $remote_addr;\n        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n    }\n}\n")])])]),e("h4",{attrs:{id:"_3-负载均衡-如多个-flask-后端"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-负载均衡-如多个-flask-后端"}},[t._v("#")]),t._v(" 3. 负载均衡（如多个 Flask 后端）：")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",[e("code",[t._v("upstream backend {\n    server 127.0.0.1:5000;\n    server 127.0.0.1:5001;\n}\n\nserver {\n    listen 80;\n    server_name your-domain.com;\n\n    location /api/ {\n        proxy_pass http://backend;\n    }\n}\n")])])]),e("hr"),t._v(" "),e("h3",{attrs:{id:"🔹-apache-配置-如果你已有-apache-环境"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#🔹-apache-配置-如果你已有-apache-环境"}},[t._v("#")]),t._v(" 🔹 Apache 配置（如果你已有 Apache 环境）")]),t._v(" "),e("h4",{attrs:{id:"_1-启用模块-仅首次"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-启用模块-仅首次"}},[t._v("#")]),t._v(" 1. 启用模块（仅首次）：")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",[e("code",[t._v("a2enmod proxy\na2enmod proxy_http\na2enmod headers\n")])])]),e("h4",{attrs:{id:"_2-配置-etc-apache2-sites-available-ops-dashboard-conf"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-配置-etc-apache2-sites-available-ops-dashboard-conf"}},[t._v("#")]),t._v(" 2. 配置 "),e("code",[t._v("/etc/apache2/sites-available/ops_dashboard.conf")]),t._v("：")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",[e("code",[t._v("<VirtualHost *:80>\n    ServerName your-domain.com\n\n    DocumentRoot /var/www/html/frontend\n\n    <Directory /var/www/html/frontend>\n        Options Indexes FollowSymLinks\n        AllowOverride All\n        Require all granted\n    </Directory>\n\n    ProxyPreserveHost On\n    ProxyPass /api/ http://127.0.0.1:5000/api/\n    ProxyPassReverse /api/ http://127.0.0.1:5000/api/\n</VirtualHost>\n")])])]),e("hr"),t._v(" "),e("h2",{attrs:{id:"✅-二、系统内核性能优化建议-sysctl-conf"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#✅-二、系统内核性能优化建议-sysctl-conf"}},[t._v("#")]),t._v(" ✅ 二、系统内核性能优化建议（sysctl.conf）")]),t._v(" "),e("p",[t._v("编辑 "),e("code",[t._v("/etc/sysctl.conf")]),t._v(" 添加如下配置，然后执行 "),e("code",[t._v("sysctl -p")]),t._v(" 生效：")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",[e("code",[t._v("# 提高文件句柄数量\nfs.file-max = 1048576\n\n# TCP 优化\nnet.core.somaxconn = 65535\nnet.ipv4.tcp_max_syn_backlog = 8192\nnet.ipv4.tcp_syncookies = 1\nnet.ipv4.tcp_tw_reuse = 1\n\n# 减少 TIME_WAIT 数量\nnet.ipv4.tcp_fin_timeout = 15\nnet.ipv4.tcp_keepalive_time = 600\n\n# 禁用 ICMP 重定向（安全）\nnet.ipv4.conf.all.accept_redirects = 0\nnet.ipv4.conf.all.send_redirects = 0\n")])])]),e("h3",{attrs:{id:"🧱-同时配置-limits-conf-提高资源上限"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#🧱-同时配置-limits-conf-提高资源上限"}},[t._v("#")]),t._v(" 🧱 同时配置 limits.conf 提高资源上限")]),t._v(" "),e("p",[t._v("编辑 "),e("code",[t._v("/etc/security/limits.conf")]),t._v("：")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",[e("code",[t._v("* soft nofile 1048576\n* hard nofile 1048576\n* soft nproc 65535\n* hard nproc 65535\n")])])]),e("hr"),t._v(" "),e("h2",{attrs:{id:"✅-三、禁用无用服务-centos-rhel-系统"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#✅-三、禁用无用服务-centos-rhel-系统"}},[t._v("#")]),t._v(" ✅ 三、禁用无用服务（CentOS/RHEL 系统）")]),t._v(" "),e("p",[t._v("使用 "),e("code",[t._v("systemctl")]),t._v(" 查看并关闭不必要服务：")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",[e("code",[t._v("# 查看开机启动服务\nsystemctl list-unit-files --type=service | grep enabled\n\n# 禁用示例服务\nsudo systemctl disable bluetooth.service\nsudo systemctl disable firewalld.service\nsudo systemctl disable cups.service\nsudo systemctl disable avahi-daemon.service\n")])])]),e("p",[t._v("⚠️ 注意：关闭前请确认该服务对你当前服务器是否必要。")]),t._v(" "),e("ul",[e("li",[e("p",[e("strong",[t._v("CPU")]),t._v("：总、分核、时间分布、核数")])]),t._v(" "),e("li",[e("p",[e("strong",[t._v("内存")]),t._v("：物理内存、Swap、buffers、cached")])]),t._v(" "),e("li",[e("p",[e("strong",[t._v("磁盘")]),t._v("：分区使用＋分盘 IO 统计")])]),t._v(" "),e("li",[e("p",[e("strong",[t._v("网络")]),t._v("：每个网卡的收发流量统计")])]),t._v(" "),e("li",[e("p",[e("strong",[t._v("总览接口")]),t._v(" "),e("code",[t._v("/api/monitor")]),t._v(" 返回结构化 JSON")])]),t._v(" "),e("li",[e("p",[e("strong",[t._v("导出接口")]),t._v(" "),e("code",[t._v("/api/export")]),t._v(" 将关键指标写入 Excel")])])]),t._v(" "),e("h2",{attrs:{id:"✅-1-部署流程与发布新版本"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#✅-1-部署流程与发布新版本"}},[t._v("#")]),t._v(" ✅ 1. 部署流程与发布新版本")]),t._v(" "),e("h3",{attrs:{id:"🚀-常见部署流程-devops-流水线"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#🚀-常见部署流程-devops-流水线"}},[t._v("#")]),t._v(" 🚀 常见部署流程（DevOps 流水线）")]),t._v(" "),e("ol",[e("li",[e("p",[e("strong",[t._v("代码构建")])]),t._v(" "),e("ul",[e("li",[t._v("使用 GitLab CI / Jenkins / GitHub Actions 自动拉取代码，执行构建任务（如 Maven、Webpack）")])])]),t._v(" "),e("li",[e("p",[e("strong",[t._v("打包发布")])]),t._v(" "),e("ul",[e("li",[t._v("构建成 Docker 镜像，推送至私有仓库（Harbor）")]),t._v(" "),e("li",[t._v("或打成压缩包 / JAR 包通过 SCP 分发")])])]),t._v(" "),e("li",[e("p",[e("strong",[t._v("部署发布")])]),t._v(" "),e("ul",[e("li",[t._v("使用 Ansible / Shell 脚本部署到服务器")]),t._v(" "),e("li",[t._v("或使用 K8s、Docker Compose 编排发布服务")]),t._v(" "),e("li",[t._v("热部署使用 "),e("code",[t._v("soft reload")]),t._v("，灰度发布使用 Nginx + 标签策略（如 Istio）")])])]),t._v(" "),e("li",[e("p",[e("strong",[t._v("回滚机制")])]),t._v(" "),e("ul",[e("li",[t._v("保留最近几次构建包 / 镜像")]),t._v(" "),e("li",[t._v("支持快速一键回滚")])])])]),t._v(" "),e("hr"),t._v(" "),e("h2",{attrs:{id:"✅-2-配置开机自启服务-多种方式"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#✅-2-配置开机自启服务-多种方式"}},[t._v("#")]),t._v(" ✅ 2. 配置开机自启服务（多种方式）")]),t._v(" "),e("h3",{attrs:{id:"✅-systemd-centos-7-ubuntu-16-推荐"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#✅-systemd-centos-7-ubuntu-16-推荐"}},[t._v("#")]),t._v(" ✅ Systemd（CentOS 7+/Ubuntu 16+ 推荐）")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",[e("code",[t._v("sudo vim /etc/systemd/system/myapp.service\n")])])]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",[e("code",[t._v("[Unit]\nDescription=My Flask Dashboard\nAfter=network.target\n\n[Service]\nUser=root\nWorkingDirectory=/opt/monitor-dashboard\nExecStart=/usr/bin/python3 /opt/monitor-dashboard/app.py\nRestart=always\n\n[Install]\nWantedBy=multi-user.target\n")])])]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",[e("code",[t._v("sudo systemctl daemon-reexec\nsudo systemctl enable myapp\nsudo systemctl start myapp\n")])])]),e("hr"),t._v(" "),e("h2",{attrs:{id:"✅-3-系统资源优化措施-cpu、内存、io、网络"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#✅-3-系统资源优化措施-cpu、内存、io、网络"}},[t._v("#")]),t._v(" ✅ 3. 系统资源优化措施（CPU、内存、IO、网络）")]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",[t._v("资源项")]),t._v(" "),e("th",[t._v("优化措施示例")])])]),t._v(" "),e("tbody",[e("tr",[e("td",[e("strong",[t._v("CPU")])]),t._v(" "),e("td",[t._v("合理线程池配置（如 gunicorn、Java executor）、避免死循环、热点缓存")])]),t._v(" "),e("tr",[e("td",[e("strong",[t._v("内存")])]),t._v(" "),e("td",[t._v("使用 jemalloc / G1 GC（JVM）、释放无用缓存、定时重启长生命周期服务")])]),t._v(" "),e("tr",[e("td",[e("strong",[t._v("磁盘")])]),t._v(" "),e("td",[t._v("配置 "),e("code",[t._v("logrotate")]),t._v("、监控 "),e("code",[t._v("/var/log")]),t._v("、定期清理缓存")])]),t._v(" "),e("tr",[e("td",[e("strong",[t._v("IO")])]),t._v(" "),e("td",[t._v("使用 SSD、开启 "),e("code",[t._v("noatime")]),t._v("、尽量使用内存缓存而非磁盘中转")])]),t._v(" "),e("tr",[e("td",[e("strong",[t._v("网络")])]),t._v(" "),e("td",[t._v("内部流量走内网、使用 CDN 加速、调优 MTU / TCP 参数")])])])]),t._v(" "),e("blockquote",[e("p",[t._v("可使用 "),e("code",[t._v("vmstat")]),t._v(" / "),e("code",[t._v("iostat")]),t._v(" / "),e("code",[t._v("nmon")]),t._v(" / "),e("code",[t._v("htop")]),t._v(" / "),e("code",[t._v("free -m")]),t._v(" 等实时查看资源瓶颈")])]),t._v(" "),e("hr"),t._v(" "),e("h2",{attrs:{id:"✅-4-常用的监控系统-及部署经验"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#✅-4-常用的监控系统-及部署经验"}},[t._v("#")]),t._v(" ✅ 4. 常用的监控系统（及部署经验）")]),t._v(" "),e("h3",{attrs:{id:"🧠-主流监控方案"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#🧠-主流监控方案"}},[t._v("#")]),t._v(" 🧠 主流监控方案：")]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",[t._v("工具/平台")]),t._v(" "),e("th",[t._v("功能")]),t._v(" "),e("th",[t._v("部署经验简述")])])]),t._v(" "),e("tbody",[e("tr",[e("td",[e("strong",[t._v("Prometheus + Grafana")])]),t._v(" "),e("td",[t._v("应用指标监控，支持报警和可视化")]),t._v(" "),e("td",[t._v("自建或 K8s 内集成，Exporter 多")])]),t._v(" "),e("tr",[e("td",[e("strong",[t._v("Zabbix")])]),t._v(" "),e("td",[t._v("全栈监控（主机/端口/日志）")]),t._v(" "),e("td",[t._v("适合传统机房/大屏展示，Web 配置")])]),t._v(" "),e("tr",[e("td",[e("strong",[t._v("ELK + Filebeat")])]),t._v(" "),e("td",[t._v("日志采集 + 实时搜索 + 可视化")]),t._v(" "),e("td",[t._v("日志系统首选，Kibana 做大屏")])]),t._v(" "),e("tr",[e("td",[e("strong",[t._v("Node Exporter")])]),t._v(" "),e("td",[t._v("采集主机 CPU/内存/磁盘等硬件指标")]),t._v(" "),e("td",[t._v("与 Prometheus 配合部署")])]),t._v(" "),e("tr",[e("td",[e("strong",[t._v("Alertmanager")])]),t._v(" "),e("td",[t._v("告警通知（钉钉/企业微信/邮件）")]),t._v(" "),e("td",[t._v("与 Prometheus 无缝集成")])]),t._v(" "),e("tr",[e("td",[e("strong",[t._v("Skywalking / Jaeger")])]),t._v(" "),e("td",[t._v("链路追踪（微服务）")]),t._v(" "),e("td",[t._v("用于分析请求瓶颈和慢接口")])])])]),t._v(" "),e("hr"),t._v(" "),e("h2",{attrs:{id:"🧩-示例-一套实用的运维体系结构图"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#🧩-示例-一套实用的运维体系结构图"}},[t._v("#")]),t._v(" 🧩 示例：一套实用的运维体系结构图")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",[e("code",[t._v("         +----------------------+\n         |      Prometheus      |\n         |      Alertmanager    |\n         +----------------------+\n             ↑         ↑\n     +-------------+  +-------------+\n     | NodeExporter|  | Flask Exporter|\n     +-------------+  +-------------+\n             ↓\n        +---------+\n        | Grafana |     --\x3e 图表 & 大屏展示\n        +---------+\n\n       +---------------------------+\n       |     Filebeat → Logstash  |\n       |     Elasticsearch → Kibana|\n       +---------------------------+\n")])])]),e("h3",{attrs:{id:"一、基本信息"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#一、基本信息"}},[t._v("#")]),t._v(" 一、基本信息")]),t._v(" "),e("ul",[e("li",[e("strong",[t._v("nginx version: nginx/1.20.1")]),e("br"),t._v("\nNginx 主版本号是 "),e("strong",[t._v("1.20.1")]),t._v("。")]),t._v(" "),e("li",[e("strong",[t._v("built by gcc 4.8.5 20150623 (Red Hat 4.8.5-44) (GCC)")]),e("br"),t._v("\n编译 Nginx 时使用的是 "),e("strong",[t._v("GCC 4.8.5")]),t._v(" 编译器。")]),t._v(" "),e("li",[e("strong",[t._v("built with OpenSSL 1.1.1g FIPS 21 Apr 2020")]),e("br"),t._v("\n集成的 "),e("strong",[t._v("OpenSSL")]),t._v(" 版本是 "),e("strong",[t._v("1.1.1g")]),t._v("，并开启了 FIPS（联邦信息处理标准）支持，发布日期为 "),e("strong",[t._v("2020-04-21")]),t._v("。")]),t._v(" "),e("li",[e("strong",[t._v("TLS SNI support enabled")]),e("br"),t._v("\n启用了 "),e("strong",[t._v("SNI（Server Name Indication）")]),t._v(" ，可以让同一个 IP/端口托管多个 HTTPS 域名。")])]),t._v(" "),e("hr"),t._v(" "),e("h3",{attrs:{id:"二、路径配置"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#二、路径配置"}},[t._v("#")]),t._v(" 二、路径配置")]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",[t._v("参数")]),t._v(" "),e("th",[t._v("说明")])])]),t._v(" "),e("tbody",[e("tr",[e("td",[e("code",[t._v("--prefix=/usr/share/nginx")])]),t._v(" "),e("td",[t._v("安装目录的根路径")])]),t._v(" "),e("tr",[e("td",[e("code",[t._v("--sbin-path=/usr/sbin/nginx")])]),t._v(" "),e("td",[t._v("nginx 可执行文件的完整路径")])]),t._v(" "),e("tr",[e("td",[e("code",[t._v("--modules-path=/usr/lib64/nginx/modules")])]),t._v(" "),e("td",[t._v("动态模块（"),e("code",[t._v(".so")]),t._v("）默认搜索路径")])]),t._v(" "),e("tr",[e("td",[e("code",[t._v("--conf-path=/etc/nginx/nginx.conf")])]),t._v(" "),e("td",[t._v("主配置文件路径")])]),t._v(" "),e("tr",[e("td",[e("code",[t._v("--error-log-path=/var/log/nginx/error.log")])]),t._v(" "),e("td",[t._v("错误日志文件路径")])]),t._v(" "),e("tr",[e("td",[e("code",[t._v("--http-log-path=/var/log/nginx/access.log")])]),t._v(" "),e("td",[t._v("访问日志文件路径")])]),t._v(" "),e("tr",[e("td",[e("code",[t._v("--http-client-body-temp-path=/var/lib/nginx/tmp/client_body``--http-proxy-temp-path=/var/lib/nginx/tmp/proxy``--http-fastcgi-temp-path=/var/lib/nginx/tmp/fastcgi``--http-uwsgi-temp-path=/var/lib/nginx/tmp/uwsgi``--http-scgi-temp-path=/var/lib/nginx/tmp/scgi")])]),t._v(" "),e("td",[t._v("各种临时文件（客户端请求体、代理、FastCGI、uWSGI、SCGI）的存放目录")])]),t._v(" "),e("tr",[e("td",[e("code",[t._v("--pid-path=/run/nginx.pid")])]),t._v(" "),e("td",[t._v("存放 nginx 主进程 PID 文件的路径")])]),t._v(" "),e("tr",[e("td",[e("code",[t._v("--lock-path=/run/lock/subsys/nginx")])]),t._v(" "),e("td",[t._v("锁文件路径")])]),t._v(" "),e("tr",[e("td",[e("code",[t._v("--user=nginx --group=nginx")])]),t._v(" "),e("td",[t._v("运行 nginx worker 进程所用的系统用户和用户组")])])])]),t._v(" "),e("hr"),t._v(" "),e("h3",{attrs:{id:"三、功能模块支持"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#三、功能模块支持"}},[t._v("#")]),t._v(" 三、功能模块支持")]),t._v(" "),e("ul",[e("li",[e("p",[e("strong",[t._v("兼容性与调试")])]),t._v(" "),e("ul",[e("li",[e("code",[t._v("--with-compat")]),t._v("：允许旧版模块二进制兼容")]),t._v(" "),e("li",[e("code",[t._v("--with-debug")]),t._v("：编译时启用调试日志功能")])])]),t._v(" "),e("li",[e("p",[e("strong",[t._v("异步与性能")])]),t._v(" "),e("ul",[e("li",[e("code",[t._v("--with-file-aio")]),t._v("：文件异步 I/O 支持")]),t._v(" "),e("li",[e("code",[t._v("--with-google_perftools_module")]),t._v("：集成 Google 性能分析工具（gperftools）模块")]),t._v(" "),e("li",[e("code",[t._v("--with-threads")]),t._v("：开启多线程支持")])])]),t._v(" "),e("li",[e("p",[e("strong",[t._v("HTTP 基本扩展")])]),t._v(" "),e("ul",[e("li",[e("code",[t._v("--with-http_addition_module")]),t._v("：可在响应尾部或头部添加内容")]),t._v(" "),e("li",[e("code",[t._v("--with-http_auth_request_module")]),t._v("：支持外部授权子请求")]),t._v(" "),e("li",[e("code",[t._v("--with-http_dav_module")]),t._v("：WebDAV 协议支持")]),t._v(" "),e("li",[e("code",[t._v("--with-http_degradation_module")]),t._v("：自动降级模块")]),t._v(" "),e("li",[e("code",[t._v("--with-http_flv_module")]),t._v("：FLV 视频流支持")]),t._v(" "),e("li",[e("code",[t._v("--with-http_gunzip_module")]),t._v("：动态解压 gzip 内容")]),t._v(" "),e("li",[e("code",[t._v("--with-http_gzip_static_module")]),t._v("：预压缩文件（.gz）直接提供")]),t._v(" "),e("li",[e("code",[t._v("--with-http_mp4_module")]),t._v("：MP4 视频流支持")]),t._v(" "),e("li",[e("code",[t._v("--with-http_sub_module")]),t._v("：响应内容替换（sub filter）")]),t._v(" "),e("li",[e("code",[t._v("--with-http_realip_module")]),t._v("：从头部获取客户端真实 IP")]),t._v(" "),e("li",[e("code",[t._v("--with-http_secure_link_module")]),t._v("：安全链接验证")]),t._v(" "),e("li",[e("code",[t._v("--with-http_slice_module")]),t._v("：Slice 分片下载/分发")]),t._v(" "),e("li",[e("code",[t._v("--with-http_ssl_module")]),t._v("：SSL/TLS 支持")]),t._v(" "),e("li",[e("code",[t._v("--with-http_v2_module")]),t._v("：HTTP/2 支持")]),t._v(" "),e("li",[e("code",[t._v("--with-http_stub_status_module")]),t._v("：内置状态监控接口（"),e("code",[t._v("stub_status")]),t._v("）")])])]),t._v(" "),e("li",[e("p",[e("strong",[t._v("动态可选模块")])]),t._v(" "),e("ul",[e("li",[e("code",[t._v("--with-http_image_filter_module=dynamic")]),t._v("：图像处理模块按需加载")]),t._v(" "),e("li",[e("code",[t._v("--with-http_xslt_module=dynamic")]),t._v("：XSLT 处理模块按需加载")]),t._v(" "),e("li",[e("code",[t._v("--with-http_perl_module=dynamic")]),t._v("：嵌入 Perl 脚本模块按需加载")]),t._v(" "),e("li",[e("code",[t._v("--with-mail=dynamic --with-mail_ssl_module")]),t._v("：邮件（SMTP/IMAP/POP3）代理及 SSL 模块按需加载")]),t._v(" "),e("li",[e("code",[t._v("--with-stream=dynamic --with-stream_ssl_module --with-stream_ssl_preread_module")]),t._v("：TCP/UDP 流代理及 SSL 支持按需加载")])])]),t._v(" "),e("li",[e("p",[e("strong",[t._v("其他")])]),t._v(" "),e("ul",[e("li",[e("code",[t._v("--with-randrom_index_module")]),t._v("：随机返回索引文件")]),t._v(" "),e("li",[e("code",[t._v("--with-pcre --with-pcre-jit")]),t._v("：基于 PCRE 的正则支持及 JIT 加速")])])])]),t._v(" "),e("hr"),t._v(" "),e("h3",{attrs:{id:"四、编译优化参数"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#四、编译优化参数"}},[t._v("#")]),t._v(" 四、编译优化参数")]),t._v(" "),e("ul",[e("li",[e("p",[e("code",[t._v("--with-cc-opt='-O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions -fstack-protector-strong --param=ssp-buffer-size=4 -grecord-gcc-switches -specs=/usr/lib/rpm/redhat/redhat-hardened-cc1 -m64 -mtune=generic'")])]),t._v(" "),e("ul",[e("li",[e("strong",[t._v("-O2")]),t._v("：优化级别")]),t._v(" "),e("li",[e("strong",[t._v("-g")]),t._v("：保留调试符号")]),t._v(" "),e("li",[e("strong",[t._v("-fstack-protector-strong")]),t._v("：开启堆栈溢出保护")]),t._v(" "),e("li",[e("strong",[t._v("_FORTIFY_SOURCE")]),t._v("：增强运行时安全检查")]),t._v(" "),e("li",[e("strong",[t._v("-mtune=generic")]),t._v("：针对通用 x86_64 优化")])])]),t._v(" "),e("li",[e("p",[e("code",[t._v("--with-ld-opt='-Wl,-z,relro -specs=/usr/lib/rpm/redhat/redhat-hardened-ld -Wl,-E'")])]),t._v(" "),e("ul",[e("li",[e("strong",[t._v("-z relro")]),t._v("：只读重定位节，增强二进制安全")]),t._v(" "),e("li",[e("strong",[t._v("-Wl,-E")]),t._v("：导出符号表，兼容动态模块")])])])]),t._v(" "),e("hr")])}),[],!1,null,null,null);e.default=v.exports}}]);