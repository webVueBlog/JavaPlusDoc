(window.webpackJsonp=window.webpackJsonp||[]).push([[406],{1240:function(t,v,_){"use strict";_.r(v);var a=_(1),s=Object(a.a)({},(function(){var t=this,v=t._self._c;return v("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[v("blockquote",[v("p",[t._v("点击勘误"),v("a",{attrs:{href:"https://github.com/webVueBlog/JavaPlusDoc/issues",target:"_blank",rel:"noopener noreferrer"}},[t._v("issues"),v("OutboundLink")],1),t._v("，哪吒感谢大家的阅读")])]),t._v(" "),v("img",{attrs:{align:"right",width:"100",src:"https://cdn.jsdelivr.net/gh/YunYouJun/yun/images/yun-alpha-compressed.png"}}),t._v(" "),v("h2",{attrs:{id:"面试了一位中兴的运维程序员"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#面试了一位中兴的运维程序员"}},[t._v("#")]),t._v(" 面试了一位中兴的运维程序员")]),t._v(" "),v("p",[t._v("加群联系作者vx：xiaoda0423")]),t._v(" "),v("p",[t._v("仓库地址："),v("a",{attrs:{href:"https://webvueblog.github.io/JavaPlusDoc/",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://webvueblog.github.io/JavaPlusDoc/"),v("OutboundLink")],1)]),t._v(" "),v("p",[v("a",{attrs:{href:"https://1024bat.cn/",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://1024bat.cn/"),v("OutboundLink")],1)]),t._v(" "),v("p",[v("a",{attrs:{href:"https://github.com/webVueBlog/fastapi_plus",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/webVueBlog/fastapi_plus"),v("OutboundLink")],1)]),t._v(" "),v("p",[v("a",{attrs:{href:"https://webvueblog.github.io/JavaPlusDoc/",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://webvueblog.github.io/JavaPlusDoc/"),v("OutboundLink")],1)]),t._v(" "),v("p",[v("img",{attrs:{src:"https://p0-xtjj-private.juejin.cn/tos-cn-i-73owjymdk6/910a42c0866944828050590a08aa1c0b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oiR5piv5ZOq5ZCS:q75.awebp?policy=eyJ2bSI6MywidWlkIjoiMTQ1MTAxMTA4MTI0OTE3NSJ9&rk3s=f64ab15b&x-orig-authkey=f32326d3454f2ac7e96d3d06cdbb035152127018&x-orig-expires=1748148707&x-orig-sign=jveq0WxoseZhD2sMzrbMz6e%2FIKY%3D",alt:"1747398531175.png"}})]),t._v(" "),v("hr"),t._v(" "),v("h2",{attrs:{id:"✅-一、cpu-排查命令示例"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#✅-一、cpu-排查命令示例"}},[t._v("#")]),t._v(" ✅ 一、CPU 排查命令示例")]),t._v(" "),v("h3",{attrs:{id:"_1️⃣-实时查看-cpu-使用"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#_1️⃣-实时查看-cpu-使用"}},[t._v("#")]),t._v(" 1️⃣ 实时查看 CPU 使用：")]),t._v(" "),v("div",{staticClass:"language- extra-class"},[v("pre",[v("code",[t._v("top\n")])])]),v("h3",{attrs:{id:"_2️⃣-查看哪个进程最耗-cpu"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#_2️⃣-查看哪个进程最耗-cpu"}},[t._v("#")]),t._v(" 2️⃣ 查看哪个进程最耗 CPU：")]),t._v(" "),v("div",{staticClass:"language- extra-class"},[v("pre",[v("code",[t._v("ps aux --sort=-%cpu | head -10\n")])])]),v("h3",{attrs:{id:"_3️⃣-查看多核-cpu-分布情况"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#_3️⃣-查看多核-cpu-分布情况"}},[t._v("#")]),t._v(" 3️⃣ 查看多核 CPU 分布情况：")]),t._v(" "),v("div",{staticClass:"language- extra-class"},[v("pre",[v("code",[t._v("mpstat -P ALL 1\n")])])]),v("h3",{attrs:{id:"_4️⃣-查看进程-pid-的线程使用情况-java-栈分析"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#_4️⃣-查看进程-pid-的线程使用情况-java-栈分析"}},[t._v("#")]),t._v(" 4️⃣ 查看进程 PID 的线程使用情况（Java 栈分析）：")]),t._v(" "),v("div",{staticClass:"language- extra-class"},[v("pre",[v("code",[t._v("jstack <pid> | less\n")])])]),v("hr"),t._v(" "),v("h2",{attrs:{id:"✅-二、内存排查命令示例"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#✅-二、内存排查命令示例"}},[t._v("#")]),t._v(" ✅ 二、内存排查命令示例")]),t._v(" "),v("h3",{attrs:{id:"_1️⃣-总体内存占用情况"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#_1️⃣-总体内存占用情况"}},[t._v("#")]),t._v(" 1️⃣ 总体内存占用情况：")]),t._v(" "),v("div",{staticClass:"language- extra-class"},[v("pre",[v("code",[t._v("free -h\n")])])]),v("h3",{attrs:{id:"_2️⃣-按内存排序的进程列表"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#_2️⃣-按内存排序的进程列表"}},[t._v("#")]),t._v(" 2️⃣ 按内存排序的进程列表：")]),t._v(" "),v("div",{staticClass:"language- extra-class"},[v("pre",[v("code",[t._v("ps aux --sort=-%mem | head -10\n")])])]),v("h3",{attrs:{id:"_3️⃣-swap-使用情况"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#_3️⃣-swap-使用情况"}},[t._v("#")]),t._v(" 3️⃣ Swap 使用情况：")]),t._v(" "),v("div",{staticClass:"language- extra-class"},[v("pre",[v("code",[t._v("vmstat 1\n")])])]),v("h3",{attrs:{id:"_4️⃣-查看被-oom-killer-杀掉的进程"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#_4️⃣-查看被-oom-killer-杀掉的进程"}},[t._v("#")]),t._v(" 4️⃣ 查看被 OOM Killer 杀掉的进程：")]),t._v(" "),v("div",{staticClass:"language- extra-class"},[v("pre",[v("code",[t._v("dmesg | grep -i oom\n")])])]),v("hr"),t._v(" "),v("h2",{attrs:{id:"✅-三、磁盘空间排查命令示例"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#✅-三、磁盘空间排查命令示例"}},[t._v("#")]),t._v(" ✅ 三、磁盘空间排查命令示例")]),t._v(" "),v("h3",{attrs:{id:"_1️⃣-查看所有磁盘分区使用"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#_1️⃣-查看所有磁盘分区使用"}},[t._v("#")]),t._v(" 1️⃣ 查看所有磁盘分区使用：")]),t._v(" "),v("div",{staticClass:"language- extra-class"},[v("pre",[v("code",[t._v("df -h\n")])])]),v("h3",{attrs:{id:"_2️⃣-查看当前目录下各目录大小"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#_2️⃣-查看当前目录下各目录大小"}},[t._v("#")]),t._v(" 2️⃣ 查看当前目录下各目录大小：")]),t._v(" "),v("div",{staticClass:"language- extra-class"},[v("pre",[v("code",[t._v("du -sh *\n")])])]),v("h3",{attrs:{id:"_3️⃣-快速定位大文件-top-10"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#_3️⃣-快速定位大文件-top-10"}},[t._v("#")]),t._v(" 3️⃣ 快速定位大文件（TOP 10）：")]),t._v(" "),v("div",{staticClass:"language- extra-class"},[v("pre",[v("code",[t._v("du -ah / | sort -rh | head -n 10\n")])])]),v("h3",{attrs:{id:"_4️⃣-查看已被删除但仍占用磁盘的文件"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#_4️⃣-查看已被删除但仍占用磁盘的文件"}},[t._v("#")]),t._v(" 4️⃣ 查看已被删除但仍占用磁盘的文件：")]),t._v(" "),v("div",{staticClass:"language- extra-class"},[v("pre",[v("code",[t._v("lsof | grep deleted\n")])])]),v("hr"),t._v(" "),v("h2",{attrs:{id:"✅-四、磁盘-io-排查命令示例"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#✅-四、磁盘-io-排查命令示例"}},[t._v("#")]),t._v(" ✅ 四、磁盘 IO 排查命令示例")]),t._v(" "),v("h3",{attrs:{id:"_1️⃣-查看-io-状况"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#_1️⃣-查看-io-状况"}},[t._v("#")]),t._v(" 1️⃣ 查看 IO 状况：")]),t._v(" "),v("div",{staticClass:"language- extra-class"},[v("pre",[v("code",[t._v("iostat -x 1\n")])])]),v("h3",{attrs:{id:"_2️⃣-查看-io-等待-wa"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#_2️⃣-查看-io-等待-wa"}},[t._v("#")]),t._v(" 2️⃣ 查看 IO 等待（wa）：")]),t._v(" "),v("div",{staticClass:"language- extra-class"},[v("pre",[v("code",[t._v("vmstat 1\n")])])]),v("h3",{attrs:{id:"_3️⃣-实时查看哪个进程读写最多"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#_3️⃣-实时查看哪个进程读写最多"}},[t._v("#")]),t._v(" 3️⃣ 实时查看哪个进程读写最多：")]),t._v(" "),v("div",{staticClass:"language- extra-class"},[v("pre",[v("code",[t._v("iotop\n")])])]),v("hr"),t._v(" "),v("h2",{attrs:{id:"✅-五、网络问题排查命令示例"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#✅-五、网络问题排查命令示例"}},[t._v("#")]),t._v(" ✅ 五、网络问题排查命令示例")]),t._v(" "),v("h3",{attrs:{id:"_1️⃣-查看端口是否监听"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#_1️⃣-查看端口是否监听"}},[t._v("#")]),t._v(" 1️⃣ 查看端口是否监听：")]),t._v(" "),v("div",{staticClass:"language- extra-class"},[v("pre",[v("code",[t._v("ss -lntp  # 或 netstat -tulnp\n")])])]),v("h3",{attrs:{id:"_2️⃣-查看实时连接状态"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#_2️⃣-查看实时连接状态"}},[t._v("#")]),t._v(" 2️⃣ 查看实时连接状态：")]),t._v(" "),v("div",{staticClass:"language- extra-class"},[v("pre",[v("code",[t._v("ss -s\n")])])]),v("h3",{attrs:{id:"_3️⃣-查看-tcp-连接数"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#_3️⃣-查看-tcp-连接数"}},[t._v("#")]),t._v(" 3️⃣ 查看 TCP 连接数：")]),t._v(" "),v("div",{staticClass:"language- extra-class"},[v("pre",[v("code",[t._v("netstat -an | grep ESTABLISHED | wc -l\n")])])]),v("h3",{attrs:{id:"_4️⃣-检查网络连通性"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#_4️⃣-检查网络连通性"}},[t._v("#")]),t._v(" 4️⃣ 检查网络连通性：")]),t._v(" "),v("div",{staticClass:"language- extra-class"},[v("pre",[v("code",[t._v("ping 8.8.8.8\n")])])]),v("h3",{attrs:{id:"_5️⃣-抓包分析请求内容"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#_5️⃣-抓包分析请求内容"}},[t._v("#")]),t._v(" 5️⃣ 抓包分析请求内容：")]),t._v(" "),v("div",{staticClass:"language- extra-class"},[v("pre",[v("code",[t._v("tcpdump -i eth0 port 8080 -nn\n")])])]),v("hr"),t._v(" "),v("h2",{attrs:{id:"✅-六、一键性能总览工具-推荐"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#✅-六、一键性能总览工具-推荐"}},[t._v("#")]),t._v(" ✅ 六、一键性能总览工具（推荐）")]),t._v(" "),v("div",{staticClass:"language- extra-class"},[v("pre",[v("code",[t._v("glances  # 安装：pip install glances\n")])])]),v("hr"),t._v(" "),v("h2",{attrs:{id:"✅-七、综合一键排查脚本-可选执行"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#✅-七、综合一键排查脚本-可选执行"}},[t._v("#")]),t._v(" ✅ 七、综合一键排查脚本（可选执行）")]),t._v(" "),v("div",{staticClass:"language- extra-class"},[v("pre",[v("code",[t._v('#!/bin/bash\necho "CPU:"\ntop -b -n1 | head -5\n\necho -e "\\nMemory:"\nfree -h\n\necho -e "\\nDisk Usage:"\ndf -h\n\necho -e "\\nIO:"\niostat -x 1 2\n\necho -e "\\nNetwork:"\nss -s\n')])])]),v("hr"),t._v(" "),v("h2",{attrs:{id:"_1-procs-进程队列"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#_1-procs-进程队列"}},[t._v("#")]),t._v(" 1 procs（进程队列）")]),t._v(" "),v("table",[v("thead",[v("tr",[v("th",[t._v("列")]),t._v(" "),v("th",[t._v("含义")]),t._v(" "),v("th",[t._v("通俗解释")])])]),t._v(" "),v("tbody",[v("tr",[v("td",[v("strong",[t._v("r")])]),t._v(" "),v("td",[t._v("runnable")]),t._v(" "),v("td",[t._v("正在 CPU 上跑或排队等跑的线程数，≈ CPU 核数 × 1 属于正常负载。")])]),t._v(" "),v("tr",[v("td",[v("strong",[t._v("b")])]),t._v(" "),v("td",[t._v("blocked")]),t._v(" "),v("td",[t._v("因 I/O（磁盘/网络）或锁而睡眠的线程数。持续 >0 说明 I/O 瓶颈或锁竞争。")])])])]),t._v(" "),v("blockquote",[v("p",[v("strong",[t._v("示例")]),t._v("："),v("code",[t._v("r 1→0")]),t._v("、"),v("code",[t._v("b 0")]),t._v(" → CPU 很空闲，没有堵塞。")])]),t._v(" "),v("hr"),t._v(" "),v("h2",{attrs:{id:"_2-memory-内存"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#_2-memory-内存"}},[t._v("#")]),t._v(" 2 memory（内存）")]),t._v(" "),v("table",[v("thead",[v("tr",[v("th",[t._v("列")]),t._v(" "),v("th",[t._v("含义")]),t._v(" "),v("th",[t._v("通俗解释")])])]),t._v(" "),v("tbody",[v("tr",[v("td",[v("strong",[t._v("swpd")])]),t._v(" "),v("td",[t._v("swap used")]),t._v(" "),v("td",[t._v("已使用交换分区大小。≠0 代表“被换到磁盘”。")])]),t._v(" "),v("tr",[v("td",[v("strong",[t._v("free")])]),t._v(" "),v("td",[t._v("free RAM")]),t._v(" "),v("td",[t._v("完全空闲内存。Linux 会尽量把闲置内存做缓存，所以 free 很低不代表内存不够。")])]),t._v(" "),v("tr",[v("td",[v("strong",[t._v("buff")])]),t._v(" "),v("td",[t._v("buffer")]),t._v(" "),v("td",[t._v("块设备读写用的元数据缓存（通常几百 MiB 内）。")])]),t._v(" "),v("tr",[v("td",[v("strong",[t._v("cache")])]),t._v(" "),v("td",[t._v("page cache")]),t._v(" "),v("td",[t._v("文件数据缓存。越高越能加速读文件。")])])])]),t._v(" "),v("blockquote",[v("p",[v("strong",[t._v("示例")]),t._v("："),v("code",[t._v("swpd 0")]),t._v("、"),v("code",[t._v("free 133 MiB")]),t._v("、"),v("code",[t._v("cache 1.2 GiB")]),t._v(" → 没有用到 swap，内存够用。")])]),t._v(" "),v("hr"),t._v(" "),v("h2",{attrs:{id:"_3-swap-换页"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#_3-swap-换页"}},[t._v("#")]),t._v(" 3 swap（换页）")]),t._v(" "),v("table",[v("thead",[v("tr",[v("th",[t._v("列")]),t._v(" "),v("th",[t._v("含义")]),t._v(" "),v("th",[t._v("通俗解释")])])]),t._v(" "),v("tbody",[v("tr",[v("td",[v("strong",[t._v("si")])]),t._v(" "),v("td",[t._v("swap-in")]),t._v(" "),v("td",[t._v("每秒从磁盘换入内存的字节块数。长期 >0 意味内存不足。")])]),t._v(" "),v("tr",[v("td",[v("strong",[t._v("so")])]),t._v(" "),v("td",[t._v("swap-out")]),t._v(" "),v("td",[t._v("每秒换出到磁盘的字节块数。")])])])]),t._v(" "),v("blockquote",[v("p",[v("strong",[t._v("示例")]),t._v("："),v("code",[t._v("si 0")]),t._v("、"),v("code",[t._v("so 0")]),t._v(" → 未发生换页，一切正常。")])]),t._v(" "),v("hr"),t._v(" "),v("h2",{attrs:{id:"_4-io-块设备-i-o"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#_4-io-块设备-i-o"}},[t._v("#")]),t._v(" 4 io（块设备 I/O）")]),t._v(" "),v("table",[v("thead",[v("tr",[v("th",[t._v("列")]),t._v(" "),v("th",[t._v("含义")]),t._v(" "),v("th",[t._v("通俗解释")])])]),t._v(" "),v("tbody",[v("tr",[v("td",[v("strong",[t._v("bi")])]),t._v(" "),v("td",[t._v("blocks in")]),t._v(" "),v("td",[t._v("读磁盘速率（块/秒）。")])]),t._v(" "),v("tr",[v("td",[v("strong",[t._v("bo")])]),t._v(" "),v("td",[t._v("blocks out")]),t._v(" "),v("td",[t._v("写磁盘速率（块/秒）。")])])])]),t._v(" "),v("blockquote",[v("p",[v("strong",[t._v("示例")]),t._v("："),v("code",[t._v("bi 0~2")]),t._v("、"),v("code",[t._v("bo 0~388")]),t._v(" → 磁盘几乎空闲；偶尔写入 388 块≈ ≈ 2 MiB/s，不算大压力。")])]),t._v(" "),v("hr"),t._v(" "),v("h2",{attrs:{id:"_5-system-系统"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#_5-system-系统"}},[t._v("#")]),t._v(" 5 system（系统）")]),t._v(" "),v("table",[v("thead",[v("tr",[v("th",[t._v("列")]),t._v(" "),v("th",[t._v("含义")]),t._v(" "),v("th",[t._v("通俗解释")])])]),t._v(" "),v("tbody",[v("tr",[v("td",[v("strong",[t._v("in")])]),t._v(" "),v("td",[t._v("interrupts")]),t._v(" "),v("td",[t._v("每秒硬件中断次数，网络/磁盘繁忙时会上升。")])]),t._v(" "),v("tr",[v("td",[v("strong",[t._v("cs")])]),t._v(" "),v("td",[t._v("context switch")]),t._v(" "),v("td",[t._v("每秒上下文切换次数，并发线程多或内核调用频繁时变大。")])])])]),t._v(" "),v("blockquote",[v("p",[v("strong",[t._v("示例")]),t._v("："),v("code",[t._v("in 0~2302")]),t._v("、"),v("code",[t._v("cs 0~3834")]),t._v(" → 中断和切换都不高。")])]),t._v(" "),v("hr"),t._v(" "),v("h2",{attrs:{id:"_6-cpu-cpu-利用率-百分比"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#_6-cpu-cpu-利用率-百分比"}},[t._v("#")]),t._v(" 6 cpu（CPU 利用率，百分比）")]),t._v(" "),v("table",[v("thead",[v("tr",[v("th",[t._v("列")]),t._v(" "),v("th",[t._v("含义")]),t._v(" "),v("th",[t._v("通俗解释")])])]),t._v(" "),v("tbody",[v("tr",[v("td",[v("strong",[t._v("us")])]),t._v(" "),v("td",[t._v("user")]),t._v(" "),v("td",[t._v("用户态程序耗 CPU 百分比。")])]),t._v(" "),v("tr",[v("td",[v("strong",[t._v("sy")])]),t._v(" "),v("td",[t._v("system")]),t._v(" "),v("td",[t._v("内核态耗 CPU 百分比（系统调用、软中断）。")])]),t._v(" "),v("tr",[v("td",[v("strong",[t._v("id")])]),t._v(" "),v("td",[t._v("idle")]),t._v(" "),v("td",[t._v("空闲百分比。")])]),t._v(" "),v("tr",[v("td",[v("strong",[t._v("wa")])]),t._v(" "),v("td",[t._v("iowait")]),t._v(" "),v("td",[t._v("等待磁盘 I/O 百分比，持续高说明磁盘慢。")])]),t._v(" "),v("tr",[v("td",[v("strong",[t._v("st")])]),t._v(" "),v("td",[t._v("steal")]),t._v(" "),v("td",[t._v("虚拟化被宿主机“偷走”的 CPU 百分比。")])])])]),t._v(" "),v("blockquote",[v("p",[v("strong",[t._v("示例")]),t._v("："),v("code",[t._v("us 1-2 %")]),t._v("、"),v("code",[t._v("sy 1 %")]),t._v("、"),v("code",[t._v("id 95-99 %")]),t._v("、"),v("code",[t._v("wa 0-2 %")]),t._v("、"),v("code",[t._v("st 0 %")]),v("br"),t._v("\nCPU 大部分时间发呆，偶尔有极少 I/O 等待，系统非常轻松。")])]),t._v(" "),v("hr"),t._v(" "),v("h3",{attrs:{id:"一句话诊断"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#一句话诊断"}},[t._v("#")]),t._v(" 一句话诊断")]),t._v(" "),v("ul",[v("li",[v("strong",[t._v("CPU")]),t._v(" 几乎空闲")]),t._v(" "),v("li",[v("strong",[t._v("内存")]),t._v(" 充裕，无 swap")]),t._v(" "),v("li",[v("strong",[t._v("磁盘/网络")]),t._v(" I/O 很低，无阻塞")]),t._v(" "),v("li",[v("strong",[t._v("整体")]),t._v(" 系统处于“喝茶状态”，无需担心资源瓶颈。")])]),t._v(" "),v("blockquote",[v("p",[t._v("如果以后看到："),v("code",[t._v("r")]),t._v(" 持续 > CPU 核数、"),v("code",[t._v("si/so")]),t._v(" 不断增加、"),v("code",[t._v("wa")]),t._v(" 高于 20 %，就是性能告警信号。")])]),t._v(" "),v("table",[v("thead",[v("tr",[v("th",[t._v("目录")]),t._v(" "),v("th",[t._v("状态")]),t._v(" "),v("th",[t._v("建议")])])]),t._v(" "),v("tbody",[v("tr",[v("td",[v("code",[t._v("/www/server")])]),t._v(" "),v("td",[t._v("✅ 最大占用者")]),t._v(" "),v("td",[t._v("分析子目录，确认是否有历史文件可删除")])]),t._v(" "),v("tr",[v("td",[v("code",[t._v("/var/lib/docker")])]),t._v(" "),v("td",[t._v("🚨 容器临时层")]),t._v(" "),v("td",[t._v("使用 "),v("code",[t._v("docker system prune")]),t._v(" 清理")])]),t._v(" "),v("tr",[v("td",[v("code",[t._v("/sh")])]),t._v(" "),v("td",[t._v("❓ 自定义目录")]),t._v(" "),v("td",[t._v("人工确认内容是否有保留意义")])]),t._v(" "),v("tr",[v("td",[v("code",[t._v("/var/lib/docker/.../elasticsearch")])]),t._v(" "),v("td",[t._v("📊 容器内 Elasticsearch")]),t._v(" "),v("td",[t._v("查看索引数据是否爆炸，设置索引生命周期策略（ILM）")])])])]),t._v(" "),v("div",{staticClass:"language- extra-class"},[v("pre",[v("code",[t._v("[root@VM-0-14-centos /]# du -ah / | sort -rh | head -n 10  \ndu: cannot access ‘/proc/21718/task/21718/fd/4’: No such file or directory  \ndu: cannot access ‘/proc/21718/task/21718/fdinfo/4’: No such file or directory  \ndu: cannot access ‘/proc/21718/fd/3’: No such file or directory  \ndu: cannot access ‘/proc/21718/fdinfo/3’: No such file or directory  \n13G /  \n5.3G /www  \n4.7G /www/server  \n3.3G /var  \n3.0G /usr  \n1.4G /var/lib  \n1.2G /var/lib/docker/overlay2  \n1.2G /var/lib/docker  \n1.2G /sh  \n1.1G /var/lib/docker/overlay2/d41f20e46c2773c0511a3038827e8edc76ad0b30c1c318a37c460b3ca31c1024/diff/usr/share/elasticsearch\n")])])]),v("h2",{attrs:{id:"✅-基础字段说明"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#✅-基础字段说明"}},[t._v("#")]),t._v(" ✅ 基础字段说明")]),t._v(" "),v("table",[v("thead",[v("tr",[v("th",[t._v("字段名")]),t._v(" "),v("th",[t._v("含义")])])]),t._v(" "),v("tbody",[v("tr",[v("td",[v("strong",[t._v("Filesystem")])]),t._v(" "),v("td",[t._v("设备或网络存储的名称（例如：本地硬盘、NFS 网络磁盘）")])]),t._v(" "),v("tr",[v("td",[v("strong",[t._v("Size")])]),t._v(" "),v("td",[t._v("分区总容量")])]),t._v(" "),v("tr",[v("td",[v("strong",[t._v("Used")])]),t._v(" "),v("td",[t._v("已使用的空间")])]),t._v(" "),v("tr",[v("td",[v("strong",[t._v("Avail")])]),t._v(" "),v("td",[t._v("剩余可用空间")])]),t._v(" "),v("tr",[v("td",[v("strong",[t._v("Use%")])]),t._v(" "),v("td",[t._v("使用率百分比")])]),t._v(" "),v("tr",[v("td",[v("strong",[t._v("Mounted on")])]),t._v(" "),v("td",[t._v("这个设备挂载到系统的哪个目录上")])])])]),t._v(" "),v("hr"),t._v(" "),v("h2",{attrs:{id:"🧾-核心磁盘挂载情况中文解释"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#🧾-核心磁盘挂载情况中文解释"}},[t._v("#")]),t._v(" 🧾 核心磁盘挂载情况中文解释")]),t._v(" "),v("h3",{attrs:{id:"📌-1-根目录-系统主分区"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#📌-1-根目录-系统主分区"}},[t._v("#")]),t._v(" 📌 1. 根目录（系统主分区）：")]),t._v(" "),v("div",{staticClass:"language- extra-class"},[v("pre",[v("code",[t._v("/dev/vda1         197G   91G   99G  48% /\n")])])]),v("ul",[v("li",[v("strong",[t._v("这是系统主分区")]),t._v("，所有 "),v("code",[t._v("/")]),t._v(" 开头的路径都基于它。")]),t._v(" "),v("li",[t._v("总容量 197G，当前使用了 91G（大约一半），剩 99G。")]),t._v(" "),v("li",[v("strong",[t._v("使用率 48%，属于健康状态。")])])]),t._v(" "),v("hr"),t._v(" "),v("h3",{attrs:{id:"📌-2-docker-容器层-多个-overlay-分区"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#📌-2-docker-容器层-多个-overlay-分区"}},[t._v("#")]),t._v(" 📌 2. Docker 容器层（多个 overlay 分区）：")]),t._v(" "),v("div",{staticClass:"language- extra-class"},[v("pre",[v("code",[t._v("overlay 197G  91G  99G  48% /var/lib/docker/overlay2/xxxxx/merged\n")])])]),v("ul",[v("li",[t._v("Docker 使用 "),v("strong",[t._v("分层文件系统 overlay2")]),t._v("，这些是容器运行时的文件视图。")]),t._v(" "),v("li",[t._v("它们共享的是同一个主分区（"),v("code",[t._v("/dev/vda1")]),t._v("），所以容量一致。")]),t._v(" "),v("li",[v("strong",[t._v("你运行了多个 Docker 容器，overlay 数量较多是正常的。")])])]),t._v(" "),v("hr"),t._v(" "),v("h3",{attrs:{id:"📌-3-nfs-网络存储挂载-用于容器持久化"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#📌-3-nfs-网络存储挂载-用于容器持久化"}},[t._v("#")]),t._v(" 📌 3. NFS 网络存储挂载（用于容器持久化）：")]),t._v(" "),v("div",{staticClass:"language- extra-class"},[v("pre",[v("code",[t._v("172.18.96.88:/data1/ifs/kubernetes/... 1008G 623G 335G 66% /var/lib/kubelet/...\n")])])]),v("ul",[v("li",[t._v("表示从 IP 为 "),v("code",[t._v("172.18.96.88")]),t._v(" 的服务器挂载了远程磁盘（通过 NFS 协议）。")]),t._v(" "),v("li",[t._v("通常是 "),v("strong",[t._v("K8s 容器的数据卷（如 MongoDB / ClickHouse / Cassandra 的持久卷）")]),t._v(" 。")]),t._v(" "),v("li",[t._v("容量很大（1008G），使用 623G，剩余 335G，使用率 66%。")]),t._v(" "),v("li",[v("strong",[t._v("只要 < 80%，都属正常范围。")])])]),t._v(" "),v("hr"),t._v(" "),v("h3",{attrs:{id:"📌-4-tmpfs-文件系统-虚拟内存盘"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#📌-4-tmpfs-文件系统-虚拟内存盘"}},[t._v("#")]),t._v(" 📌 4. "),v("code",[t._v("tmpfs")]),t._v(" 文件系统（虚拟内存盘）：")]),t._v(" "),v("div",{staticClass:"language- extra-class"},[v("pre",[v("code",[t._v("tmpfs   7.7G   12K   7.7G   1% /var/lib/kubelet/pods/...\n")])])]),v("ul",[v("li",[v("code",[t._v("tmpfs")]),t._v(" 是一种用内存创建的临时文件系统，"),v("strong",[t._v("速度很快")]),t._v("，重启即清除。")]),t._v(" "),v("li",[t._v("用于 Kubernetes 存储容器临时 Secret、Token。")]),t._v(" "),v("li",[t._v("通常使用率非常低（几 KB），这是正常的。")])]),t._v(" "),v("hr"),t._v(" "),v("h3",{attrs:{id:"📌-5-shm-共享内存目录"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#📌-5-shm-共享内存目录"}},[t._v("#")]),t._v(" 📌 5. "),v("code",[t._v("shm")]),t._v(" 共享内存目录：")]),t._v(" "),v("div",{staticClass:"language- extra-class"},[v("pre",[v("code",[t._v("shm  64M  0  64M  0% /var/lib/docker/containers/xxx/mounts/shm\n")])])]),v("ul",[v("li",[t._v("每个容器都有自己的 "),v("code",[t._v("shm")]),t._v("，用于进程间共享内存（如浏览器/数据库共享区）。")]),t._v(" "),v("li",[t._v("也是内存中的，不占用硬盘，64MB 为默认配置。")])]),t._v(" "),v("hr"),t._v(" "),v("h2",{attrs:{id:"✅-总结-当前磁盘状态健康"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#✅-总结-当前磁盘状态健康"}},[t._v("#")]),t._v(" ✅ 总结：当前磁盘状态健康")]),t._v(" "),v("table",[v("thead",[v("tr",[v("th",[t._v("分类")]),t._v(" "),v("th",[t._v("状态说明")])])]),t._v(" "),v("tbody",[v("tr",[v("td",[v("strong",[t._v("系统盘 /dev/vda1")])]),t._v(" "),v("td",[t._v("使用率 48%，非常健康")])]),t._v(" "),v("tr",[v("td",[v("strong",[t._v("容器 overlay")])]),t._v(" "),v("td",[t._v("都挂载在系统盘下，随容器而建")])]),t._v(" "),v("tr",[v("td",[v("strong",[t._v("NFS 网络盘")])]),t._v(" "),v("td",[t._v("使用 66%，也在正常范围")])]),t._v(" "),v("tr",[v("td",[v("strong",[t._v("tmpfs / shm")])]),t._v(" "),v("td",[t._v("基于内存的临时文件系统，占用极低")])]),t._v(" "),v("tr",[v("td",[v("strong",[t._v("没有分区超过 80%")])]),t._v(" "),v("td",[t._v("✅ 没有磁盘告警风险")])])])]),t._v(" "),v("hr"),t._v(" "),v("h2",{attrs:{id:"✅-建议-如长期运行"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#✅-建议-如长期运行"}},[t._v("#")]),t._v(" ✅ 建议（如长期运行）：")]),t._v(" "),v("table",[v("thead",[v("tr",[v("th",[t._v("场景")]),t._v(" "),v("th",[t._v("建议")])])]),t._v(" "),v("tbody",[v("tr",[v("td",[t._v("容器频繁重建")]),t._v(" "),v("td",[t._v("定期清理 "),v("code",[t._v("/var/lib/docker/overlay2")]),t._v(" 残留层")])]),t._v(" "),v("tr",[v("td",[t._v("NFS 写入慢")]),t._v(" "),v("td",[t._v("检查网络带宽与挂载参数（如 "),v("code",[t._v("rsize/wsize")]),t._v("）")])]),t._v(" "),v("tr",[v("td",[t._v("未来容量上涨风险")]),t._v(" "),v("td",[t._v("建议对根分区或 NFS 容量做容量监控，超过 85% 报警")])])])]),t._v(" "),v("hr"),t._v(" "),v("h2",{attrs:{id:"📋-字段中文说明"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#📋-字段中文说明"}},[t._v("#")]),t._v(" 📋 字段中文说明")]),t._v(" "),v("h3",{attrs:{id:"procs-进程队列"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#procs-进程队列"}},[t._v("#")]),t._v(" "),v("code",[t._v("procs（进程队列）")])]),t._v(" "),v("table",[v("thead",[v("tr",[v("th",[t._v("字段")]),t._v(" "),v("th",[t._v("含义")]),t._v(" "),v("th",[t._v("解读")])])]),t._v(" "),v("tbody",[v("tr",[v("td",[v("code",[t._v("r")])]),t._v(" "),v("td",[t._v("可运行进程数量（正在等待 CPU）")]),t._v(" "),v("td",[t._v("> 核心数时说明 "),v("strong",[t._v("CPU 繁忙/调度堵塞")])])]),t._v(" "),v("tr",[v("td",[v("code",[t._v("b")])]),t._v(" "),v("td",[t._v("正在等待 I/O 的进程")]),t._v(" "),v("td",[t._v("有值说明有 "),v("strong",[t._v("磁盘或网络 I/O 阻塞")])])])])]),t._v(" "),v("h3",{attrs:{id:"memory-内存"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#memory-内存"}},[t._v("#")]),t._v(" "),v("code",[t._v("memory（内存）")])]),t._v(" "),v("table",[v("thead",[v("tr",[v("th",[t._v("字段")]),t._v(" "),v("th",[t._v("含义")])])]),t._v(" "),v("tbody",[v("tr",[v("td",[v("code",[t._v("swpd")])]),t._v(" "),v("td",[t._v("使用的 swap 空间（KB）")])]),t._v(" "),v("tr",[v("td",[v("code",[t._v("free")])]),t._v(" "),v("td",[t._v("空闲内存")])]),t._v(" "),v("tr",[v("td",[v("code",[t._v("buff")])]),t._v(" "),v("td",[t._v("用作块缓存的内存")])]),t._v(" "),v("tr",[v("td",[v("code",[t._v("cache")])]),t._v(" "),v("td",[t._v("用作文件缓存的内存（可回收）")])])])]),t._v(" "),v("h3",{attrs:{id:"swap-交换分区"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#swap-交换分区"}},[t._v("#")]),t._v(" "),v("code",[t._v("swap（交换分区）")])]),t._v(" "),v("table",[v("thead",[v("tr",[v("th",[t._v("字段")]),t._v(" "),v("th",[t._v("含义")])])]),t._v(" "),v("tbody",[v("tr",[v("td",[v("code",[t._v("si")])]),t._v(" "),v("td",[t._v("从 swap 分区读入内存的速率（KB/s）")])]),t._v(" "),v("tr",[v("td",[v("code",[t._v("so")])]),t._v(" "),v("td",[t._v("从内存写入 swap 的速率（KB/s）")])])])]),t._v(" "),v("blockquote",[v("p",[t._v("一旦 "),v("code",[t._v("si/so > 0")]),t._v("，说明 "),v("strong",[t._v("内存压力大，正在使用 swap")])])]),t._v(" "),v("h3",{attrs:{id:"io-磁盘-i-o"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#io-磁盘-i-o"}},[t._v("#")]),t._v(" "),v("code",[t._v("io（磁盘 I/O）")])]),t._v(" "),v("table",[v("thead",[v("tr",[v("th",[t._v("字段")]),t._v(" "),v("th",[t._v("含义")])])]),t._v(" "),v("tbody",[v("tr",[v("td",[v("code",[t._v("bi")])]),t._v(" "),v("td",[t._v("每秒块设备读入速率（KB/s）")])]),t._v(" "),v("tr",[v("td",[v("code",[t._v("bo")])]),t._v(" "),v("td",[t._v("每秒块设备写出速率（KB/s）")])])])]),t._v(" "),v("h3",{attrs:{id:"system-系统"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#system-系统"}},[t._v("#")]),t._v(" "),v("code",[t._v("system（系统）")])]),t._v(" "),v("table",[v("thead",[v("tr",[v("th",[t._v("字段")]),t._v(" "),v("th",[t._v("含义")])])]),t._v(" "),v("tbody",[v("tr",[v("td",[v("code",[t._v("in")])]),t._v(" "),v("td",[t._v("每秒中断次数（包括时钟中断）")])]),t._v(" "),v("tr",[v("td",[v("code",[t._v("cs")])]),t._v(" "),v("td",[t._v("每秒上下文切换次数（线程调度频繁时变高）")])])])]),t._v(" "),v("h3",{attrs:{id:"cpu-cpu-使用率"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#cpu-cpu-使用率"}},[t._v("#")]),t._v(" "),v("code",[t._v("cpu（CPU 使用率）")])]),t._v(" "),v("table",[v("thead",[v("tr",[v("th",[t._v("字段")]),t._v(" "),v("th",[t._v("含义")])])]),t._v(" "),v("tbody",[v("tr",[v("td",[v("code",[t._v("us")])]),t._v(" "),v("td",[t._v("用户态 CPU 使用（Java、业务逻辑）")])]),t._v(" "),v("tr",[v("td",[v("code",[t._v("sy")])]),t._v(" "),v("td",[t._v("内核态 CPU 使用（系统调用、网络）")])]),t._v(" "),v("tr",[v("td",[v("code",[t._v("id")])]),t._v(" "),v("td",[t._v("空闲 CPU 比例")])]),t._v(" "),v("tr",[v("td",[v("code",[t._v("wa")])]),t._v(" "),v("td",[t._v("等待 I/O 比例（磁盘/网络慢时变高）")])]),t._v(" "),v("tr",[v("td",[v("code",[t._v("st")])]),t._v(" "),v("td",[t._v("被虚拟化系统抢占的时间（云主机特有）")])])])]),t._v(" "),v("hr"),t._v(" "),v("h2",{attrs:{id:"🔍-当前系统状态分析-从每秒变化行判断"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#🔍-当前系统状态分析-从每秒变化行判断"}},[t._v("#")]),t._v(" 🔍 当前系统状态分析（从每秒变化行判断）")]),t._v(" "),v("table",[v("thead",[v("tr",[v("th",[t._v("项目")]),t._v(" "),v("th",[t._v("观察值")]),t._v(" "),v("th",[t._v("解读")])])]),t._v(" "),v("tbody",[v("tr",[v("td",[v("code",[t._v("r")]),t._v(" 平均 1~6")]),t._v(" "),v("td",[t._v("有时高达 6")]),t._v(" "),v("td",[t._v("有"),v("strong",[t._v("并发负载")]),t._v("但没过载（系统为 4 核）属正常")])]),t._v(" "),v("tr",[v("td",[v("code",[t._v("b")]),t._v(" 一直为 0")]),t._v(" "),v("td",[t._v("无进程阻塞在 IO")]),t._v(" "),v("td",[t._v("没有明显磁盘瓶颈")])]),t._v(" "),v("tr",[v("td",[v("code",[t._v("si/so")]),t._v(" 为 0")]),t._v(" "),v("td",[t._v("没用 swap（也确实未启用）")]),t._v(" "),v("td",[t._v("✅")])]),t._v(" "),v("tr",[v("td",[v("code",[t._v("wa")]),t._v(" 平均 1~4%")]),t._v(" "),v("td",[t._v("有少量 IO 等待")]),t._v(" "),v("td",[t._v("小负载，无需担忧，持续观察")])]),t._v(" "),v("tr",[v("td",[v("code",[t._v("cs")]),t._v(" 约 12w 次/s")]),t._v(" "),v("td",[v("strong",[t._v("线程调度极频繁")]),t._v("，可能 Java 应用上下文切换活跃")]),t._v(" "),v("td")]),t._v(" "),v("tr",[v("td",[v("code",[t._v("us+sy")]),t._v(" 在 17~28%")]),t._v(" "),v("td",[t._v("CPU 利用合理")]),t._v(" "),v("td",[t._v("有一定业务压力但没有瓶颈")])])])]),t._v(" "),v("hr"),t._v(" "),v("h2",{attrs:{id:"✅-总体结论"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#✅-总体结论"}},[t._v("#")]),t._v(" ✅ 总体结论")]),t._v(" "),v("p",[t._v("当前系统 "),v("strong",[t._v("运行健康，暂无严重瓶颈")]),t._v("，仅有以下轻微负载现象：")]),t._v(" "),v("ul",[v("li",[v("p",[v("code",[t._v("cs")]),t._v("（上下文切换）很高，说明线程调度频繁，可能与：")]),t._v(" "),v("ul",[v("li",[v("strong",[t._v("RocketMQ / Cassandra 多线程并发处理任务有关")])]),t._v(" "),v("li",[t._v("可以通过 "),v("code",[t._v("top -H -p <pid>")]),t._v(" 和 "),v("code",[t._v("jstack")]),t._v(" 分析具体线程活跃情况")])])]),t._v(" "),v("li",[v("p",[v("code",[t._v("wa")]),t._v(" 稍有提升（1~4%），若持续走高可进一步分析 IO 层：")]),t._v(" "),v("ul",[v("li",[t._v("通过 "),v("code",[t._v("iostat -x 1")]),t._v("、"),v("code",[t._v("iotop")]),t._v(" 或 "),v("code",[t._v("dstat -dny")]),t._v(" 查看慢盘、IO高进程")])])])]),t._v(" "),v("hr"),t._v(" "),v("h2",{attrs:{id:"📌-后续建议"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#📌-后续建议"}},[t._v("#")]),t._v(" 📌 后续建议")]),t._v(" "),v("table",[v("thead",[v("tr",[v("th",[t._v("场景")]),t._v(" "),v("th",[t._v("建议")])])]),t._v(" "),v("tbody",[v("tr",[v("td",[t._v("持续 cs 很高")]),t._v(" "),v("td",[v("code",[t._v("perf top")]),t._v(" 或 "),v("code",[t._v("jstack")]),t._v(" 查热点线程")])]),t._v(" "),v("tr",[v("td",[t._v("wa 明显升高")]),t._v(" "),v("td",[t._v("查看 "),v("code",[t._v("iotop")]),t._v("、分区是否爆写、慢磁盘")])]),t._v(" "),v("tr",[v("td",[t._v("r > 4 持续高")]),t._v(" "),v("td",[t._v("检查 CPU 是否瓶颈、是否需要扩容")])]),t._v(" "),v("tr",[v("td",[t._v("swap 未启用")]),t._v(" "),v("td",[t._v("已知但已巡检完毕（上一步已创建脚本）")])])])]),t._v(" "),v("hr"),t._v(" "),v("h2",{attrs:{id:"📋-前十内存占用进程分析表"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#📋-前十内存占用进程分析表"}},[t._v("#")]),t._v(" 📋 前十内存占用进程分析表")]),t._v(" "),v("table",[v("thead",[v("tr",[v("th",[t._v("排名")]),t._v(" "),v("th",[t._v("应用")]),t._v(" "),v("th",[t._v("%MEM")]),t._v(" "),v("th",[t._v("RSS（常驻内存）")]),t._v(" "),v("th",[t._v("Xmx配置")]),t._v(" "),v("th",[t._v("分析要点")])])]),t._v(" "),v("tbody",[v("tr",[v("td",[t._v("①")]),t._v(" "),v("td",[t._v("Elasticsearch")]),t._v(" "),v("td",[t._v("16.4%")]),t._v(" "),v("td",[t._v("~2.6 GB")]),t._v(" "),v("td",[v("code",[t._v("-Xmx2g")])]),t._v(" "),v("td",[t._v("内存已接近上限，正常但需监控 GC 和查询负载")])]),t._v(" "),v("tr",[v("td",[t._v("②")]),t._v(" "),v("td",[t._v("RocketMQ Broker")]),t._v(" "),v("td",[t._v("8.5%")]),t._v(" "),v("td",[t._v("~1.3 GB")]),t._v(" "),v("td",[v("code",[t._v("-Xmx1g")])]),t._v(" "),v("td",[t._v("超出配置值（说明使用了直接内存 / MappedByteBuffer）")])]),t._v(" "),v("tr",[v("td",[t._v("③")]),t._v(" "),v("td",[t._v("Cassandra")]),t._v(" "),v("td",[t._v("6.0%")]),t._v(" "),v("td",[t._v("~964 MB")]),t._v(" "),v("td",[v("code",[t._v("-Xmx512m")])]),t._v(" "),v("td",[t._v("内存明显超出配置，"),v("strong",[t._v("可能内存泄漏或 jamm 统计不准")])])]),t._v(" "),v("tr",[v("td",[t._v("④")]),t._v(" "),v("td",[t._v("Kafka ZK")]),t._v(" "),v("td",[t._v("2.6%")]),t._v(" "),v("td",[t._v("~428 MB")]),t._v(" "),v("td",[v("code",[t._v("-Xmx512m")])]),t._v(" "),v("td",[t._v("属于 Zookeeper，不算高，正常")])]),t._v(" "),v("tr",[v("td",[t._v("⑤")]),t._v(" "),v("td",[t._v("ArgusAgent")]),t._v(" "),v("td",[t._v("1.7%")]),t._v(" "),v("td",[t._v("~283 MB")]),t._v(" "),v("td",[t._v("N/A")]),t._v(" "),v("td",[t._v("云监控 Agent，轻量服务")])]),t._v(" "),v("tr",[v("td",[t._v("⑥")]),t._v(" "),v("td",[t._v("MongoDB")]),t._v(" "),v("td",[t._v("1.7%")]),t._v(" "),v("td",[t._v("~272 MB")]),t._v(" "),v("td",[t._v("N/A")]),t._v(" "),v("td",[t._v("内存占比合理")])]),t._v(" "),v("tr",[v("td",[t._v("⑦")]),t._v(" "),v("td",[t._v("MariaDB")]),t._v(" "),v("td",[t._v("1.6%")]),t._v(" "),v("td",[t._v("~270 MB")]),t._v(" "),v("td",[t._v("N/A")]),t._v(" "),v("td",[t._v("可结合 "),v("code",[t._v("innodb_buffer_pool_size")]),t._v(" 优化")])]),t._v(" "),v("tr",[v("td",[t._v("⑧")]),t._v(" "),v("td",[t._v("RocketMQ NameServer")]),t._v(" "),v("td",[t._v("1.4%")]),t._v(" "),v("td",[t._v("~228 MB")]),t._v(" "),v("td",[v("code",[t._v("-Xmx512m")])]),t._v(" "),v("td",[t._v("内存正常，GC 配置较保守")])]),t._v(" "),v("tr",[v("td",[t._v("⑨")]),t._v(" "),v("td",[t._v("ClickHouse")]),t._v(" "),v("td",[t._v("0.8%")]),t._v(" "),v("td",[t._v("~134 MB")]),t._v(" "),v("td",[t._v("N/A")]),t._v(" "),v("td",[t._v("非热点时低占用合理")])])])]),t._v(" "),v("hr"),t._v(" "),v("h2",{attrs:{id:"🔍-关键诊断结论"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#🔍-关键诊断结论"}},[t._v("#")]),t._v(" 🔍 关键诊断结论")]),t._v(" "),v("h3",{attrs:{id:"✅-正常情况"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#✅-正常情况"}},[t._v("#")]),t._v(" ✅ 正常情况：")]),t._v(" "),v("ul",[v("li",[t._v("ES、RocketMQ、Cassandra 都运行在较高负载下，但仍在系统总内存承受范围内。")]),t._v(" "),v("li",[t._v("MongoDB、MariaDB、ClickHouse 占用轻量，无性能隐患。")])]),t._v(" "),v("h3",{attrs:{id:"⚠️-异常-需关注点"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#⚠️-异常-需关注点"}},[t._v("#")]),t._v(" ⚠️ 异常/需关注点：")]),t._v(" "),v("table",[v("thead",[v("tr",[v("th",[t._v("问题")]),t._v(" "),v("th",[t._v("建议")])])]),t._v(" "),v("tbody",[v("tr",[v("td",[t._v("Cassandra 使用超出 "),v("code",[t._v("Xmx512M")]),t._v(" 明显异常")]),t._v(" "),v("td",[t._v("- 可能是 native memory 泄漏（如 jemalloc 未限制） - 建议 "),v("strong",[t._v("增加 Xmx 到 1~2G 并限制 jemalloc preload")]),t._v(" 或观察 "),v("code",[t._v("jcmd/jmap")])])]),t._v(" "),v("tr",[v("td",[t._v("RocketMQ Broker 超出 "),v("code",[t._v("Xmx1G")])]),t._v(" "),v("td",[t._v("- 说明使用了大量 off-heap（如 commitlog 映射） - 检查 "),v("code",[t._v("MaxDirectMemorySize")]),t._v("、PageCache 是否命中率低")])]),t._v(" "),v("tr",[v("td",[t._v("ES 占用 2.6G 接近上限")]),t._v(" "),v("td",[t._v("- 若频繁 Full GC，可增加 "),v("code",[t._v("Xmx")]),t._v(" 或优化查询 DSL / 分片数")])]),t._v(" "),v("tr",[v("td",[t._v("无 Swap 空间，系统临界状态风险高")]),t._v(" "),v("td",[t._v("- 建议立即挂载 "),v("code",[t._v("swap")]),t._v("，参考前述脚本 "),v("code",[t._v("enable_swap.sh")])])])])]),t._v(" "),v("hr"),t._v(" "),v("h2",{attrs:{id:"🛠️-下一步建议操作"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#🛠️-下一步建议操作"}},[t._v("#")]),t._v(" 🛠️ 下一步建议操作")]),t._v(" "),v("table",[v("thead",[v("tr",[v("th",[t._v("目标")]),t._v(" "),v("th",[t._v("建议操作")])])]),t._v(" "),v("tbody",[v("tr",[v("td",[t._v("分析 Cassandra 内存使用")]),t._v(" "),v("td",[v("code",[t._v("jcmd <pid> VM.native_memory summary")]),t._v(" 或 "),v("code",[t._v("jmap -heap <pid>")])])]),t._v(" "),v("tr",[v("td",[t._v("检查 RocketMQ 是否 DirectMemory 使用超限")]),t._v(" "),v("td",[t._v("查看 "),v("code",[t._v("MaxDirectMemorySize")]),t._v("、日志 GC FullGC 频率")])]),t._v(" "),v("tr",[v("td",[t._v("ES 优化")]),t._v(" "),v("td",[t._v("- 查看 "),v("code",[t._v("/_cat/segments?v")]),t._v(" 是否碎片多 - "),v("code",[t._v("/_nodes/stats/jvm")]),t._v(" 看 GC stats")])]),t._v(" "),v("tr",[v("td",[t._v("定期巡检脚本加入 mem + GC 检测")]),t._v(" "),v("td",[t._v("扩展前述巡检脚本中添加："),v("code",[t._v("jstat -gc <pid>")]),t._v(" / "),v("code",[t._v("grep -i gc.log")])])])])]),t._v(" "),v("hr"),t._v(" "),v("h2",{attrs:{id:"📊-当前内存使用情况-单位-gb"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#📊-当前内存使用情况-单位-gb"}},[t._v("#")]),t._v(" 📊 当前内存使用情况（单位：GB）")]),t._v(" "),v("table",[v("thead",[v("tr",[v("th",[t._v("项目")]),t._v(" "),v("th",[t._v("数值")]),t._v(" "),v("th",[t._v("说明")])])]),t._v(" "),v("tbody",[v("tr",[v("td",[v("strong",[t._v("total")])]),t._v(" "),v("td",[t._v("15G")]),t._v(" "),v("td",[t._v("总物理内存")])]),t._v(" "),v("tr",[v("td",[v("strong",[t._v("used")])]),t._v(" "),v("td",[t._v("7.1G")]),t._v(" "),v("td",[t._v("已使用（不包括缓存）")])]),t._v(" "),v("tr",[v("td",[v("strong",[t._v("free")])]),t._v(" "),v("td",[t._v("732M")]),t._v(" "),v("td",[t._v("真正未被使用的内存（很少）")])]),t._v(" "),v("tr",[v("td",[v("strong",[t._v("buff/cache")])]),t._v(" "),v("td",[t._v("7.4G")]),t._v(" "),v("td",[t._v("被操作系统用于缓存（可回收）")])]),t._v(" "),v("tr",[v("td",[v("strong",[t._v("available")])]),t._v(" "),v("td",[t._v("7.8G")]),t._v(" "),v("td",[t._v("实际可用（空闲 + 可回收缓存）")])])])]),t._v(" "),v("hr"),t._v(" "),v("h2",{attrs:{id:"🧠-内存使用解读"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#🧠-内存使用解读"}},[t._v("#")]),t._v(" 🧠 内存使用解读：")]),t._v(" "),v("ul",[v("li",[v("strong",[t._v("空闲内存（free）仅 732MB")]),t._v("，看似很少，但这是 Linux 的正常表现。")]),t._v(" "),v("li",[v("strong",[t._v("buff/cache 高达 7.4G")]),t._v("：Linux 会把没被用的内存尽可能用来缓存磁盘数据，以提升系统效率。")]),t._v(" "),v("li",[v("strong",[t._v("available 达到 7.8G")]),t._v("：说明还有足够的内存供新程序使用，不存在真正的内存压力。")])]),t._v(" "),v("hr"),t._v(" "),v("h2",{attrs:{id:"❄️-swap-分区情况"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#❄️-swap-分区情况"}},[t._v("#")]),t._v(" ❄️ Swap 分区情况：")]),t._v(" "),v("div",{staticClass:"language- extra-class"},[v("pre",[v("code",[t._v("Swap: 0B total, 0B used\n")])])]),v("blockquote",[v("p",[t._v("系统当前没有启用 Swap 分区，也就是没有交换空间。")])]),t._v(" "),v("h3",{attrs:{id:"📌-有无-swap-的区别"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#📌-有无-swap-的区别"}},[t._v("#")]),t._v(" 📌 有无 Swap 的区别：")]),t._v(" "),v("table",[v("thead",[v("tr",[v("th",[t._v("项目")]),t._v(" "),v("th",[t._v("有 Swap")]),t._v(" "),v("th",[t._v("无 Swap")])])]),t._v(" "),v("tbody",[v("tr",[v("td",[t._v("内存满后")]),t._v(" "),v("td",[t._v("会暂存到硬盘（慢）")]),t._v(" "),v("td",[t._v("会直接触发 OOM 杀死进程")])]),t._v(" "),v("tr",[v("td",[t._v("稳定性")]),t._v(" "),v("td",[t._v("更稳")]),t._v(" "),v("td",[t._v("有 OOM 风险")])]),t._v(" "),v("tr",[v("td",[t._v("性能")]),t._v(" "),v("td",[t._v("偶尔慢（如大 GC）")]),t._v(" "),v("td",[t._v("更高（无换页）")])])])]),t._v(" "),v("hr"),t._v(" "),v("h3",{attrs:{id:"✅-建议是否开启-swap"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#✅-建议是否开启-swap"}},[t._v("#")]),t._v(" ✅ 建议是否开启 Swap？")]),t._v(" "),v("table",[v("thead",[v("tr",[v("th",[t._v("场景")]),t._v(" "),v("th",[t._v("建议")])])]),t._v(" "),v("tbody",[v("tr",[v("td",[t._v("应用可控、服务轻量")]),t._v(" "),v("td",[v("strong",[t._v("可不启用")]),t._v("，避免频繁换页")])]),t._v(" "),v("tr",[v("td",[t._v("有 JVM、大内存服务（如 Cassandra、Elasticsearch）")]),t._v(" "),v("td",[t._v("✅ "),v("strong",[t._v("建议启用 2~4GB swap 分区")]),t._v(" 作为保护")])]),t._v(" "),v("tr",[v("td",[t._v("云服务器（如阿里云 ECS）")]),t._v(" "),v("td",[t._v("可用 "),v("code",[t._v("swapfile")]),t._v(" 快速挂载临时 swap 空间")])])])]),t._v(" "),v("hr"),t._v(" "),v("h2",{attrs:{id:"🛠️-快速添加-swap-示例-无需重启"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#🛠️-快速添加-swap-示例-无需重启"}},[t._v("#")]),t._v(" 🛠️ 快速添加 Swap 示例（无需重启）")]),t._v(" "),v("div",{staticClass:"language- extra-class"},[v("pre",[v("code",[t._v("# 创建一个 2GB 的 swap 文件\nfallocate -l 2G /swapfile\nchmod 600 /swapfile\nmkswap /swapfile\nswapon /swapfile\n\n# 查看效果\nfree -h\n")])])]),v("blockquote",[v("p",[t._v("如需永久生效，请在 "),v("code",[t._v("/etc/fstab")]),t._v(" 中添加：")])]),t._v(" "),v("div",{staticClass:"language- extra-class"},[v("pre",[v("code",[t._v("/swapfile none swap sw 0 0\n")])])]),v("hr"),t._v(" "),v("div",{staticClass:"language- extra-class"},[v("pre",{pre:!0,attrs:{class:"language-text"}},[v("code",[t._v("📋 系统性能巡检报告 - Sun May 18 08:45:43     2025\n=========================================\n\n🧠 [CPU 使用情况]\n./sys_check.sh: line 8: mpstat: command not found\n\n📈 [系统负载 - load average]\n./sys_check.sh: line 12: uptime: command not found\n\n🔥 [Top 5 CPU 占用进程]\nps: unknown option -- o\nTry `ps --help' for more information.\n\n💾 [Top 5 内存占用进程]\nps: unknown option -- o\nTry `ps --help' for more information.\n\n📊 [内存使用 free -h]\n./sys_check.sh: line 24: free: command not found\n\n🧊 [Swap 使用情况]\n./sys_check.sh: line 28: swapon: command not found\n未启用 swap\n\n🖴 [磁盘 IO 性能 iostat]\n./sys_check.sh: line 32: iostat: command not found\n\n💽 [磁盘使用情况 df -h]\nFilesystem       Size  Used Avail Use% Mounted on\nD:/software/Git  621G  334G  288G  54% /\nC:               300G  199G  102G  67% /c\n\n🧱 [磁盘 inode 使用情况]\nFilesystem      Inodes IUsed IFree IUse% Mounted on\nD:/software/Git      -     -     -     - /\nC:                   -     -     -     - /c\n\n🌐 [网络连接统计 ss -s]\n./sys_check.sh: line 44: ss: command not found\n\n📡 [网络流量]\n❗ 未安装 ifstat，跳过网络流量采集\n\n⚠️ [关键系统日志 (dmesg)]\n./sys_check.sh: line 57: dmesg: command not found\n\n✅ 巡检完成！\n\n")])])]),v("h2",{attrs:{id:"📋-字段中文含义"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#📋-字段中文含义"}},[t._v("#")]),t._v(" 📋 字段中文含义")]),t._v(" "),v("table",[v("thead",[v("tr",[v("th",[t._v("字段")]),t._v(" "),v("th",[t._v("含义")])])]),t._v(" "),v("tbody",[v("tr",[v("td",[v("code",[t._v("%usr")])]),t._v(" "),v("td",[t._v("用户态 CPU 使用率（如 Java、Python 程序）")])]),t._v(" "),v("tr",[v("td",[v("code",[t._v("%nice")])]),t._v(" "),v("td",[t._v("改变优先级的进程占用率（通常为 0）")])]),t._v(" "),v("tr",[v("td",[v("code",[t._v("%sys")])]),t._v(" "),v("td",[t._v("内核态 CPU 使用率（系统调用、驱动等）")])]),t._v(" "),v("tr",[v("td",[v("code",[t._v("%iowait")])]),t._v(" "),v("td",[t._v("等待 I/O 的 CPU 时间占比（磁盘或网络慢）")])]),t._v(" "),v("tr",[v("td",[v("code",[t._v("%irq")])]),t._v(" "),v("td",[t._v("硬件中断时间占比（如网卡中断）")])]),t._v(" "),v("tr",[v("td",[v("code",[t._v("%soft")])]),t._v(" "),v("td",[t._v("软件中断（如内核定时器、网络协议栈）")])]),t._v(" "),v("tr",[v("td",[v("code",[t._v("%steal")])]),t._v(" "),v("td",[t._v("被虚拟化环境抢占的 CPU 时间（如云服务器）")])]),t._v(" "),v("tr",[v("td",[v("code",[t._v("%idle")])]),t._v(" "),v("td",[t._v("空闲时间")])])])]),t._v(" "),v("hr"),t._v(" "),v("h2",{attrs:{id:"✅-关键数据解读-汇总视角"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#✅-关键数据解读-汇总视角"}},[t._v("#")]),t._v(" ✅ 关键数据解读（汇总视角）")]),t._v(" "),v("h3",{attrs:{id:"📈-汇总行-cpu-all-整体平均"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#📈-汇总行-cpu-all-整体平均"}},[t._v("#")]),t._v(" 📈 汇总行 "),v("code",[t._v("CPU all")]),t._v("（整体平均）：")]),t._v(" "),v("div",{staticClass:"language- extra-class"},[v("pre",[v("code",[t._v("%usr:  9.68%\n%sys:  4.30%\n%iowait: 2.15%\n%soft: 2.42%\n%idle: 81.45%\n")])])]),v("h3",{attrs:{id:"🧠-分析"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#🧠-分析"}},[t._v("#")]),t._v(" 🧠 分析：")]),t._v(" "),v("ul",[v("li",[t._v("整体 CPU 利用率不算高，"),v("strong",[t._v("81% 空闲")])]),t._v(" "),v("li",[t._v("用户态使用率 ~9.68%，说明有正常的业务负载（如 Cassandra）")]),t._v(" "),v("li",[v("code",[t._v("iowait")]),t._v(" 为 "),v("strong",[t._v("2.15%")]),t._v(" ，轻微 I/O 等待，"),v("strong",[t._v("不严重但值得持续观察")])]),t._v(" "),v("li",[v("code",[t._v("soft")]),t._v("（软件中断）为 "),v("strong",[t._v("2.42%")]),t._v(" ，说明有一些网络、IO 或内核事件压力（可排查网络流量）")])]),t._v(" "),v("hr"),t._v(" "),v("h2",{attrs:{id:"🧠-分核心分析"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#🧠-分核心分析"}},[t._v("#")]),t._v(" 🧠 分核心分析：")]),t._v(" "),v("p",[t._v("| 核心 | %usr | %sys | %iowait | %soft | %idle | 说明 |"),v("br"),t._v("\n|------|------|------|---------|--------|--------|"),v("br"),t._v("\n| CPU0 | 7.61 | 4.35 | 3.26 | 3.26 | 81.52 | IO/软中断略高，稳定 |"),v("br"),t._v("\n| CPU1 | 12.77| 3.19 | 2.13 | 1.06 | 80.85 | 主要在处理业务逻辑（如 Java 线程） |"),v("br"),t._v("\n| CPU2 | 8.79 | 4.40 | 1.10 | 4.40 | 81.32 | soft 较高，可能是网络或 Cassandra 线程池抢占 |"),v("br"),t._v("\n| CPU3 | 8.60 | 3.23 | 2.15 | 1.08 | 84.95 | 最轻松的核之一 |")]),t._v(" "),v("hr"),t._v(" "),v("h2",{attrs:{id:"🔎-初步结论"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#🔎-初步结论"}},[t._v("#")]),t._v(" 🔎 初步结论")]),t._v(" "),v("ul",[v("li",[v("p",[t._v("当前系统整体 "),v("strong",[t._v("无严重 CPU 瓶颈")]),t._v("，主要是：")]),t._v(" "),v("ul",[v("li",[t._v("Cassandra、RocketMQ 进程在合理使用资源")]),t._v(" "),v("li",[v("strong",[t._v("部分核心 "),v("code",[t._v("soft")]),t._v(" 较高")]),t._v("，可能是 "),v("strong",[t._v("网络中断或 Java 应用线程切换频繁")])])])]),t._v(" "),v("li",[v("p",[t._v("如果你在排查性能瓶颈，"),v("strong",[t._v("更可能出现在 JVM 层（GC、线程调度）或磁盘 IO 层")])])])]),t._v(" "),v("hr"),t._v(" "),v("h2",{attrs:{id:"📌-建议下一步排查"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#📌-建议下一步排查"}},[t._v("#")]),t._v(" 📌 建议下一步排查：")]),t._v(" "),v("table",[v("thead",[v("tr",[v("th",[t._v("排查项")]),t._v(" "),v("th",[t._v("命令/建议")])])]),t._v(" "),v("tbody",[v("tr",[v("td",[t._v("查看 Cassandra 是否 GC 频繁")]),t._v(" "),v("td",[v("code",[t._v("tail -f gc.log")]),t._v(" 或使用 "),v("code",[t._v("jstat -gc PID 1s 10")])])]),t._v(" "),v("tr",[v("td",[t._v("查看软中断来源")]),t._v(" "),v("td",[v("code",[t._v("cat /proc/softirqs")]),t._v(" 观察哪一类中断频繁（如 NET_RX）")])]),t._v(" "),v("tr",[v("td",[t._v("磁盘 IO")]),t._v(" "),v("td",[v("code",[t._v("iostat -x 1")]),t._v(" 或 "),v("code",[t._v("iotop")])])]),t._v(" "),v("tr",[v("td",[t._v("网络流量瓶颈")]),t._v(" "),v("td",[v("code",[t._v("iftop")]),t._v(" 或 "),v("code",[t._v("nload")]),t._v("，看是否有卡顿或高流量进程")])]),t._v(" "),v("tr",[v("td",[t._v("Cassandra 压力")]),t._v(" "),v("td",[t._v("查询慢日志、Compaction 状态、Pending Tasks")])])])]),t._v(" "),v("hr"),t._v(" "),v("p",[t._v("Linux 3.10.0-1160.76.1.el7.x86_64 (node-6) 05/18/2025 "),v("em",[t._v("x86_64")]),t._v(" (4 CPU)\n08:07:05 AM CPU %usr %nice %sys %iowait %irq %soft %steal %guest %gnice %idle")]),t._v(" "),v("h2",{attrs:{id:"📋-表头说明-字段解释"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#📋-表头说明-字段解释"}},[t._v("#")]),t._v(" 📋 表头说明（字段解释）")]),t._v(" "),v("table",[v("thead",[v("tr",[v("th",[t._v("字段")]),t._v(" "),v("th",[t._v("含义")])])]),t._v(" "),v("tbody",[v("tr",[v("td",[v("code",[t._v("USER")])]),t._v(" "),v("td",[t._v("启动该进程的用户")])]),t._v(" "),v("tr",[v("td",[v("code",[t._v("PID")])]),t._v(" "),v("td",[t._v("进程 ID")])]),t._v(" "),v("tr",[v("td",[v("code",[t._v("%CPU")])]),t._v(" "),v("td",[t._v("CPU 使用率（越高说明该进程占用越多 CPU）")])]),t._v(" "),v("tr",[v("td",[v("code",[t._v("%MEM")])]),t._v(" "),v("td",[t._v("内存使用率")])]),t._v(" "),v("tr",[v("td",[v("code",[t._v("VSZ")])]),t._v(" "),v("td",[t._v("虚拟内存大小（单位 KB）")])]),t._v(" "),v("tr",[v("td",[v("code",[t._v("RSS")])]),t._v(" "),v("td",[t._v("常驻内存大小（实际占用的物理内存，单位 KB）")])]),t._v(" "),v("tr",[v("td",[v("code",[t._v("TTY")])]),t._v(" "),v("td",[t._v("终端设备（大多数服务进程为 "),v("code",[t._v("?")]),t._v("，表示不是由终端启动）")])]),t._v(" "),v("tr",[v("td",[v("code",[t._v("STAT")])]),t._v(" "),v("td",[t._v("进程状态（如 S=睡眠，R=运行，Z=僵尸，Ssl=有控制终端+后台运行）")])]),t._v(" "),v("tr",[v("td",[v("code",[t._v("START")])]),t._v(" "),v("td",[t._v("进程启动时间")])]),t._v(" "),v("tr",[v("td",[v("code",[t._v("TIME")])]),t._v(" "),v("td",[t._v("累计占用 CPU 的时间（越大越占用资源）")])]),t._v(" "),v("tr",[v("td",[v("code",[t._v("COMMAND")])]),t._v(" "),v("td",[t._v("执行命令及其参数")])])])]),t._v(" "),v("hr"),t._v(" "),v("h2",{attrs:{id:"🔍-每一行的中文逐行解释"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#🔍-每一行的中文逐行解释"}},[t._v("#")]),t._v(" 🔍 每一行的中文逐行解释")]),t._v(" "),v("h3",{attrs:{id:"_1-cassandra-java-进程"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#_1-cassandra-java-进程"}},[t._v("#")]),t._v(" "),v("strong",[t._v("① Cassandra Java 进程")])]),t._v(" "),v("div",{staticClass:"language- extra-class"},[v("pre",[v("code",[t._v("cassand+ 31037 27.5  5.9 3707904 954832 ? Ssl Apr25 8990:29 java ... CassandraDaemon\n")])])]),v("ul",[v("li",[v("strong",[t._v("CPU 占比 27.5%")]),t._v(" ，长期运行（累计占用近 9000 分钟）")]),t._v(" "),v("li",[t._v("说明 Cassandra 数据库实例长期占用 CPU，非常可疑，需重点排查。")]),t._v(" "),v("li",[t._v("参数显示 "),v("code",[t._v("-Xms512M -Xmx512M")]),t._v("，内存设置很低，可能是性能瓶颈。")])]),t._v(" "),v("h3",{attrs:{id:"_2-rocketmq-broker"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#_2-rocketmq-broker"}},[t._v("#")]),t._v(" "),v("strong",[t._v("② RocketMQ Broker")])]),t._v(" "),v("div",{staticClass:"language- extra-class"},[v("pre",[v("code",[t._v("xxx 5500  7.0  8.5 7110980 1365700 ? Sl Apr25 2288:02 java ... BrokerStartup\n")])])]),v("ul",[v("li",[v("strong",[t._v("CPU 占用 7.0%")]),t._v(" ，占用内存较多（~1.3GB）")]),t._v(" "),v("li",[t._v("是一个 RocketMQ 的 broker 节点")]),t._v(" "),v("li",[t._v("负载明显，但不异常，可能消息量大时拉高")])]),t._v(" "),v("h3",{attrs:{id:"_3-clickhouse-数据库"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#_3-clickhouse-数据库"}},[t._v("#")]),t._v(" "),v("strong",[t._v("③ ClickHouse 数据库")])]),t._v(" "),v("div",{staticClass:"language- extra-class"},[v("pre",[v("code",[t._v("101 1873  2.6  0.8 6164148 142632 ? Sl Apr15 1254:38 clickhouse-server\n")])])]),v("ul",[v("li",[v("strong",[t._v("轻微 CPU 占用")]),t._v("，常驻服务，说明有活跃查询或聚合任务")])]),t._v(" "),v("h3",{attrs:{id:"_4-elasticsearch"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#_4-elasticsearch"}},[t._v("#")]),t._v(" "),v("strong",[t._v("④ Elasticsearch")])]),t._v(" "),v("div",{staticClass:"language- extra-class"},[v("pre",[v("code",[t._v("cassand+ 7240  2.6 16.3 8373412 2621424 ? Sl May16 54:21 java ... elasticsearch\n")])])]),v("ul",[v("li",[v("strong",[t._v("CPU 占用正常，内存占比极高")]),t._v("（2.5GB，16.3%）")]),t._v(" "),v("li",[t._v("如果没有禁用 swap 且内存紧张，ES 容易引发 GC 或卡顿")])]),t._v(" "),v("h3",{attrs:{id:"_5-kubelet"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#_5-kubelet"}},[t._v("#")]),t._v(" "),v("strong",[t._v("⑤ Kubelet")])]),t._v(" "),v("div",{staticClass:"language- extra-class"},[v("pre",[v("code",[t._v("root 12693  1.3  0.4 1599980 79768 ? Ssl Apr03 891:25 kubelet ...\n")])])]),v("ul",[v("li",[t._v("Kubernetes 管理组件，用于 Node 节点状态同步")]),t._v(" "),v("li",[t._v("占用不高，属正常范围")])]),t._v(" "),v("h3",{attrs:{id:"_6-docker-daemon"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#_6-docker-daemon"}},[t._v("#")]),t._v(" "),v("strong",[t._v("⑥ Docker Daemon")])]),t._v(" "),v("div",{staticClass:"language- extra-class"},[v("pre",[v("code",[t._v("root 12415  0.9  0.4 1842672 76780 ? Ssl Apr03 613:03 dockerd ...\n")])])]),v("ul",[v("li",[t._v("Docker 服务守护进程，长期运行的正常状态")])]),t._v(" "),v("h3",{attrs:{id:"_7-阿里云安全监控进程"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#_7-阿里云安全监控进程"}},[t._v("#")]),t._v(" "),v("strong",[t._v("⑦ 阿里云安全监控进程")])]),t._v(" "),v("div",{staticClass:"language- extra-class"},[v("pre",[v("code",[t._v("root 14943  0.9  0.1 175748 25652 ? Ssl Apr15 445:20 AliYunDunMonitor\n")])])]),v("ul",[v("li",[t._v("阿里云服务器安全 agent，CPU 占用稳定")])]),t._v(" "),v("h3",{attrs:{id:"_8-内核工作线程"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#_8-内核工作线程"}},[t._v("#")]),t._v(" "),v("strong",[t._v("⑧ 内核工作线程")])]),t._v(" "),v("div",{staticClass:"language- extra-class"},[v("pre",[v("code",[t._v("root 12709  0.8  0.0 0 0 ? S< 06:54 0:16 [kworker/2:2H]\n")])])]),v("ul",[v("li",[t._v("后台硬件处理线程（内核级），略有活动")])]),t._v(" "),v("h3",{attrs:{id:"_9-云监控-agent"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#_9-云监控-agent"}},[t._v("#")]),t._v(" "),v("strong",[t._v("⑨ 云监控 Agent")])]),t._v(" "),v("div",{staticClass:"language- extra-class"},[v("pre",[v("code",[t._v("root 21524  0.3  1.7 2165708 283472 ? Sl 2023 3406:46 argusagent\n")])])]),v("ul",[v("li",[t._v("阿里云/腾讯云等监控 agent，占用略高但可以接受")])]),t._v(" "),v("hr"),t._v(" "),v("h2",{attrs:{id:"📌-当前系统状况总结"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#📌-当前系统状况总结"}},[t._v("#")]),t._v(" 📌 当前系统状况总结")]),t._v(" "),v("table",[v("thead",[v("tr",[v("th",[t._v("项目")]),t._v(" "),v("th",[t._v("结论")])])]),t._v(" "),v("tbody",[v("tr",[v("td",[v("strong",[t._v("高 CPU 占用进程")])]),t._v(" "),v("td",[t._v("Cassandra、RocketMQ Broker")])]),t._v(" "),v("tr",[v("td",[v("strong",[t._v("高内存进程")])]),t._v(" "),v("td",[t._v("Elasticsearch、RocketMQ")])]),t._v(" "),v("tr",[v("td",[v("strong",[t._v("关键建议")])]),t._v(" "),v("td",[t._v("Cassandra 已长期占用大量 CPU，应检查其负载是否异常")])])])]),t._v(" "),v("hr"),t._v(" "),v("h2",{attrs:{id:"✅-后续排查建议-重点-cassandra"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#✅-后续排查建议-重点-cassandra"}},[t._v("#")]),t._v(" ✅ 后续排查建议（重点 Cassandra）：")]),t._v(" "),v("h3",{attrs:{id:"▶-1-线程层级分析"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#▶-1-线程层级分析"}},[t._v("#")]),t._v(" ▶ 1. 线程层级分析")]),t._v(" "),v("div",{staticClass:"language- extra-class"},[v("pre",[v("code",[t._v("top -Hp 31037            # 找出 Cassandra 的高 CPU 线程\n")])])]),v("h3",{attrs:{id:"▶-2-栈调用分析-排查死循环或热点"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#▶-2-栈调用分析-排查死循环或热点"}},[t._v("#")]),t._v(" ▶ 2. 栈调用分析（排查死循环或热点）")]),t._v(" "),v("div",{staticClass:"language- extra-class"},[v("pre",[v("code",[t._v("jstack 31037 > jstack.log\n")])])]),v("h3",{attrs:{id:"▶-3-gc-日志分析"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#▶-3-gc-日志分析"}},[t._v("#")]),t._v(" ▶ 3. GC 日志分析")]),t._v(" "),v("div",{staticClass:"language- extra-class"},[v("pre",[v("code",[t._v("less /usr/local/apache-cassandra-3.11.2/logs/gc.log\n")])])]),v("ul",[v("li",[t._v("是否频繁 Full GC？")]),t._v(" "),v("li",[t._v("GC 时间是否过长？")])]),t._v(" "),v("h3",{attrs:{id:"▶-4-磁盘和-compaction-压力"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#▶-4-磁盘和-compaction-压力"}},[t._v("#")]),t._v(" ▶ 4. 磁盘和 compaction 压力")]),t._v(" "),v("ul",[v("li",[t._v("查看 "),v("code",[t._v("system.log")]),t._v(" 是否有 compaction 持续进行")])]),t._v(" "),v("div",{staticClass:"language- extra-class"},[v("pre",[v("code",[t._v("tail -f /usr/local/apache-cassandra-3.11.2/logs/system.log\n")])])]),v("hr"),t._v(" "),v("h2",{attrs:{id:"🧾-第一行-系统运行时间与负载情况"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#🧾-第一行-系统运行时间与负载情况"}},[t._v("#")]),t._v(" 🧾 第一行：系统运行时间与负载情况")]),t._v(" "),v("div",{staticClass:"language- extra-class"},[v("pre",[v("code",[t._v("top - 07:02:58 up 919 days, 16:33,  3 users,  load average: 3.19, 2.44, 2.19\n")])])]),v("table",[v("thead",[v("tr",[v("th",[t._v("字段")]),t._v(" "),v("th",[t._v("含义")])])]),t._v(" "),v("tbody",[v("tr",[v("td",[v("code",[t._v("07:02:58")])]),t._v(" "),v("td",[t._v("当前系统时间")])]),t._v(" "),v("tr",[v("td",[v("code",[t._v("up 919 days, 16:33")])]),t._v(" "),v("td",[t._v("系统已经运行了 919 天 16 小时")])]),t._v(" "),v("tr",[v("td",[v("code",[t._v("3 users")])]),t._v(" "),v("td",[t._v("当前有 3 个登录用户")])]),t._v(" "),v("tr",[v("td",[v("code",[t._v("load average: 3.19, 2.44, 2.19")])]),t._v(" "),v("td",[t._v("系统平均负载（过去 1、5、15 分钟）一般情况下，"),v("strong",[t._v("load > CPU 核心数")]),t._v(" 表示系统可能有压力")])])])]),t._v(" "),v("blockquote",[v("p",[v("strong",[t._v("建议：")]),t._v(" 如果你是 2 核或 4 核机器，"),v("code",[t._v("3.19")]),t._v(" 就说明负载略高。")])]),t._v(" "),v("hr"),t._v(" "),v("h2",{attrs:{id:"🔧-第二行-任务-进程-状态"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#🔧-第二行-任务-进程-状态"}},[t._v("#")]),t._v(" 🔧 第二行：任务（进程）状态")]),t._v(" "),v("div",{staticClass:"language- extra-class"},[v("pre",[v("code",[t._v("Tasks: 165 total,   1 running, 164 sleeping,   0 stopped,   0 zombie\n")])])]),v("table",[v("thead",[v("tr",[v("th",[t._v("状态")]),t._v(" "),v("th",[t._v("含义")])])]),t._v(" "),v("tbody",[v("tr",[v("td",[v("code",[t._v("165 total")])]),t._v(" "),v("td",[t._v("总共 165 个进程")])]),t._v(" "),v("tr",[v("td",[v("code",[t._v("1 running")])]),t._v(" "),v("td",[t._v("其中 1 个正在运行（即使用 CPU）")])]),t._v(" "),v("tr",[v("td",[v("code",[t._v("164 sleeping")])]),t._v(" "),v("td",[t._v("大部分在等待（sleep）状态")])]),t._v(" "),v("tr",[v("td",[v("code",[t._v("0 stopped")]),t._v(" / "),v("code",[t._v("0 zombie")])]),t._v(" "),v("td",[t._v("没有被暂停或僵尸进程（正常）")])])])]),t._v(" "),v("hr"),t._v(" "),v("h2",{attrs:{id:"🧠-第三行-cpu-使用情况-所有核心总体占比"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#🧠-第三行-cpu-使用情况-所有核心总体占比"}},[t._v("#")]),t._v(" 🧠 第三行：CPU 使用情况（所有核心总体占比）")]),t._v(" "),v("div",{staticClass:"language- extra-class"},[v("pre",[v("code",[t._v("%Cpu(s):  7.0 us,  3.5 sy,  0.0 ni, 87.7 id,  0.0 wa,  0.0 hi,  1.8 si,  0.0 st\n")])])]),v("table",[v("thead",[v("tr",[v("th",[t._v("字段")]),t._v(" "),v("th",[t._v("含义")])])]),t._v(" "),v("tbody",[v("tr",[v("td",[v("code",[t._v("us")]),t._v(" (7.0%)")]),t._v(" "),v("td",[t._v("用户空间占用（如 Java、Python）")])]),t._v(" "),v("tr",[v("td",[v("code",[t._v("sy")]),t._v(" (3.5%)")]),t._v(" "),v("td",[t._v("内核空间（系统调用）占用")])]),t._v(" "),v("tr",[v("td",[v("code",[t._v("id")]),t._v(" (87.7%)")]),t._v(" "),v("td",[t._v("空闲 CPU 时间")])]),t._v(" "),v("tr",[v("td",[v("code",[t._v("si")]),t._v(" (1.8%)")]),t._v(" "),v("td",[t._v("软件中断，例如网络、I/O 中断")])]),t._v(" "),v("tr",[v("td",[v("code",[t._v("wa")]),t._v(" (0.0%)")]),t._v(" "),v("td",[t._v("等待 IO（如果高表示磁盘慢）")])])])]),t._v(" "),v("blockquote",[v("p",[t._v("当前 CPU 总体压力不高（87.7% 空闲），但某进程占用高。")])]),t._v(" "),v("hr"),t._v(" "),v("h2",{attrs:{id:"🧬-第四行-内存使用情况-单位-kib-即-1024-字节"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#🧬-第四行-内存使用情况-单位-kib-即-1024-字节"}},[t._v("#")]),t._v(" 🧬 第四行：内存使用情况（单位 KiB，即 1024 字节）")]),t._v(" "),v("div",{staticClass:"language- extra-class"},[v("pre",[v("code",[t._v("KiB Mem : 15990492 total,  1075056 free,  7387956 used,  7527480 buff/cache\n")])])]),v("table",[v("thead",[v("tr",[v("th",[t._v("字段")]),t._v(" "),v("th",[t._v("含义")])])]),t._v(" "),v("tbody",[v("tr",[v("td",[v("code",[t._v("total")])]),t._v(" "),v("td",[t._v("总内存 15.9 GB")])]),t._v(" "),v("tr",[v("td",[v("code",[t._v("free")])]),t._v(" "),v("td",[t._v("剩余 1 GB 可用（较少）")])]),t._v(" "),v("tr",[v("td",[v("code",[t._v("used")])]),t._v(" "),v("td",[t._v("已使用 7.3 GB")])]),t._v(" "),v("tr",[v("td",[v("code",[t._v("buff/cache")])]),t._v(" "),v("td",[t._v("Linux 缓存 7.5 GB（可被回收）")])])])]),t._v(" "),v("blockquote",[v("p",[t._v("实际可用内存："),v("code",[t._v("free + buff/cache ≈ 8.6G")]),t._v("，暂时没有内存压力。")])]),t._v(" "),v("hr"),t._v(" "),v("h2",{attrs:{id:"💾-第五行-交换分区-swap"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#💾-第五行-交换分区-swap"}},[t._v("#")]),t._v(" 💾 第五行：交换分区（Swap）")]),t._v(" "),v("div",{staticClass:"language- extra-class"},[v("pre",[v("code",[t._v("KiB Swap:        0 total,        0 free,        0 used.  8258336 avail Mem\n")])])]),v("ul",[v("li",[t._v("当前系统 "),v("strong",[t._v("没有开启 swap 分区")]),t._v("，说明依赖物理内存。")]),t._v(" "),v("li",[v("code",[t._v("avail Mem")]),t._v(": 8.25 GB，是内核预估可用内存。")])]),t._v(" "),v("hr"),t._v(" "),v("h2",{attrs:{id:"🔍-最下方-进程列表-按-cpu-排序"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#🔍-最下方-进程列表-按-cpu-排序"}},[t._v("#")]),t._v(" 🔍 最下方：进程列表（按 CPU 排序）")]),t._v(" "),v("div",{staticClass:"language- extra-class"},[v("pre",[v("code",[t._v("PID    USER      %CPU %MEM COMMAND\n31037  cassand+  62.5  5.9  java\n")])])]),v("table",[v("thead",[v("tr",[v("th",[t._v("字段")]),t._v(" "),v("th",[t._v("含义")])])]),t._v(" "),v("tbody",[v("tr",[v("td",[v("code",[t._v("PID")])]),t._v(" "),v("td",[t._v("进程号")])]),t._v(" "),v("tr",[v("td",[v("code",[t._v("USER")])]),t._v(" "),v("td",[t._v("所属用户 cassandra")])]),t._v(" "),v("tr",[v("td",[v("code",[t._v("%CPU")])]),t._v(" "),v("td",[t._v("占用 CPU 62.5%（非常高）")])]),t._v(" "),v("tr",[v("td",[v("code",[t._v("%MEM")])]),t._v(" "),v("td",[t._v("占用内存 5.9%（约 950MB）")])]),t._v(" "),v("tr",[v("td",[v("code",[t._v("COMMAND")])]),t._v(" "),v("td",[t._v("执行程序为 "),v("code",[t._v("java")]),t._v("（Cassandra）")])])])]),t._v(" "),v("hr"),t._v(" "),v("h2",{attrs:{id:"🚨-结论与建议"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#🚨-结论与建议"}},[t._v("#")]),t._v(" 🚨 结论与建议：")]),t._v(" "),v("ul",[v("li",[v("p",[v("strong",[t._v("当前 Cassandra Java 进程 CPU 占用过高（62.5%）")]),t._v(" ，是主要负载来源。")])]),t._v(" "),v("li",[v("p",[t._v("可能存在：")]),t._v(" "),v("ul",[v("li",[t._v("查询过多或热点写入")]),t._v(" "),v("li",[t._v("GC 频繁（需看 "),v("code",[t._v("jstat")]),t._v("）")]),t._v(" "),v("li",[t._v("长时间运行未重启，内部累积数据")])])])])])}),[],!1,null,null,null);v.default=s.exports}}]);