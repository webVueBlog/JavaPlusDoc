(window.webpackJsonp=window.webpackJsonp||[]).push([[312],{1130:function(t,a,s){"use strict";s.r(a);var r=s(1),n=Object(r.a)({},(function(){var t=this,a=t._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"jvm深入解析"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#jvm深入解析"}},[t._v("#")]),t._v(" JVM深入解析")]),t._v(" "),a("h2",{attrs:{id:"jvm架构详解"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#jvm架构详解"}},[t._v("#")]),t._v(" JVM架构详解")]),t._v(" "),a("h3",{attrs:{id:"jvm整体架构"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#jvm整体架构"}},[t._v("#")]),t._v(" JVM整体架构")]),t._v(" "),a("div",{staticClass:"language-mermaid extra-class"},[a("pre",{pre:!0,attrs:{class:"language-mermaid"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("graph")]),t._v(" TB\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("subgraph")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"JVM架构"')]),t._v("\n        A"),a("span",{pre:!0,attrs:{class:"token text string"}},[t._v("[类加载器 ClassLoader]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token arrow operator"}},[t._v("--\x3e")]),t._v(" B"),a("span",{pre:!0,attrs:{class:"token text string"}},[t._v("[运行时数据区 Runtime Data Area]")]),t._v("\n        B "),a("span",{pre:!0,attrs:{class:"token arrow operator"}},[t._v("--\x3e")]),t._v(" C"),a("span",{pre:!0,attrs:{class:"token text string"}},[t._v("[执行引擎 Execution Engine]")]),t._v("\n        C "),a("span",{pre:!0,attrs:{class:"token arrow operator"}},[t._v("--\x3e")]),t._v(" D"),a("span",{pre:!0,attrs:{class:"token text string"}},[t._v("[本地方法接口 Native Interface]")]),t._v("\n        D "),a("span",{pre:!0,attrs:{class:"token arrow operator"}},[t._v("--\x3e")]),t._v(" E"),a("span",{pre:!0,attrs:{class:"token text string"}},[t._v("[本地方法库 Native Libraries]")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v("\n    \n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("subgraph")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"运行时数据区"')]),t._v("\n        B1"),a("span",{pre:!0,attrs:{class:"token text string"}},[t._v("[方法区 Method Area]")]),t._v("\n        B2"),a("span",{pre:!0,attrs:{class:"token text string"}},[t._v("[堆内存 Heap]")]),t._v("\n        B3"),a("span",{pre:!0,attrs:{class:"token text string"}},[t._v("[栈内存 Stack]")]),t._v("\n        B4"),a("span",{pre:!0,attrs:{class:"token text string"}},[t._v("[程序计数器 PC Register]")]),t._v("\n        B5"),a("span",{pre:!0,attrs:{class:"token text string"}},[t._v("[本地方法栈 Native Method Stack]")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v("\n    \n    B "),a("span",{pre:!0,attrs:{class:"token arrow operator"}},[t._v("--\x3e")]),t._v(" B1\n    B "),a("span",{pre:!0,attrs:{class:"token arrow operator"}},[t._v("--\x3e")]),t._v(" B2\n    B "),a("span",{pre:!0,attrs:{class:"token arrow operator"}},[t._v("--\x3e")]),t._v(" B3\n    B "),a("span",{pre:!0,attrs:{class:"token arrow operator"}},[t._v("--\x3e")]),t._v(" B4\n    B "),a("span",{pre:!0,attrs:{class:"token arrow operator"}},[t._v("--\x3e")]),t._v(" B5\n")])])]),a("h2",{attrs:{id:"类加载机制"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#类加载机制"}},[t._v("#")]),t._v(" 类加载机制")]),t._v(" "),a("h3",{attrs:{id:"类加载过程"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#类加载过程"}},[t._v("#")]),t._v(" 类加载过程")]),t._v(" "),a("div",{staticClass:"language-mermaid extra-class"},[a("pre",{pre:!0,attrs:{class:"language-mermaid"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("graph")]),t._v(" LR\n    A"),a("span",{pre:!0,attrs:{class:"token text string"}},[t._v("[加载 Loading]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token arrow operator"}},[t._v("--\x3e")]),t._v(" B"),a("span",{pre:!0,attrs:{class:"token text string"}},[t._v("[验证 Verification]")]),t._v("\n    B "),a("span",{pre:!0,attrs:{class:"token arrow operator"}},[t._v("--\x3e")]),t._v(" C"),a("span",{pre:!0,attrs:{class:"token text string"}},[t._v("[准备 Preparation]")]),t._v("\n    C "),a("span",{pre:!0,attrs:{class:"token arrow operator"}},[t._v("--\x3e")]),t._v(" D"),a("span",{pre:!0,attrs:{class:"token text string"}},[t._v("[解析 Resolution]")]),t._v("\n    D "),a("span",{pre:!0,attrs:{class:"token arrow operator"}},[t._v("--\x3e")]),t._v(" E"),a("span",{pre:!0,attrs:{class:"token text string"}},[t._v("[初始化 Initialization]")]),t._v("\n    \n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("subgraph")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"链接 Linking"')]),t._v("\n        B\n        C\n        D\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v("\n")])])]),a("h3",{attrs:{id:"类加载器层次结构"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#类加载器层次结构"}},[t._v("#")]),t._v(" 类加载器层次结构")]),t._v(" "),a("div",{staticClass:"language-mermaid extra-class"},[a("pre",{pre:!0,attrs:{class:"language-mermaid"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("graph")]),t._v(" TD\n    A"),a("span",{pre:!0,attrs:{class:"token text string"}},[t._v("[启动类加载器 Bootstrap ClassLoader]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token arrow operator"}},[t._v("--\x3e")]),t._v(" B"),a("span",{pre:!0,attrs:{class:"token text string"}},[t._v("[扩展类加载器 Extension ClassLoader]")]),t._v("\n    B "),a("span",{pre:!0,attrs:{class:"token arrow operator"}},[t._v("--\x3e")]),t._v(" C"),a("span",{pre:!0,attrs:{class:"token text string"}},[t._v("[应用程序类加载器 Application ClassLoader]")]),t._v("\n    C "),a("span",{pre:!0,attrs:{class:"token arrow operator"}},[t._v("--\x3e")]),t._v(" D"),a("span",{pre:!0,attrs:{class:"token text string"}},[t._v("[自定义类加载器 Custom ClassLoader]")]),t._v("\n    \n    A1"),a("span",{pre:!0,attrs:{class:"token text string"}},[t._v('["加载核心类库<br/>rt.jar等"]')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token arrow operator"}},[t._v("--\x3e")]),t._v(" A\n    B1"),a("span",{pre:!0,attrs:{class:"token text string"}},[t._v('["加载扩展类库<br/>ext目录下的jar"]')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token arrow operator"}},[t._v("--\x3e")]),t._v(" B\n    C1"),a("span",{pre:!0,attrs:{class:"token text string"}},[t._v('["加载应用程序类<br/>classpath下的类"]')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token arrow operator"}},[t._v("--\x3e")]),t._v(" C\n    D1"),a("span",{pre:!0,attrs:{class:"token text string"}},[t._v('["用户自定义加载逻辑"]')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token arrow operator"}},[t._v("--\x3e")]),t._v(" D\n")])])]),a("h3",{attrs:{id:"双亲委派模型"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#双亲委派模型"}},[t._v("#")]),t._v(" 双亲委派模型")]),t._v(" "),a("div",{staticClass:"language-java extra-class"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 双亲委派模型示例")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("protected")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Class")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("loadClass")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("boolean")]),t._v(" resolve"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 首先检查类是否已经被加载")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Class")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" c "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("findLoadedClass")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("c "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("try")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 委派给父类加载器")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("parent "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                c "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" parent"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("loadClass")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                c "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("findBootstrapClassOrNull")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("catch")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ClassNotFoundException")]),t._v(" e"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 父类加载器无法加载时，自己尝试加载")]),t._v("\n            c "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("findClass")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" c"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("h2",{attrs:{id:"内存区域详解"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#内存区域详解"}},[t._v("#")]),t._v(" 内存区域详解")]),t._v(" "),a("h3",{attrs:{id:"堆内存结构"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#堆内存结构"}},[t._v("#")]),t._v(" 堆内存结构")]),t._v(" "),a("div",{staticClass:"language-mermaid extra-class"},[a("pre",{pre:!0,attrs:{class:"language-mermaid"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("graph")]),t._v(" TB\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("subgraph")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"堆内存 Heap"')]),t._v("\n        A"),a("span",{pre:!0,attrs:{class:"token text string"}},[t._v("[新生代 Young Generation]")]),t._v("\n        B"),a("span",{pre:!0,attrs:{class:"token text string"}},[t._v("[老年代 Old Generation]")]),t._v("\n        C"),a("span",{pre:!0,attrs:{class:"token text string"}},[t._v("[永久代/元空间 Permanent/Metaspace]")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v("\n    \n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("subgraph")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"新生代结构"')]),t._v("\n        A1"),a("span",{pre:!0,attrs:{class:"token text string"}},[t._v("[Eden区]")]),t._v("\n        A2"),a("span",{pre:!0,attrs:{class:"token text string"}},[t._v("[Survivor 0]")]),t._v("\n        A3"),a("span",{pre:!0,attrs:{class:"token text string"}},[t._v("[Survivor 1]")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v("\n    \n    A "),a("span",{pre:!0,attrs:{class:"token arrow operator"}},[t._v("--\x3e")]),t._v(" A1\n    A "),a("span",{pre:!0,attrs:{class:"token arrow operator"}},[t._v("--\x3e")]),t._v(" A2\n    A "),a("span",{pre:!0,attrs:{class:"token arrow operator"}},[t._v("--\x3e")]),t._v(" A3\n    \n    D"),a("span",{pre:!0,attrs:{class:"token text string"}},[t._v('["对象分配流程"]')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token arrow operator"}},[t._v("--\x3e")]),t._v(" A1\n    A1 "),a("span",{pre:!0,attrs:{class:"token arrow operator"}},[t._v("--\x3e")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token label property"}},[t._v('|"Minor GC"|')]),t._v(" A2\n    A2 "),a("span",{pre:!0,attrs:{class:"token arrow operator"}},[t._v("--\x3e")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token label property"}},[t._v('|"Minor GC"|')]),t._v(" A3\n    A3 "),a("span",{pre:!0,attrs:{class:"token arrow operator"}},[t._v("--\x3e")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token label property"}},[t._v('|"对象年龄达到阈值"|')]),t._v(" B\n")])])]),a("h3",{attrs:{id:"内存分配策略"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#内存分配策略"}},[t._v("#")]),t._v(" 内存分配策略")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("策略")]),t._v(" "),a("th",[t._v("描述")]),t._v(" "),a("th",[t._v("适用场景")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("对象优先在Eden分配")]),t._v(" "),a("td",[t._v("新对象首先在Eden区分配")]),t._v(" "),a("td",[t._v("大部分对象")])]),t._v(" "),a("tr",[a("td",[t._v("大对象直接进入老年代")]),t._v(" "),a("td",[t._v("超过阈值的大对象")]),t._v(" "),a("td",[t._v("大数组、大字符串")])]),t._v(" "),a("tr",[a("td",[t._v("长期存活对象进入老年代")]),t._v(" "),a("td",[t._v("经过多次GC仍存活")]),t._v(" "),a("td",[t._v("缓存对象")])]),t._v(" "),a("tr",[a("td",[t._v("动态年龄判定")]),t._v(" "),a("td",[t._v("Survivor区相同年龄对象超过一半")]),t._v(" "),a("td",[t._v("自适应调整")])])])]),t._v(" "),a("h3",{attrs:{id:"栈内存结构"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#栈内存结构"}},[t._v("#")]),t._v(" 栈内存结构")]),t._v(" "),a("div",{staticClass:"language-mermaid extra-class"},[a("pre",{pre:!0,attrs:{class:"language-mermaid"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("graph")]),t._v(" TD\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("subgraph")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Java虚拟机栈"')]),t._v("\n        A"),a("span",{pre:!0,attrs:{class:"token text string"}},[t._v("[栈帧1 - 当前方法]")]),t._v("\n        B"),a("span",{pre:!0,attrs:{class:"token text string"}},[t._v("[栈帧2]")]),t._v("\n        C"),a("span",{pre:!0,attrs:{class:"token text string"}},[t._v("[栈帧3]")]),t._v("\n        D"),a("span",{pre:!0,attrs:{class:"token text string"}},[t._v("[栈帧N]")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v("\n    \n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("subgraph")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"栈帧结构"')]),t._v("\n        A1"),a("span",{pre:!0,attrs:{class:"token text string"}},[t._v("[局部变量表]")]),t._v("\n        A2"),a("span",{pre:!0,attrs:{class:"token text string"}},[t._v("[操作数栈]")]),t._v("\n        A3"),a("span",{pre:!0,attrs:{class:"token text string"}},[t._v("[动态链接]")]),t._v("\n        A4"),a("span",{pre:!0,attrs:{class:"token text string"}},[t._v("[方法返回地址]")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v("\n    \n    A "),a("span",{pre:!0,attrs:{class:"token arrow operator"}},[t._v("--\x3e")]),t._v(" A1\n    A "),a("span",{pre:!0,attrs:{class:"token arrow operator"}},[t._v("--\x3e")]),t._v(" A2\n    A "),a("span",{pre:!0,attrs:{class:"token arrow operator"}},[t._v("--\x3e")]),t._v(" A3\n    A "),a("span",{pre:!0,attrs:{class:"token arrow operator"}},[t._v("--\x3e")]),t._v(" A4\n")])])]),a("h2",{attrs:{id:"垃圾回收机制"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#垃圾回收机制"}},[t._v("#")]),t._v(" 垃圾回收机制")]),t._v(" "),a("h3",{attrs:{id:"垃圾回收算法"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#垃圾回收算法"}},[t._v("#")]),t._v(" 垃圾回收算法")]),t._v(" "),a("h4",{attrs:{id:"_1-标记-清除算法"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-标记-清除算法"}},[t._v("#")]),t._v(" 1. 标记-清除算法")]),t._v(" "),a("div",{staticClass:"language-mermaid extra-class"},[a("pre",{pre:!0,attrs:{class:"language-mermaid"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("graph")]),t._v(" LR\n    A"),a("span",{pre:!0,attrs:{class:"token text string"}},[t._v('["标记阶段<br/>标记需要回收的对象"]')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token arrow operator"}},[t._v("--\x3e")]),t._v(" B"),a("span",{pre:!0,attrs:{class:"token text string"}},[t._v('["清除阶段<br/>回收标记的对象"]')]),t._v("\n    \n    C"),a("span",{pre:!0,attrs:{class:"token text string"}},[t._v('["优点：简单直接"]')]),t._v(" \n    D"),a("span",{pre:!0,attrs:{class:"token text string"}},[t._v('["缺点：产生内存碎片"]')]),t._v("\n")])])]),a("h4",{attrs:{id:"_2-复制算法"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-复制算法"}},[t._v("#")]),t._v(" 2. 复制算法")]),t._v(" "),a("div",{staticClass:"language-mermaid extra-class"},[a("pre",{pre:!0,attrs:{class:"language-mermaid"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("graph")]),t._v(" TB\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("subgraph")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"复制前"')]),t._v("\n        A1"),a("span",{pre:!0,attrs:{class:"token text string"}},[t._v('["From区<br/>存活对象 + 垃圾对象"]')]),t._v("\n        A2"),a("span",{pre:!0,attrs:{class:"token text string"}},[t._v('["To区<br/>空闲"]')]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v("\n    \n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("subgraph")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"复制后"')]),t._v("\n        B1"),a("span",{pre:!0,attrs:{class:"token text string"}},[t._v('["From区<br/>空闲"]')]),t._v("\n        B2"),a("span",{pre:!0,attrs:{class:"token text string"}},[t._v('["To区<br/>存活对象"]')]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v("\n    \n    A1 "),a("span",{pre:!0,attrs:{class:"token arrow operator"}},[t._v("--\x3e")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token label property"}},[t._v('|"复制存活对象"|')]),t._v(" B2\n")])])]),a("h4",{attrs:{id:"_3-标记-整理算法"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-标记-整理算法"}},[t._v("#")]),t._v(" 3. 标记-整理算法")]),t._v(" "),a("div",{staticClass:"language-mermaid extra-class"},[a("pre",{pre:!0,attrs:{class:"language-mermaid"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("graph")]),t._v(" LR\n    A"),a("span",{pre:!0,attrs:{class:"token text string"}},[t._v('["标记阶段<br/>标记存活对象"]')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token arrow operator"}},[t._v("--\x3e")]),t._v(" B"),a("span",{pre:!0,attrs:{class:"token text string"}},[t._v('["整理阶段<br/>移动存活对象"]')]),t._v("\n    B "),a("span",{pre:!0,attrs:{class:"token arrow operator"}},[t._v("--\x3e")]),t._v(" C"),a("span",{pre:!0,attrs:{class:"token text string"}},[t._v('["清除阶段<br/>清理剩余空间"]')]),t._v("\n")])])]),a("h3",{attrs:{id:"垃圾收集器对比"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#垃圾收集器对比"}},[t._v("#")]),t._v(" 垃圾收集器对比")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("收集器")]),t._v(" "),a("th",[t._v("类型")]),t._v(" "),a("th",[t._v("适用场景")]),t._v(" "),a("th",[t._v("特点")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("Serial")]),t._v(" "),a("td",[t._v("单线程")]),t._v(" "),a("td",[t._v("客户端应用")]),t._v(" "),a("td",[t._v("简单高效")])]),t._v(" "),a("tr",[a("td",[t._v("Parallel")]),t._v(" "),a("td",[t._v("多线程")]),t._v(" "),a("td",[t._v("服务器应用")]),t._v(" "),a("td",[t._v("吞吐量优先")])]),t._v(" "),a("tr",[a("td",[t._v("CMS")]),t._v(" "),a("td",[t._v("并发")]),t._v(" "),a("td",[t._v("响应时间敏感")]),t._v(" "),a("td",[t._v("低延迟")])]),t._v(" "),a("tr",[a("td",[t._v("G1")]),t._v(" "),a("td",[t._v("并发")]),t._v(" "),a("td",[t._v("大堆内存")]),t._v(" "),a("td",[t._v("可预测停顿")])]),t._v(" "),a("tr",[a("td",[t._v("ZGC")]),t._v(" "),a("td",[t._v("并发")]),t._v(" "),a("td",[t._v("超大堆内存")]),t._v(" "),a("td",[t._v("超低延迟")])])])]),t._v(" "),a("h3",{attrs:{id:"gc调优参数"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#gc调优参数"}},[t._v("#")]),t._v(" GC调优参数")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 堆内存设置")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-Xms2g")]),t._v("          "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 初始堆大小")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-Xmx4g")]),t._v("          "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 最大堆大小")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-Xmn1g")]),t._v("          "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 新生代大小")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 垃圾收集器选择")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-XX:+UseG1GC")]),t._v("    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 使用G1收集器")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-XX:+UseConcMarkSweepGC")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 使用CMS收集器")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# GC日志")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-XX:+PrintGC")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-XX:+PrintGCDetails")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-XX:+PrintGCTimeStamps")]),t._v("\n")])])]),a("h2",{attrs:{id:"jvm性能监控"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#jvm性能监控"}},[t._v("#")]),t._v(" JVM性能监控")]),t._v(" "),a("h3",{attrs:{id:"监控工具"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#监控工具"}},[t._v("#")]),t._v(" 监控工具")]),t._v(" "),a("h4",{attrs:{id:"_1-命令行工具"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-命令行工具"}},[t._v("#")]),t._v(" 1. 命令行工具")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# jps - 查看Java进程")]),t._v("\njps "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-l")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# jstat - 查看GC统计信息")]),t._v("\njstat "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-gc")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("pid"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1000")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# jmap - 查看内存使用情况")]),t._v("\njmap "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-heap")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("pid"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# jstack - 查看线程堆栈")]),t._v("\njstack "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("pid"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n")])])]),a("h4",{attrs:{id:"_2-可视化工具"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-可视化工具"}},[t._v("#")]),t._v(" 2. 可视化工具")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("工具")]),t._v(" "),a("th",[t._v("功能")]),t._v(" "),a("th",[t._v("特点")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("JConsole")]),t._v(" "),a("td",[t._v("基础监控")]),t._v(" "),a("td",[t._v("JDK自带")])]),t._v(" "),a("tr",[a("td",[t._v("VisualVM")]),t._v(" "),a("td",[t._v("全面分析")]),t._v(" "),a("td",[t._v("功能丰富")])]),t._v(" "),a("tr",[a("td",[t._v("JProfiler")]),t._v(" "),a("td",[t._v("专业分析")]),t._v(" "),a("td",[t._v("商业工具")])]),t._v(" "),a("tr",[a("td",[t._v("Arthas")]),t._v(" "),a("td",[t._v("在线诊断")]),t._v(" "),a("td",[t._v("阿里开源")])])])]),t._v(" "),a("h3",{attrs:{id:"性能分析指标"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#性能分析指标"}},[t._v("#")]),t._v(" 性能分析指标")]),t._v(" "),a("div",{staticClass:"language-mermaid extra-class"},[a("pre",{pre:!0,attrs:{class:"language-mermaid"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("graph")]),t._v(" TD\n    A"),a("span",{pre:!0,attrs:{class:"token text string"}},[t._v("[JVM性能指标]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token arrow operator"}},[t._v("--\x3e")]),t._v(" B"),a("span",{pre:!0,attrs:{class:"token text string"}},[t._v("[内存使用率]")]),t._v("\n    A "),a("span",{pre:!0,attrs:{class:"token arrow operator"}},[t._v("--\x3e")]),t._v(" C"),a("span",{pre:!0,attrs:{class:"token text string"}},[t._v("[GC频率和时间]")]),t._v("\n    A "),a("span",{pre:!0,attrs:{class:"token arrow operator"}},[t._v("--\x3e")]),t._v(" D"),a("span",{pre:!0,attrs:{class:"token text string"}},[t._v("[线程状态]")]),t._v("\n    A "),a("span",{pre:!0,attrs:{class:"token arrow operator"}},[t._v("--\x3e")]),t._v(" E"),a("span",{pre:!0,attrs:{class:"token text string"}},[t._v("[CPU使用率]")]),t._v("\n    \n    B "),a("span",{pre:!0,attrs:{class:"token arrow operator"}},[t._v("--\x3e")]),t._v(" B1"),a("span",{pre:!0,attrs:{class:"token text string"}},[t._v("[堆内存使用]")]),t._v("\n    B "),a("span",{pre:!0,attrs:{class:"token arrow operator"}},[t._v("--\x3e")]),t._v(" B2"),a("span",{pre:!0,attrs:{class:"token text string"}},[t._v("[非堆内存使用]")]),t._v("\n    \n    C "),a("span",{pre:!0,attrs:{class:"token arrow operator"}},[t._v("--\x3e")]),t._v(" C1"),a("span",{pre:!0,attrs:{class:"token text string"}},[t._v("[Minor GC]")]),t._v("\n    C "),a("span",{pre:!0,attrs:{class:"token arrow operator"}},[t._v("--\x3e")]),t._v(" C2"),a("span",{pre:!0,attrs:{class:"token text string"}},[t._v("[Major GC]")]),t._v("\n    C "),a("span",{pre:!0,attrs:{class:"token arrow operator"}},[t._v("--\x3e")]),t._v(" C3"),a("span",{pre:!0,attrs:{class:"token text string"}},[t._v("[Full GC]")]),t._v("\n    \n    D "),a("span",{pre:!0,attrs:{class:"token arrow operator"}},[t._v("--\x3e")]),t._v(" D1"),a("span",{pre:!0,attrs:{class:"token text string"}},[t._v("[运行线程数]")]),t._v("\n    D "),a("span",{pre:!0,attrs:{class:"token arrow operator"}},[t._v("--\x3e")]),t._v(" D2"),a("span",{pre:!0,attrs:{class:"token text string"}},[t._v("[阻塞线程数]")]),t._v("\n    D "),a("span",{pre:!0,attrs:{class:"token arrow operator"}},[t._v("--\x3e")]),t._v(" D3"),a("span",{pre:!0,attrs:{class:"token text string"}},[t._v("[死锁检测]")]),t._v("\n")])])]),a("h2",{attrs:{id:"jvm调优实践"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#jvm调优实践"}},[t._v("#")]),t._v(" JVM调优实践")]),t._v(" "),a("h3",{attrs:{id:"调优流程"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#调优流程"}},[t._v("#")]),t._v(" 调优流程")]),t._v(" "),a("div",{staticClass:"language-mermaid extra-class"},[a("pre",{pre:!0,attrs:{class:"language-mermaid"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("graph")]),t._v(" TD\n    A"),a("span",{pre:!0,attrs:{class:"token text string"}},[t._v("[性能基线测试]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token arrow operator"}},[t._v("--\x3e")]),t._v(" B"),a("span",{pre:!0,attrs:{class:"token text string"}},[t._v("[问题识别]")]),t._v("\n    B "),a("span",{pre:!0,attrs:{class:"token arrow operator"}},[t._v("--\x3e")]),t._v(" C"),a("span",{pre:!0,attrs:{class:"token text string"}},[t._v("[参数调整]")]),t._v("\n    C "),a("span",{pre:!0,attrs:{class:"token arrow operator"}},[t._v("--\x3e")]),t._v(" D"),a("span",{pre:!0,attrs:{class:"token text string"}},[t._v("[效果验证]")]),t._v("\n    D "),a("span",{pre:!0,attrs:{class:"token arrow operator"}},[t._v("--\x3e")]),t._v(" E"),a("span",{pre:!0,attrs:{class:"token text string"}},[t._v("{是否达到目标}")]),t._v("\n    E "),a("span",{pre:!0,attrs:{class:"token arrow operator"}},[t._v("--\x3e")]),a("span",{pre:!0,attrs:{class:"token label property"}},[t._v("|否|")]),t._v(" B\n    E "),a("span",{pre:!0,attrs:{class:"token arrow operator"}},[t._v("--\x3e")]),a("span",{pre:!0,attrs:{class:"token label property"}},[t._v("|是|")]),t._v(" F"),a("span",{pre:!0,attrs:{class:"token text string"}},[t._v("[部署上线]")]),t._v("\n")])])]),a("h3",{attrs:{id:"常见调优场景"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#常见调优场景"}},[t._v("#")]),t._v(" 常见调优场景")]),t._v(" "),a("h4",{attrs:{id:"_1-内存溢出优化"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-内存溢出优化"}},[t._v("#")]),t._v(" 1. 内存溢出优化")]),t._v(" "),a("div",{staticClass:"language-java extra-class"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// OutOfMemoryError: Java heap space")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 解决方案：")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 1. 增加堆内存 -Xmx4g")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 2. 优化代码，减少内存使用")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 3. 分析内存泄漏")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 示例：内存泄漏检测")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("MemoryLeakExample")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("static")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("List")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Object")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" list "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ArrayList")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    \n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("addObject")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 潜在内存泄漏：对象一直被引用")]),t._v("\n        list"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("add")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Object")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("h4",{attrs:{id:"_2-gc停顿时间优化"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-gc停顿时间优化"}},[t._v("#")]),t._v(" 2. GC停顿时间优化")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 使用G1收集器减少停顿时间")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-XX:+UseG1GC")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-XX:MaxGCPauseMillis")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("200")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-XX:G1HeapRegionSize")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("16m\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 并行GC线程数调整")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-XX:ParallelGCThreads")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("8")]),t._v("\n")])])]),a("h4",{attrs:{id:"_3-吞吐量优化"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-吞吐量优化"}},[t._v("#")]),t._v(" 3. 吞吐量优化")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 使用Parallel收集器提高吞吐量")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-XX:+UseParallelGC")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-XX:+UseParallelOldGC")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-XX:ParallelGCThreads")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("8")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 调整新生代比例")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-XX:NewRatio")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-XX:SurvivorRatio")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("8")]),t._v("\n")])])]),a("h3",{attrs:{id:"调优最佳实践"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#调优最佳实践"}},[t._v("#")]),t._v(" 调优最佳实践")]),t._v(" "),a("ol",[a("li",[a("strong",[t._v("监控先行")]),t._v("：建立完善的监控体系")]),t._v(" "),a("li",[a("strong",[t._v("渐进调优")]),t._v("：逐步调整，避免大幅改动")]),t._v(" "),a("li",[a("strong",[t._v("压力测试")]),t._v("：在测试环境验证效果")]),t._v(" "),a("li",[a("strong",[t._v("文档记录")]),t._v("：记录调优过程和结果")])]),t._v(" "),a("h2",{attrs:{id:"jvm故障排查"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#jvm故障排查"}},[t._v("#")]),t._v(" JVM故障排查")]),t._v(" "),a("h3",{attrs:{id:"常见问题诊断"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#常见问题诊断"}},[t._v("#")]),t._v(" 常见问题诊断")]),t._v(" "),a("h4",{attrs:{id:"_1-内存问题"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-内存问题"}},[t._v("#")]),t._v(" 1. 内存问题")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 生成堆转储文件")]),t._v("\njmap "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-dump:format")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("b,file"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("heap.hprof "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("pid"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 分析堆转储文件")]),t._v("\njhat heap.hprof\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 或使用Eclipse MAT工具")]),t._v("\n")])])]),a("h4",{attrs:{id:"_2-cpu问题"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-cpu问题"}},[t._v("#")]),t._v(" 2. CPU问题")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 查看线程CPU使用情况")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("top")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-H")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-p")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("pid"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 获取线程堆栈")]),t._v("\njstack "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("pid"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" thread.dump\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 分析热点方法")]),t._v("\njprofiler或其他性能分析工具\n")])])]),a("h4",{attrs:{id:"_3-死锁问题"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-死锁问题"}},[t._v("#")]),t._v(" 3. 死锁问题")]),t._v(" "),a("div",{staticClass:"language-java extra-class"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 死锁示例")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("DeadlockExample")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("static")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Object")]),t._v(" lock1 "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Object")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("static")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Object")]),t._v(" lock2 "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Object")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    \n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("static")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("main")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" args"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Thread")]),t._v(" t1 "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Thread")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("synchronized")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("lock1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("synchronized")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("lock2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                    "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("System")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("out"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("println")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Thread 1"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        \n        "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Thread")]),t._v(" t2 "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Thread")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("synchronized")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("lock2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("synchronized")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("lock1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                    "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("System")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("out"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("println")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Thread 2"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        \n        t1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("start")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        t2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("start")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 检测死锁")]),t._v("\njstack "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("pid"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("grep")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-A")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Found Java-level deadlock"')]),t._v("\n")])])]),a("h2",{attrs:{id:"总结"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#总结"}},[t._v("#")]),t._v(" 总结")]),t._v(" "),a("p",[t._v("JVM是Java生态系统的核心，深入理解JVM的工作原理对于Java开发者来说至关重要。通过掌握：")]),t._v(" "),a("ul",[a("li",[a("strong",[t._v("内存管理机制")]),t._v("：了解内存分配和回收策略")]),t._v(" "),a("li",[a("strong",[t._v("垃圾回收原理")]),t._v("：选择合适的GC算法和收集器")]),t._v(" "),a("li",[a("strong",[t._v("性能监控方法")]),t._v("：使用工具进行性能分析")]),t._v(" "),a("li",[a("strong",[t._v("调优实践经验")]),t._v("：根据应用特点进行针对性优化")])]),t._v(" "),a("p",[t._v("可以有效提升Java应用的性能和稳定性。")])])}),[],!1,null,null,null);a.default=n.exports}}]);