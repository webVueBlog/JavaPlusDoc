---
title: ç¬¬8å¤©-æ¨¡å—
author: å“ªå’
date: '2023-06-15'
---

# ç¬¬8å¤©-Pythonæ¨¡å—ä¸åŒ…

æ¬¢è¿æ¥åˆ°Pythonæ¨¡å—çš„ä¸–ç•Œï¼æ¨¡å—æ˜¯Pythonä»£ç ç»„ç»‡å’Œé‡ç”¨çš„åŸºç¡€ï¼ŒæŒæ¡æ¨¡å—ç³»ç»Ÿå°†è®©ä½ çš„ä»£ç æ›´åŠ æ¨¡å—åŒ–ã€å¯ç»´æŠ¤å’Œå¯æ‰©å±•ã€‚

## ä»€ä¹ˆæ˜¯æ¨¡å—ï¼Ÿ

æ¨¡å—ï¼ˆModuleï¼‰æ˜¯åŒ…å«Pythonä»£ç çš„æ–‡ä»¶ï¼Œé€šå¸¸ä»¥`.py`ä¸ºæ‰©å±•åã€‚æ¨¡å—å¯ä»¥åŒ…å«å‡½æ•°ã€ç±»ã€å˜é‡ä»¥åŠå¯æ‰§è¡Œçš„ä»£ç ã€‚

> **ç”Ÿæ´»ç±»æ¯”**ï¼š
> - **æ¨¡å—**ï¼šåƒå·¥å…·ç®±ä¸­çš„ä¸åŒå·¥å…·ï¼Œæ¯ä¸ªå·¥å…·æœ‰ç‰¹å®šçš„åŠŸèƒ½
> - **åŒ…**ï¼šåƒå·¥å…·ç®±æœ¬èº«ï¼Œå°†ç›¸å…³çš„å·¥å…·ç»„ç»‡åœ¨ä¸€èµ·
> - **å¯¼å…¥**ï¼šåƒä»å·¥å…·ç®±ä¸­å–å‡ºéœ€è¦çš„å·¥å…·æ¥ä½¿ç”¨

### æ¨¡å—çš„ä¼˜åŠ¿

1. **ä»£ç é‡ç”¨**ï¼šé¿å…é‡å¤ç¼–å†™ç›¸åŒçš„ä»£ç 
2. **å‘½åç©ºé—´**ï¼šé¿å…å˜é‡åå†²çª
3. **ä»£ç ç»„ç»‡**ï¼šå°†ç›¸å…³åŠŸèƒ½ç»„ç»‡åœ¨ä¸€èµ·
4. **ç»´æŠ¤æ€§**ï¼šä¾¿äºä»£ç çš„ç»´æŠ¤å’Œæ›´æ–°
5. **åä½œå¼€å‘**ï¼šå›¢é˜Ÿæˆå‘˜å¯ä»¥ç‹¬ç«‹å¼€å‘ä¸åŒæ¨¡å—

---

## ä¸€ã€åˆ›å»ºå’Œä½¿ç”¨æ¨¡å—

### 1.1 åˆ›å»ºç®€å•æ¨¡å—

è®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªæ•°å­¦å·¥å…·æ¨¡å—ï¼š

```python
# æ–‡ä»¶åï¼šmath_utils.py
"""æ•°å­¦å·¥å…·æ¨¡å—

è¿™ä¸ªæ¨¡å—æä¾›äº†ä¸€äº›å¸¸ç”¨çš„æ•°å­¦å‡½æ•°ã€‚
"""

import math

# æ¨¡å—çº§å˜é‡
PI = 3.14159265359
E = 2.71828182846

def add(x, y):
    """åŠ æ³•å‡½æ•°"""
    return x + y

def subtract(x, y):
    """å‡æ³•å‡½æ•°"""
    return x - y

def multiply(x, y):
    """ä¹˜æ³•å‡½æ•°"""
    return x * y

def divide(x, y):
    """é™¤æ³•å‡½æ•°"""
    if y == 0:
        raise ValueError("é™¤æ•°ä¸èƒ½ä¸ºé›¶")
    return x / y

def power(base, exponent):
    """å¹‚è¿ç®—"""
    return base ** exponent

def factorial(n):
    """è®¡ç®—é˜¶ä¹˜"""
    if n < 0:
        raise ValueError("é˜¶ä¹˜çš„å‚æ•°å¿…é¡»æ˜¯éè´Ÿæ•´æ•°")
    if n == 0 or n == 1:
        return 1
    return n * factorial(n - 1)

def is_prime(n):
    """åˆ¤æ–­æ˜¯å¦ä¸ºè´¨æ•°"""
    if n < 2:
        return False
    for i in range(2, int(math.sqrt(n)) + 1):
        if n % i == 0:
            return False
    return True

def gcd(a, b):
    """è®¡ç®—æœ€å¤§å…¬çº¦æ•°"""
    while b:
        a, b = b, a % b
    return a

def lcm(a, b):
    """è®¡ç®—æœ€å°å…¬å€æ•°"""
    return abs(a * b) // gcd(a, b)

class Calculator:
    """ç®€å•è®¡ç®—å™¨ç±»"""
    
    def __init__(self):
        self.history = []
    
    def calculate(self, operation, x, y=None):
        """æ‰§è¡Œè®¡ç®—å¹¶è®°å½•å†å²"""
        if operation == 'add' and y is not None:
            result = add(x, y)
        elif operation == 'subtract' and y is not None:
            result = subtract(x, y)
        elif operation == 'multiply' and y is not None:
            result = multiply(x, y)
        elif operation == 'divide' and y is not None:
            result = divide(x, y)
        elif operation == 'factorial':
            result = factorial(x)
        else:
            raise ValueError("ä¸æ”¯æŒçš„æ“ä½œ")
        
        self.history.append(f"{operation}({x}, {y}) = {result}" if y is not None else f"{operation}({x}) = {result}")
        return result
    
    def get_history(self):
        """è·å–è®¡ç®—å†å²"""
        return self.history.copy()
    
    def clear_history(self):
        """æ¸…ç©ºè®¡ç®—å†å²"""
        self.history.clear()

# æ¨¡å—çº§ä»£ç ï¼ˆå¯¼å…¥æ—¶æ‰§è¡Œï¼‰
print(f"æ•°å­¦å·¥å…·æ¨¡å—å·²åŠ è½½ï¼ŒÏ€ = {PI}, e = {E}")

# æµ‹è¯•ä»£ç ï¼ˆåªåœ¨ç›´æ¥è¿è¡Œæ—¶æ‰§è¡Œï¼‰
if __name__ == "__main__":
    print("æµ‹è¯•æ•°å­¦å·¥å…·æ¨¡å—ï¼š")
    print(f"5 + 3 = {add(5, 3)}")
    print(f"10 - 4 = {subtract(10, 4)}")
    print(f"6 * 7 = {multiply(6, 7)}")
    print(f"15 / 3 = {divide(15, 3)}")
    print(f"2^8 = {power(2, 8)}")
    print(f"5! = {factorial(5)}")
    print(f"17æ˜¯è´¨æ•°å—ï¼Ÿ{is_prime(17)}")
    print(f"gcd(48, 18) = {gcd(48, 18)}")
    print(f"lcm(12, 8) = {lcm(12, 8)}")
    
    calc = Calculator()
    calc.calculate('add', 10, 5)
    calc.calculate('factorial', 5)
    print("è®¡ç®—å†å²ï¼š", calc.get_history())
```

### 1.2 å¯¼å…¥å’Œä½¿ç”¨æ¨¡å—

```python
# ä½¿ç”¨æˆ‘ä»¬åˆ›å»ºçš„math_utilsæ¨¡å—

# æ–¹æ³•1ï¼šå¯¼å…¥æ•´ä¸ªæ¨¡å—
import math_utils

result1 = math_utils.add(10, 5)
print(f"10 + 5 = {result1}")
print(f"Ï€çš„å€¼ï¼š{math_utils.PI}")

# æ–¹æ³•2ï¼šå¯¼å…¥ç‰¹å®šå‡½æ•°
from math_utils import multiply, divide, factorial

result2 = multiply(6, 7)
result3 = divide(20, 4)
result4 = factorial(5)
print(f"6 * 7 = {result2}")
print(f"20 / 4 = {result3}")
print(f"5! = {result4}")

# æ–¹æ³•3ï¼šå¯¼å…¥å¹¶é‡å‘½å
from math_utils import is_prime as check_prime
from math_utils import Calculator as Calc

print(f"13æ˜¯è´¨æ•°å—ï¼Ÿ{check_prime(13)}")
calc = Calc()
result5 = calc.calculate('add', 15, 25)
print(f"è®¡ç®—ç»“æœï¼š{result5}")

# æ–¹æ³•4ï¼šå¯¼å…¥æ‰€æœ‰ï¼ˆä¸æ¨èï¼‰
# from math_utils import *
# è¿™ç§æ–¹å¼å¯èƒ½å¯¼è‡´å‘½åå†²çªï¼Œä¸€èˆ¬ä¸æ¨èä½¿ç”¨

# æ–¹æ³•5ï¼šä½¿ç”¨åˆ«åå¯¼å…¥æ¨¡å—
import math_utils as mu

result6 = mu.power(2, 10)
print(f"2^10 = {result6}")
```

---

## äºŒã€æ¨¡å—æœç´¢è·¯å¾„

### 2.1 Pythonå¦‚ä½•æŸ¥æ‰¾æ¨¡å—

PythonæŒ‰ä»¥ä¸‹é¡ºåºæœç´¢æ¨¡å—ï¼š

1. **å½“å‰ç›®å½•**
2. **PYTHONPATHç¯å¢ƒå˜é‡æŒ‡å®šçš„ç›®å½•**
3. **æ ‡å‡†åº“ç›®å½•**
4. **site-packagesç›®å½•**ï¼ˆç¬¬ä¸‰æ–¹åŒ…ï¼‰

```python
import sys

# æŸ¥çœ‹æ¨¡å—æœç´¢è·¯å¾„
print("Pythonæ¨¡å—æœç´¢è·¯å¾„ï¼š")
for i, path in enumerate(sys.path, 1):
    print(f"{i}. {path}")

# åŠ¨æ€æ·»åŠ æœç´¢è·¯å¾„
sys.path.append('/path/to/your/modules')

# æŸ¥çœ‹å·²åŠ è½½çš„æ¨¡å—
print("\nå·²åŠ è½½çš„æ¨¡å—ï¼š")
for module_name in sorted(sys.modules.keys())[:10]:  # åªæ˜¾ç¤ºå‰10ä¸ª
    print(f"- {module_name}")
```

### 2.2 æ¨¡å—çš„å±æ€§å’Œä¿¡æ¯

```python
import math_utils
import math

# æŸ¥çœ‹æ¨¡å—å±æ€§
print("math_utilsæ¨¡å—çš„å±æ€§ï¼š")
for attr in dir(math_utils):
    if not attr.startswith('_'):  # ä¸æ˜¾ç¤ºç§æœ‰å±æ€§
        print(f"- {attr}")

# æ¨¡å—çš„ç‰¹æ®Šå±æ€§
print(f"\næ¨¡å—åç§°ï¼š{math_utils.__name__}")
print(f"æ¨¡å—æ–‡æ¡£ï¼š{math_utils.__doc__}")
print(f"æ¨¡å—æ–‡ä»¶è·¯å¾„ï¼š{math_utils.__file__}")

# è·å–å‡½æ•°çš„å¸®åŠ©ä¿¡æ¯
help(math_utils.factorial)

# æ£€æŸ¥å¯¹è±¡ç±»å‹
print(f"\naddæ˜¯å‡½æ•°å—ï¼Ÿ{callable(math_utils.add)}")
print(f"PIæ˜¯ä»€ä¹ˆç±»å‹ï¼Ÿ{type(math_utils.PI)}")
print(f"Calculatoræ˜¯ç±»å—ï¼Ÿ{isinstance(math_utils.Calculator, type)}")
```

---

## ä¸‰ã€åŒ…ï¼ˆPackagesï¼‰

### 3.1 ä»€ä¹ˆæ˜¯åŒ…

åŒ…æ˜¯åŒ…å«å¤šä¸ªæ¨¡å—çš„ç›®å½•ï¼Œå¿…é¡»åŒ…å«ä¸€ä¸ª`__init__.py`æ–‡ä»¶ï¼ˆå¯ä»¥ä¸ºç©ºï¼‰ã€‚

```
my_package/
    __init__.py
    module1.py
    module2.py
    subpackage/
        __init__.py
        module3.py
        module4.py
```

### 3.2 åˆ›å»ºåŒ…ç»“æ„

è®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªå®Œæ•´çš„å·¥å…·åŒ…ï¼š

```python
# ç›®å½•ç»“æ„ï¼š
# utils/
#     __init__.py
#     string_utils.py
#     file_utils.py
#     data_utils.py
#     math/
#         __init__.py
#         basic.py
#         advanced.py

# utils/__init__.py
"""å·¥å…·åŒ…

è¿™ä¸ªåŒ…æä¾›äº†å„ç§å®ç”¨å·¥å…·å‡½æ•°ã€‚
"""

__version__ = "1.0.0"
__author__ = "å“ªå’"

# å¯¼å…¥å­æ¨¡å—ï¼Œä½¿å…¶å¯ä»¥ç›´æ¥ä»åŒ…ä¸­è®¿é—®
from .string_utils import *
from .file_utils import read_file, write_file
from .data_utils import DataProcessor

# å®šä¹‰åŒ…çº§åˆ«çš„å‡½æ•°
def get_package_info():
    """è·å–åŒ…ä¿¡æ¯"""
    return {
        'name': __name__,
        'version': __version__,
        'author': __author__
    }

# å®šä¹‰__all__æ¥æ§åˆ¶from utils import *çš„è¡Œä¸º
__all__ = [
    'get_package_info',
    'capitalize_words',
    'reverse_string',
    'read_file',
    'write_file',
    'DataProcessor'
]
```

```python
# utils/string_utils.py
"""å­—ç¬¦ä¸²å·¥å…·æ¨¡å—"""

def capitalize_words(text):
    """å°†æ¯ä¸ªå•è¯çš„é¦–å­—æ¯å¤§å†™"""
    return ' '.join(word.capitalize() for word in text.split())

def reverse_string(text):
    """åè½¬å­—ç¬¦ä¸²"""
    return text[::-1]

def count_words(text):
    """ç»Ÿè®¡å•è¯æ•°é‡"""
    return len(text.split())

def remove_duplicates(text):
    """ç§»é™¤é‡å¤çš„å•è¯"""
    words = text.split()
    unique_words = []
    for word in words:
        if word not in unique_words:
            unique_words.append(word)
    return ' '.join(unique_words)

def is_palindrome(text):
    """æ£€æŸ¥æ˜¯å¦ä¸ºå›æ–‡"""
    cleaned = ''.join(char.lower() for char in text if char.isalnum())
    return cleaned == cleaned[::-1]

class StringProcessor:
    """å­—ç¬¦ä¸²å¤„ç†å™¨ç±»"""
    
    def __init__(self, text):
        self.text = text
    
    def process(self, operations):
        """åº”ç”¨ä¸€ç³»åˆ—æ“ä½œ"""
        result = self.text
        for operation in operations:
            if operation == 'capitalize':
                result = capitalize_words(result)
            elif operation == 'reverse':
                result = reverse_string(result)
            elif operation == 'remove_duplicates':
                result = remove_duplicates(result)
        return result
```

```python
# utils/file_utils.py
"""æ–‡ä»¶æ“ä½œå·¥å…·æ¨¡å—"""

import os
import json
import csv
from typing import List, Dict, Any

def read_file(filepath, encoding='utf-8'):
    """è¯»å–æ–‡æœ¬æ–‡ä»¶"""
    try:
        with open(filepath, 'r', encoding=encoding) as file:
            return file.read()
    except FileNotFoundError:
        print(f"æ–‡ä»¶ {filepath} ä¸å­˜åœ¨")
        return None
    except Exception as e:
        print(f"è¯»å–æ–‡ä»¶æ—¶å‡ºé”™ï¼š{e}")
        return None

def write_file(filepath, content, encoding='utf-8'):
    """å†™å…¥æ–‡æœ¬æ–‡ä»¶"""
    try:
        # ç¡®ä¿ç›®å½•å­˜åœ¨
        os.makedirs(os.path.dirname(filepath), exist_ok=True)
        with open(filepath, 'w', encoding=encoding) as file:
            file.write(content)
        return True
    except Exception as e:
        print(f"å†™å…¥æ–‡ä»¶æ—¶å‡ºé”™ï¼š{e}")
        return False

def read_json(filepath):
    """è¯»å–JSONæ–‡ä»¶"""
    try:
        with open(filepath, 'r', encoding='utf-8') as file:
            return json.load(file)
    except Exception as e:
        print(f"è¯»å–JSONæ–‡ä»¶æ—¶å‡ºé”™ï¼š{e}")
        return None

def write_json(filepath, data, indent=2):
    """å†™å…¥JSONæ–‡ä»¶"""
    try:
        os.makedirs(os.path.dirname(filepath), exist_ok=True)
        with open(filepath, 'w', encoding='utf-8') as file:
            json.dump(data, file, indent=indent, ensure_ascii=False)
        return True
    except Exception as e:
        print(f"å†™å…¥JSONæ–‡ä»¶æ—¶å‡ºé”™ï¼š{e}")
        return False

def read_csv(filepath):
    """è¯»å–CSVæ–‡ä»¶"""
    try:
        with open(filepath, 'r', encoding='utf-8') as file:
            reader = csv.DictReader(file)
            return list(reader)
    except Exception as e:
        print(f"è¯»å–CSVæ–‡ä»¶æ—¶å‡ºé”™ï¼š{e}")
        return None

def write_csv(filepath, data, fieldnames=None):
    """å†™å…¥CSVæ–‡ä»¶"""
    try:
        if not data:
            return False
        
        if fieldnames is None:
            fieldnames = data[0].keys() if isinstance(data[0], dict) else None
        
        os.makedirs(os.path.dirname(filepath), exist_ok=True)
        with open(filepath, 'w', newline='', encoding='utf-8') as file:
            writer = csv.DictWriter(file, fieldnames=fieldnames)
            writer.writeheader()
            writer.writerows(data)
        return True
    except Exception as e:
        print(f"å†™å…¥CSVæ–‡ä»¶æ—¶å‡ºé”™ï¼š{e}")
        return False

def get_file_info(filepath):
    """è·å–æ–‡ä»¶ä¿¡æ¯"""
    try:
        stat = os.stat(filepath)
        return {
            'size': stat.st_size,
            'modified': stat.st_mtime,
            'created': stat.st_ctime,
            'is_file': os.path.isfile(filepath),
            'is_dir': os.path.isdir(filepath)
        }
    except Exception as e:
        print(f"è·å–æ–‡ä»¶ä¿¡æ¯æ—¶å‡ºé”™ï¼š{e}")
        return None

class FileManager:
    """æ–‡ä»¶ç®¡ç†å™¨ç±»"""
    
    def __init__(self, base_path='.'):
        self.base_path = base_path
    
    def list_files(self, extension=None):
        """åˆ—å‡ºç›®å½•ä¸­çš„æ–‡ä»¶"""
        files = []
        for item in os.listdir(self.base_path):
            item_path = os.path.join(self.base_path, item)
            if os.path.isfile(item_path):
                if extension is None or item.endswith(extension):
                    files.append(item)
        return files
    
    def create_backup(self, filepath):
        """åˆ›å»ºæ–‡ä»¶å¤‡ä»½"""
        backup_path = filepath + '.backup'
        try:
            content = read_file(filepath)
            if content is not None:
                return write_file(backup_path, content)
        except Exception as e:
            print(f"åˆ›å»ºå¤‡ä»½æ—¶å‡ºé”™ï¼š{e}")
        return False
```

```python
# utils/data_utils.py
"""æ•°æ®å¤„ç†å·¥å…·æ¨¡å—"""

from typing import List, Dict, Any, Union
from collections import Counter
import statistics

class DataProcessor:
    """æ•°æ®å¤„ç†å™¨ç±»"""
    
    def __init__(self, data: List[Any] = None):
        self.data = data or []
    
    def add_data(self, item: Any):
        """æ·»åŠ æ•°æ®é¡¹"""
        self.data.append(item)
    
    def filter_data(self, condition):
        """è¿‡æ»¤æ•°æ®"""
        return [item for item in self.data if condition(item)]
    
    def map_data(self, transform):
        """è½¬æ¢æ•°æ®"""
        return [transform(item) for item in self.data]
    
    def group_by(self, key_func):
        """æŒ‰æ¡ä»¶åˆ†ç»„"""
        groups = {}
        for item in self.data:
            key = key_func(item)
            if key not in groups:
                groups[key] = []
            groups[key].append(item)
        return groups
    
    def get_statistics(self):
        """è·å–æ•°å€¼æ•°æ®çš„ç»Ÿè®¡ä¿¡æ¯"""
        if not self.data or not all(isinstance(x, (int, float)) for x in self.data):
            return None
        
        return {
            'count': len(self.data),
            'sum': sum(self.data),
            'mean': statistics.mean(self.data),
            'median': statistics.median(self.data),
            'mode': statistics.mode(self.data) if len(set(self.data)) < len(self.data) else None,
            'min': min(self.data),
            'max': max(self.data),
            'range': max(self.data) - min(self.data)
        }

def clean_data(data: List[Dict[str, Any]], required_fields: List[str]) -> List[Dict[str, Any]]:
    """æ¸…ç†æ•°æ®ï¼Œç§»é™¤ç¼ºå°‘å¿…éœ€å­—æ®µçš„è®°å½•"""
    cleaned = []
    for record in data:
        if all(field in record and record[field] is not None for field in required_fields):
            cleaned.append(record)
    return cleaned

def aggregate_data(data: List[Dict[str, Any]], group_by: str, aggregate_field: str, operation: str = 'sum'):
    """èšåˆæ•°æ®"""
    groups = {}
    
    for record in data:
        key = record.get(group_by)
        if key not in groups:
            groups[key] = []
        groups[key].append(record.get(aggregate_field, 0))
    
    result = {}
    for key, values in groups.items():
        if operation == 'sum':
            result[key] = sum(values)
        elif operation == 'avg':
            result[key] = sum(values) / len(values) if values else 0
        elif operation == 'count':
            result[key] = len(values)
        elif operation == 'max':
            result[key] = max(values) if values else 0
        elif operation == 'min':
            result[key] = min(values) if values else 0
    
    return result

def find_duplicates(data: List[Any]) -> List[Any]:
    """æŸ¥æ‰¾é‡å¤é¡¹"""
    counter = Counter(data)
    return [item for item, count in counter.items() if count > 1]

def remove_duplicates(data: List[Any]) -> List[Any]:
    """ç§»é™¤é‡å¤é¡¹ï¼Œä¿æŒé¡ºåº"""
    seen = set()
    result = []
    for item in data:
        if item not in seen:
            seen.add(item)
            result.append(item)
    return result

def sort_data(data: List[Dict[str, Any]], sort_by: str, reverse: bool = False) -> List[Dict[str, Any]]:
    """æ’åºæ•°æ®"""
    return sorted(data, key=lambda x: x.get(sort_by, 0), reverse=reverse)
```

```python
# utils/math/__init__.py
"""æ•°å­¦å·¥å…·å­åŒ…"""

from .basic import *
from .advanced import *

__all__ = ['add', 'subtract', 'multiply', 'divide', 'power', 'sqrt', 'log', 'sin', 'cos']
```

```python
# utils/math/basic.py
"""åŸºç¡€æ•°å­¦è¿ç®—"""

def add(x, y):
    """åŠ æ³•"""
    return x + y

def subtract(x, y):
    """å‡æ³•"""
    return x - y

def multiply(x, y):
    """ä¹˜æ³•"""
    return x * y

def divide(x, y):
    """é™¤æ³•"""
    if y == 0:
        raise ValueError("é™¤æ•°ä¸èƒ½ä¸ºé›¶")
    return x / y

def power(base, exponent):
    """å¹‚è¿ç®—"""
    return base ** exponent
```

```python
# utils/math/advanced.py
"""é«˜çº§æ•°å­¦è¿ç®—"""

import math

def sqrt(x):
    """å¹³æ–¹æ ¹"""
    if x < 0:
        raise ValueError("è´Ÿæ•°ä¸èƒ½å¼€å¹³æ–¹æ ¹")
    return math.sqrt(x)

def log(x, base=math.e):
    """å¯¹æ•°"""
    if x <= 0:
        raise ValueError("å¯¹æ•°çš„å‚æ•°å¿…é¡»å¤§äº0")
    return math.log(x, base)

def sin(x):
    """æ­£å¼¦"""
    return math.sin(x)

def cos(x):
    """ä½™å¼¦"""
    return math.cos(x)

def tan(x):
    """æ­£åˆ‡"""
    return math.tan(x)
```

### 3.3 ä½¿ç”¨åŒ…

```python
# ä½¿ç”¨æˆ‘ä»¬åˆ›å»ºçš„å·¥å…·åŒ…

# å¯¼å…¥æ•´ä¸ªåŒ…
import utils

# ä½¿ç”¨åŒ…çº§åˆ«çš„å‡½æ•°
info = utils.get_package_info()
print(f"åŒ…ä¿¡æ¯ï¼š{info}")

# ä½¿ç”¨å­—ç¬¦ä¸²å·¥å…·
text = "hello world python programming"
result = utils.capitalize_words(text)
print(f"é¦–å­—æ¯å¤§å†™ï¼š{result}")

# ä½¿ç”¨æ–‡ä»¶å·¥å…·
utils.write_file('test.txt', 'Hello, World!')
content = utils.read_file('test.txt')
print(f"æ–‡ä»¶å†…å®¹ï¼š{content}")

# ä½¿ç”¨æ•°æ®å¤„ç†å™¨
processor = utils.DataProcessor([1, 2, 3, 4, 5, 6, 7, 8, 9, 10])
even_numbers = processor.filter_data(lambda x: x % 2 == 0)
print(f"å¶æ•°ï¼š{even_numbers}")

stats = processor.get_statistics()
print(f"ç»Ÿè®¡ä¿¡æ¯ï¼š{stats}")

# å¯¼å…¥å­åŒ…
from utils.math import add, multiply, sqrt

result1 = add(10, 5)
result2 = multiply(6, 7)
result3 = sqrt(16)
print(f"æ•°å­¦è¿ç®—ï¼š{result1}, {result2}, {result3}")

# ä½¿ç”¨åˆ«åå¯¼å…¥
from utils.string_utils import StringProcessor as SP

processor = SP("hello world hello python")
result = processor.process(['capitalize', 'remove_duplicates'])
print(f"å­—ç¬¦ä¸²å¤„ç†ç»“æœï¼š{result}")
```

---

## å››ã€æ ‡å‡†åº“æ¨¡å—

### 4.1 å¸¸ç”¨æ ‡å‡†åº“æ¨¡å—

```python
# osæ¨¡å— - æ“ä½œç³»ç»Ÿæ¥å£
import os

print(f"å½“å‰å·¥ä½œç›®å½•ï¼š{os.getcwd()}")
print(f"ç”¨æˆ·ä¸»ç›®å½•ï¼š{os.path.expanduser('~')}")
print(f"è·¯å¾„åˆ†éš”ç¬¦ï¼š{os.sep}")

# ç¯å¢ƒå˜é‡
print(f"PATHç¯å¢ƒå˜é‡ï¼š{os.environ.get('PATH', 'æœªè®¾ç½®')}")

# æ–‡ä»¶å’Œç›®å½•æ“ä½œ
if not os.path.exists('temp_dir'):
    os.makedirs('temp_dir')
    print("åˆ›å»ºäº†ä¸´æ—¶ç›®å½•")

# sysæ¨¡å— - ç³»ç»Ÿç›¸å…³å‚æ•°å’Œå‡½æ•°
import sys

print(f"Pythonç‰ˆæœ¬ï¼š{sys.version}")
print(f"å¹³å°ï¼š{sys.platform}")
print(f"å‘½ä»¤è¡Œå‚æ•°ï¼š{sys.argv}")

# datetimeæ¨¡å— - æ—¥æœŸå’Œæ—¶é—´
from datetime import datetime, date, time, timedelta

now = datetime.now()
print(f"å½“å‰æ—¶é—´ï¼š{now}")
print(f"æ ¼å¼åŒ–æ—¶é—´ï¼š{now.strftime('%Y-%m-%d %H:%M:%S')}")

# æ—¶é—´è®¡ç®—
tomorrow = now + timedelta(days=1)
print(f"æ˜å¤©ï¼š{tomorrow.strftime('%Y-%m-%d')}")

# randomæ¨¡å— - éšæœºæ•°ç”Ÿæˆ
import random

print(f"éšæœºæ•´æ•°ï¼š{random.randint(1, 100)}")
print(f"éšæœºæµ®ç‚¹æ•°ï¼š{random.random()}")
print(f"éšæœºé€‰æ‹©ï¼š{random.choice(['apple', 'banana', 'orange'])}")

# éšæœºæ‰“ä¹±åˆ—è¡¨
numbers = [1, 2, 3, 4, 5]
random.shuffle(numbers)
print(f"æ‰“ä¹±åçš„åˆ—è¡¨ï¼š{numbers}")

# jsonæ¨¡å— - JSONæ•°æ®å¤„ç†
import json

data = {
    'name': 'å¼ ä¸‰',
    'age': 25,
    'skills': ['Python', 'JavaScript', 'SQL']
}

# è½¬æ¢ä¸ºJSONå­—ç¬¦ä¸²
json_str = json.dumps(data, ensure_ascii=False, indent=2)
print(f"JSONå­—ç¬¦ä¸²ï¼š\n{json_str}")

# ä»JSONå­—ç¬¦ä¸²è§£æ
parsed_data = json.loads(json_str)
print(f"è§£æåçš„æ•°æ®ï¼š{parsed_data}")
```

### 4.2 æ›´å¤šå®ç”¨æ ‡å‡†åº“

```python
# collectionsæ¨¡å— - ç‰¹æ®Šå®¹å™¨æ•°æ®ç±»å‹
from collections import Counter, defaultdict, namedtuple, deque

# Counter - è®¡æ•°å™¨
text = "hello world"
letter_count = Counter(text)
print(f"å­—æ¯è®¡æ•°ï¼š{letter_count}")
print(f"æœ€å¸¸è§çš„3ä¸ªå­—æ¯ï¼š{letter_count.most_common(3)}")

# defaultdict - é»˜è®¤å­—å…¸
dd = defaultdict(list)
dd['fruits'].append('apple')
dd['fruits'].append('banana')
dd['vegetables'].append('carrot')
print(f"é»˜è®¤å­—å…¸ï¼š{dict(dd)}")

# namedtuple - å‘½åå…ƒç»„
Point = namedtuple('Point', ['x', 'y'])
p = Point(3, 4)
print(f"ç‚¹åæ ‡ï¼š{p}, x={p.x}, y={p.y}")

# deque - åŒç«¯é˜Ÿåˆ—
dq = deque([1, 2, 3])
dq.appendleft(0)
dq.append(4)
print(f"åŒç«¯é˜Ÿåˆ—ï¼š{list(dq)}")

# itertoolsæ¨¡å— - è¿­ä»£å·¥å…·
import itertools

# ç»„åˆå’Œæ’åˆ—
data = ['A', 'B', 'C']
combinations = list(itertools.combinations(data, 2))
permutations = list(itertools.permutations(data, 2))
print(f"ç»„åˆï¼š{combinations}")
print(f"æ’åˆ—ï¼š{permutations}")

# æ— é™è¿­ä»£å™¨
counter = itertools.count(1, 2)  # ä»1å¼€å§‹ï¼Œæ­¥é•¿ä¸º2
first_5_odd = [next(counter) for _ in range(5)]
print(f"å‰5ä¸ªå¥‡æ•°ï¼š{first_5_odd}")

# reæ¨¡å— - æ­£åˆ™è¡¨è¾¾å¼
import re

text = "è”ç³»ç”µè¯ï¼š138-1234-5678ï¼Œé‚®ç®±ï¼šuser@example.com"

# æŸ¥æ‰¾ç”µè¯å·ç 
phone_pattern = r'\d{3}-\d{4}-\d{4}'
phone = re.search(phone_pattern, text)
if phone:
    print(f"æ‰¾åˆ°ç”µè¯å·ç ï¼š{phone.group()}")

# æŸ¥æ‰¾é‚®ç®±
email_pattern = r'\w+@\w+\.\w+'
email = re.search(email_pattern, text)
if email:
    print(f"æ‰¾åˆ°é‚®ç®±ï¼š{email.group()}")

# æ›¿æ¢æ–‡æœ¬
cleaned_text = re.sub(r'\d{3}-\d{4}-\d{4}', '[ç”µè¯å·²éšè—]', text)
print(f"æ¸…ç†åçš„æ–‡æœ¬ï¼š{cleaned_text}")

# pathlibæ¨¡å— - é¢å‘å¯¹è±¡çš„è·¯å¾„æ“ä½œ
from pathlib import Path

# åˆ›å»ºè·¯å¾„å¯¹è±¡
path = Path('data/files/document.txt')
print(f"æ–‡ä»¶åï¼š{path.name}")
print(f"æ–‡ä»¶æ‰©å±•åï¼š{path.suffix}")
print(f"çˆ¶ç›®å½•ï¼š{path.parent}")
print(f"ç»å¯¹è·¯å¾„ï¼š{path.absolute()}")

# è·¯å¾„æ“ä½œ
new_path = path.with_suffix('.pdf')
print(f"æ›´æ”¹æ‰©å±•ååï¼š{new_path}")

# æ£€æŸ¥è·¯å¾„
print(f"è·¯å¾„å­˜åœ¨å—ï¼Ÿ{path.exists()}")
print(f"æ˜¯æ–‡ä»¶å—ï¼Ÿ{path.is_file()}")
print(f"æ˜¯ç›®å½•å—ï¼Ÿ{path.is_dir()}")
```

---

## äº”ã€ç¬¬ä¸‰æ–¹åŒ…ç®¡ç†

### 5.1 pipåŒ…ç®¡ç†å™¨

```bash
# å®‰è£…åŒ…
pip install requests
pip install pandas numpy matplotlib

# å®‰è£…ç‰¹å®šç‰ˆæœ¬
pip install django==3.2.0

# ä»requirements.txtå®‰è£…
pip install -r requirements.txt

# å‡çº§åŒ…
pip upgrade requests

# å¸è½½åŒ…
pip uninstall requests

# åˆ—å‡ºå·²å®‰è£…çš„åŒ…
pip list

# æ˜¾ç¤ºåŒ…ä¿¡æ¯
pip show requests

# ç”Ÿæˆrequirements.txt
pip freeze > requirements.txt
```

### 5.2 è™šæ‹Ÿç¯å¢ƒ

```bash
# åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
python -m venv myenv

# æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ
# Windows
myenv\Scripts\activate
# macOS/Linux
source myenv/bin/activate

# åœç”¨è™šæ‹Ÿç¯å¢ƒ
deactivate

# åˆ é™¤è™šæ‹Ÿç¯å¢ƒ
rmdir /s myenv  # Windows
rm -rf myenv    # macOS/Linux
```

### 5.3 å¸¸ç”¨ç¬¬ä¸‰æ–¹åŒ…ç¤ºä¾‹

```python
# requests - HTTPåº“
import requests

response = requests.get('https://api.github.com/users/octocat')
if response.status_code == 200:
    data = response.json()
    print(f"ç”¨æˆ·åï¼š{data['login']}")
    print(f"å…¬å¼€ä»“åº“æ•°ï¼š{data['public_repos']}")

# pandas - æ•°æ®åˆ†æ
import pandas as pd

# åˆ›å»ºDataFrame
data = {
    'name': ['Alice', 'Bob', 'Charlie'],
    'age': [25, 30, 35],
    'city': ['åŒ—äº¬', 'ä¸Šæµ·', 'å¹¿å·']
}
df = pd.DataFrame(data)
print(df)

# æ•°æ®æ“ä½œ
print(f"å¹³å‡å¹´é¾„ï¼š{df['age'].mean()}")
print(f"å¹´é¾„å¤§äº25çš„äººï¼š\n{df[df['age'] > 25]}")

# matplotlib - ç»˜å›¾
import matplotlib.pyplot as plt
import numpy as np

x = np.linspace(0, 10, 100)
y = np.sin(x)

plt.figure(figsize=(10, 6))
plt.plot(x, y, label='sin(x)')
plt.xlabel('x')
plt.ylabel('y')
plt.title('æ­£å¼¦å‡½æ•°å›¾åƒ')
plt.legend()
plt.grid(True)
plt.show()
```

---

## å…­ã€æ¨¡å—æœ€ä½³å®è·µ

### 6.1 æ¨¡å—è®¾è®¡åŸåˆ™

```python
# å¥½çš„æ¨¡å—è®¾è®¡ç¤ºä¾‹
"""ç”¨æˆ·ç®¡ç†æ¨¡å—

è¿™ä¸ªæ¨¡å—æä¾›ç”¨æˆ·æ³¨å†Œã€ç™»å½•ã€æƒé™ç®¡ç†ç­‰åŠŸèƒ½ã€‚

ç¤ºä¾‹ç”¨æ³•ï¼š
    from user_manager import User, authenticate
    
    user = User('alice', 'alice@example.com')
    user.set_password('secret123')
    
    if authenticate('alice', 'secret123'):
        print('ç™»å½•æˆåŠŸ')
"""

import hashlib
import json
from datetime import datetime
from typing import Optional, Dict, List

# æ¨¡å—çº§å¸¸é‡
DEFAULT_ROLE = 'user'
ADMIN_ROLE = 'admin'
MAX_LOGIN_ATTEMPTS = 3

# ç§æœ‰å‡½æ•°ï¼ˆä»¥ä¸‹åˆ’çº¿å¼€å¤´ï¼‰
def _hash_password(password: str) -> str:
    """ç§æœ‰å‡½æ•°ï¼šå¯†ç å“ˆå¸Œ"""
    return hashlib.sha256(password.encode()).hexdigest()

def _validate_email(email: str) -> bool:
    """ç§æœ‰å‡½æ•°ï¼šé‚®ç®±éªŒè¯"""
    import re
    pattern = r'^[\w\.-]+@[\w\.-]+\.\w+$'
    return re.match(pattern, email) is not None

class User:
    """ç”¨æˆ·ç±»"""
    
    def __init__(self, username: str, email: str, role: str = DEFAULT_ROLE):
        if not username or not email:
            raise ValueError("ç”¨æˆ·åå’Œé‚®ç®±ä¸èƒ½ä¸ºç©º")
        
        if not _validate_email(email):
            raise ValueError("é‚®ç®±æ ¼å¼ä¸æ­£ç¡®")
        
        self.username = username
        self.email = email
        self.role = role
        self.password_hash = None
        self.created_at = datetime.now()
        self.last_login = None
        self.login_attempts = 0
        self.is_active = True
    
    def set_password(self, password: str) -> None:
        """è®¾ç½®å¯†ç """
        if len(password) < 6:
            raise ValueError("å¯†ç é•¿åº¦è‡³å°‘6ä½")
        self.password_hash = _hash_password(password)
    
    def check_password(self, password: str) -> bool:
        """æ£€æŸ¥å¯†ç """
        if not self.password_hash:
            return False
        return self.password_hash == _hash_password(password)
    
    def to_dict(self) -> Dict:
        """è½¬æ¢ä¸ºå­—å…¸"""
        return {
            'username': self.username,
            'email': self.email,
            'role': self.role,
            'created_at': self.created_at.isoformat(),
            'last_login': self.last_login.isoformat() if self.last_login else None,
            'is_active': self.is_active
        }
    
    def __str__(self):
        return f"User(username='{self.username}', email='{self.email}', role='{self.role}')"
    
    def __repr__(self):
        return self.__str__()

class UserManager:
    """ç”¨æˆ·ç®¡ç†å™¨"""
    
    def __init__(self):
        self.users: Dict[str, User] = {}
    
    def register(self, username: str, email: str, password: str, role: str = DEFAULT_ROLE) -> User:
        """æ³¨å†Œç”¨æˆ·"""
        if username in self.users:
            raise ValueError(f"ç”¨æˆ·å '{username}' å·²å­˜åœ¨")
        
        user = User(username, email, role)
        user.set_password(password)
        self.users[username] = user
        return user
    
    def authenticate(self, username: str, password: str) -> Optional[User]:
        """ç”¨æˆ·è®¤è¯"""
        user = self.users.get(username)
        if not user or not user.is_active:
            return None
        
        if user.login_attempts >= MAX_LOGIN_ATTEMPTS:
            raise ValueError("ç™»å½•å°è¯•æ¬¡æ•°è¿‡å¤šï¼Œè´¦æˆ·å·²é”å®š")
        
        if user.check_password(password):
            user.last_login = datetime.now()
            user.login_attempts = 0
            return user
        else:
            user.login_attempts += 1
            return None
    
    def get_user(self, username: str) -> Optional[User]:
        """è·å–ç”¨æˆ·"""
        return self.users.get(username)
    
    def list_users(self, role: Optional[str] = None) -> List[User]:
        """åˆ—å‡ºç”¨æˆ·"""
        if role:
            return [user for user in self.users.values() if user.role == role]
        return list(self.users.values())
    
    def export_users(self, filepath: str) -> bool:
        """å¯¼å‡ºç”¨æˆ·æ•°æ®"""
        try:
            data = [user.to_dict() for user in self.users.values()]
            with open(filepath, 'w', encoding='utf-8') as f:
                json.dump(data, f, indent=2, ensure_ascii=False)
            return True
        except Exception as e:
            print(f"å¯¼å‡ºç”¨æˆ·æ•°æ®å¤±è´¥ï¼š{e}")
            return False

# æ¨¡å—çº§å®ä¾‹ï¼ˆå•ä¾‹æ¨¡å¼ï¼‰
_user_manager = UserManager()

# å…¬å…±APIå‡½æ•°
def register_user(username: str, email: str, password: str, role: str = DEFAULT_ROLE) -> User:
    """æ³¨å†Œç”¨æˆ·ï¼ˆæ¨¡å—çº§å‡½æ•°ï¼‰"""
    return _user_manager.register(username, email, password, role)

def authenticate(username: str, password: str) -> Optional[User]:
    """ç”¨æˆ·è®¤è¯ï¼ˆæ¨¡å—çº§å‡½æ•°ï¼‰"""
    return _user_manager.authenticate(username, password)

def get_user(username: str) -> Optional[User]:
    """è·å–ç”¨æˆ·ï¼ˆæ¨¡å—çº§å‡½æ•°ï¼‰"""
    return _user_manager.get_user(username)

def list_users(role: Optional[str] = None) -> List[User]:
    """åˆ—å‡ºç”¨æˆ·ï¼ˆæ¨¡å—çº§å‡½æ•°ï¼‰"""
    return _user_manager.list_users(role)

# å®šä¹‰æ¨¡å—çš„å…¬å…±æ¥å£
__all__ = [
    'User',
    'UserManager', 
    'register_user',
    'authenticate',
    'get_user',
    'list_users',
    'DEFAULT_ROLE',
    'ADMIN_ROLE'
]

# æ¨¡å—æµ‹è¯•ä»£ç 
if __name__ == "__main__":
    # æµ‹è¯•ç”¨æˆ·ç®¡ç†åŠŸèƒ½
    print("æµ‹è¯•ç”¨æˆ·ç®¡ç†æ¨¡å—ï¼š")
    
    # æ³¨å†Œç”¨æˆ·
    alice = register_user('alice', 'alice@example.com', 'password123')
    bob = register_user('bob', 'bob@example.com', 'secret456', ADMIN_ROLE)
    
    print(f"æ³¨å†Œç”¨æˆ·ï¼š{alice}")
    print(f"æ³¨å†Œç®¡ç†å‘˜ï¼š{bob}")
    
    # ç”¨æˆ·è®¤è¯
    auth_user = authenticate('alice', 'password123')
    if auth_user:
        print(f"è®¤è¯æˆåŠŸï¼š{auth_user.username}")
    
    # åˆ—å‡ºç”¨æˆ·
    all_users = list_users()
    print(f"æ‰€æœ‰ç”¨æˆ·ï¼š{[user.username for user in all_users]}")
    
    admin_users = list_users(ADMIN_ROLE)
    print(f"ç®¡ç†å‘˜ç”¨æˆ·ï¼š{[user.username for user in admin_users]}")
```

### 6.2 æ¨¡å—æ–‡æ¡£å’Œæµ‹è¯•

```python
# æ–‡æ¡£å­—ç¬¦ä¸²æœ€ä½³å®è·µ
def calculate_distance(point1, point2):
    """è®¡ç®—ä¸¤ç‚¹ä¹‹é—´çš„æ¬§å‡ é‡Œå¾—è·ç¦»ã€‚
    
    Args:
        point1 (tuple): ç¬¬ä¸€ä¸ªç‚¹çš„åæ ‡ (x, y)
        point2 (tuple): ç¬¬äºŒä¸ªç‚¹çš„åæ ‡ (x, y)
    
    Returns:
        float: ä¸¤ç‚¹ä¹‹é—´çš„è·ç¦»
    
    Raises:
        ValueError: å½“è¾“å…¥ä¸æ˜¯æœ‰æ•ˆåæ ‡æ—¶
        TypeError: å½“è¾“å…¥ç±»å‹ä¸æ­£ç¡®æ—¶
    
    Examples:
        >>> calculate_distance((0, 0), (3, 4))
        5.0
        >>> calculate_distance((1, 1), (4, 5))
        5.0
    """
    try:
        x1, y1 = point1
        x2, y2 = point2
        return ((x2 - x1) ** 2 + (y2 - y1) ** 2) ** 0.5
    except (ValueError, TypeError) as e:
        raise ValueError(f"æ— æ•ˆçš„åæ ‡è¾“å…¥: {e}")

# å•å…ƒæµ‹è¯•ç¤ºä¾‹
import unittest

class TestMathUtils(unittest.TestCase):
    """æ•°å­¦å·¥å…·æ¨¡å—æµ‹è¯•"""
    
    def test_calculate_distance(self):
        """æµ‹è¯•è·ç¦»è®¡ç®—"""
        # æµ‹è¯•æ­£å¸¸æƒ…å†µ
        self.assertEqual(calculate_distance((0, 0), (3, 4)), 5.0)
        self.assertEqual(calculate_distance((1, 1), (1, 1)), 0.0)
        
        # æµ‹è¯•å¼‚å¸¸æƒ…å†µ
        with self.assertRaises(ValueError):
            calculate_distance((1, 2), (3,))  # åæ ‡ä¸å®Œæ•´
        
        with self.assertRaises(ValueError):
            calculate_distance("invalid", (1, 2))  # æ— æ•ˆç±»å‹

if __name__ == "__main__":
    unittest.main()
```

---

## ä¸ƒã€å®æˆ˜é¡¹ç›®ï¼šä¸ªäººä»»åŠ¡ç®¡ç†ç³»ç»Ÿ

è®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªå®Œæ•´çš„ä»»åŠ¡ç®¡ç†ç³»ç»Ÿæ¥å®è·µæ¨¡å—åŒ–ç¼–ç¨‹ï¼š

```python
# task_manager/
#     __init__.py
#     models.py
#     storage.py
#     cli.py
#     utils.py

# task_manager/__init__.py
"""ä¸ªäººä»»åŠ¡ç®¡ç†ç³»ç»Ÿ

ä¸€ä¸ªç®€å•è€Œå¼ºå¤§çš„ä»»åŠ¡ç®¡ç†å·¥å…·ã€‚
"""

__version__ = "1.0.0"
__author__ = "å“ªå’"

from .models import Task, TaskManager
from .storage import FileStorage, JSONStorage
from .utils import format_date, get_priority_color

__all__ = ['Task', 'TaskManager', 'FileStorage', 'JSONStorage', 'format_date', 'get_priority_color']
```

```python
# task_manager/models.py
"""ä»»åŠ¡æ¨¡å‹"""

from datetime import datetime, date
from typing import List, Optional, Dict, Any
from enum import Enum

class Priority(Enum):
    """ä»»åŠ¡ä¼˜å…ˆçº§"""
    LOW = 1
    MEDIUM = 2
    HIGH = 3
    URGENT = 4

class Status(Enum):
    """ä»»åŠ¡çŠ¶æ€"""
    TODO = "å¾…åŠ"
    IN_PROGRESS = "è¿›è¡Œä¸­"
    COMPLETED = "å·²å®Œæˆ"
    CANCELLED = "å·²å–æ¶ˆ"

class Task:
    """ä»»åŠ¡ç±»"""
    
    def __init__(self, title: str, description: str = "", priority: Priority = Priority.MEDIUM, 
                 due_date: Optional[date] = None, tags: Optional[List[str]] = None):
        self.id = self._generate_id()
        self.title = title
        self.description = description
        self.priority = priority
        self.status = Status.TODO
        self.created_at = datetime.now()
        self.updated_at = datetime.now()
        self.due_date = due_date
        self.completed_at = None
        self.tags = tags or []
    
    def _generate_id(self) -> str:
        """ç”Ÿæˆå”¯ä¸€ID"""
        import uuid
        return str(uuid.uuid4())[:8]
    
    def mark_completed(self):
        """æ ‡è®°ä¸ºå·²å®Œæˆ"""
        self.status = Status.COMPLETED
        self.completed_at = datetime.now()
        self.updated_at = datetime.now()
    
    def mark_in_progress(self):
        """æ ‡è®°ä¸ºè¿›è¡Œä¸­"""
        self.status = Status.IN_PROGRESS
        self.updated_at = datetime.now()
    
    def mark_cancelled(self):
        """æ ‡è®°ä¸ºå·²å–æ¶ˆ"""
        self.status = Status.CANCELLED
        self.updated_at = datetime.now()
    
    def update(self, title: Optional[str] = None, description: Optional[str] = None,
               priority: Optional[Priority] = None, due_date: Optional[date] = None,
               tags: Optional[List[str]] = None):
        """æ›´æ–°ä»»åŠ¡ä¿¡æ¯"""
        if title is not None:
            self.title = title
        if description is not None:
            self.description = description
        if priority is not None:
            self.priority = priority
        if due_date is not None:
            self.due_date = due_date
        if tags is not None:
            self.tags = tags
        self.updated_at = datetime.now()
    
    def add_tag(self, tag: str):
        """æ·»åŠ æ ‡ç­¾"""
        if tag not in self.tags:
            self.tags.append(tag)
            self.updated_at = datetime.now()
    
    def remove_tag(self, tag: str):
        """ç§»é™¤æ ‡ç­¾"""
        if tag in self.tags:
            self.tags.remove(tag)
            self.updated_at = datetime.now()
    
    def is_overdue(self) -> bool:
        """æ£€æŸ¥æ˜¯å¦è¿‡æœŸ"""
        if self.due_date and self.status not in [Status.COMPLETED, Status.CANCELLED]:
            return date.today() > self.due_date
        return False
    
    def days_until_due(self) -> Optional[int]:
        """è·ç¦»æˆªæ­¢æ—¥æœŸçš„å¤©æ•°"""
        if self.due_date:
            delta = self.due_date - date.today()
            return delta.days
        return None
    
    def to_dict(self) -> Dict[str, Any]:
        """è½¬æ¢ä¸ºå­—å…¸"""
        return {
            'id': self.id,
            'title': self.title,
            'description': self.description,
            'priority': self.priority.value,
            'status': self.status.value,
            'created_at': self.created_at.isoformat(),
            'updated_at': self.updated_at.isoformat(),
            'due_date': self.due_date.isoformat() if self.due_date else None,
            'completed_at': self.completed_at.isoformat() if self.completed_at else None,
            'tags': self.tags
        }
    
    @classmethod
    def from_dict(cls, data: Dict[str, Any]) -> 'Task':
        """ä»å­—å…¸åˆ›å»ºä»»åŠ¡"""
        task = cls.__new__(cls)
        task.id = data['id']
        task.title = data['title']
        task.description = data['description']
        task.priority = Priority(data['priority'])
        task.status = Status(data['status'])
        task.created_at = datetime.fromisoformat(data['created_at'])
        task.updated_at = datetime.fromisoformat(data['updated_at'])
        task.due_date = date.fromisoformat(data['due_date']) if data['due_date'] else None
        task.completed_at = datetime.fromisoformat(data['completed_at']) if data['completed_at'] else None
        task.tags = data['tags']
        return task
    
    def __str__(self):
        status_icon = {
            Status.TODO: "â­•",
            Status.IN_PROGRESS: "ğŸ”„",
            Status.COMPLETED: "âœ…",
            Status.CANCELLED: "âŒ"
        }
        priority_icon = {
            Priority.LOW: "ğŸŸ¢",
            Priority.MEDIUM: "ğŸŸ¡",
            Priority.HIGH: "ğŸŸ ",
            Priority.URGENT: "ğŸ”´"
        }
        
        due_info = f" (æˆªæ­¢: {self.due_date})" if self.due_date else ""
        tags_info = f" #{' #'.join(self.tags)}" if self.tags else ""
        
        return f"{status_icon[self.status]} {priority_icon[self.priority]} {self.title}{due_info}{tags_info}"

class TaskManager:
    """ä»»åŠ¡ç®¡ç†å™¨"""
    
    def __init__(self):
        self.tasks: Dict[str, Task] = {}
    
    def add_task(self, title: str, description: str = "", priority: Priority = Priority.MEDIUM,
                 due_date: Optional[date] = None, tags: Optional[List[str]] = None) -> Task:
        """æ·»åŠ ä»»åŠ¡"""
        task = Task(title, description, priority, due_date, tags)
        self.tasks[task.id] = task
        return task
    
    def get_task(self, task_id: str) -> Optional[Task]:
        """è·å–ä»»åŠ¡"""
        return self.tasks.get(task_id)
    
    def update_task(self, task_id: str, **kwargs) -> bool:
        """æ›´æ–°ä»»åŠ¡"""
        task = self.get_task(task_id)
        if task:
            task.update(**kwargs)
            return True
        return False
    
    def delete_task(self, task_id: str) -> bool:
        """åˆ é™¤ä»»åŠ¡"""
        if task_id in self.tasks:
            del self.tasks[task_id]
            return True
        return False
    
    def list_tasks(self, status: Optional[Status] = None, priority: Optional[Priority] = None,
                   tag: Optional[str] = None, overdue_only: bool = False) -> List[Task]:
        """åˆ—å‡ºä»»åŠ¡"""
        tasks = list(self.tasks.values())
        
        if status:
            tasks = [t for t in tasks if t.status == status]
        
        if priority:
            tasks = [t for t in tasks if t.priority == priority]
        
        if tag:
            tasks = [t for t in tasks if tag in t.tags]
        
        if overdue_only:
            tasks = [t for t in tasks if t.is_overdue()]
        
        return sorted(tasks, key=lambda t: (t.priority.value, t.created_at), reverse=True)
    
    def search_tasks(self, keyword: str) -> List[Task]:
        """æœç´¢ä»»åŠ¡"""
        keyword = keyword.lower()
        return [task for task in self.tasks.values() 
                if keyword in task.title.lower() or keyword in task.description.lower()]
    
    def get_statistics(self) -> Dict[str, Any]:
        """è·å–ç»Ÿè®¡ä¿¡æ¯"""
        total = len(self.tasks)
        completed = len([t for t in self.tasks.values() if t.status == Status.COMPLETED])
        in_progress = len([t for t in self.tasks.values() if t.status == Status.IN_PROGRESS])
        overdue = len([t for t in self.tasks.values() if t.is_overdue()])
        
        return {
            'total': total,
            'completed': completed,
            'in_progress': in_progress,
            'todo': total - completed - in_progress,
            'overdue': overdue,
            'completion_rate': (completed / total * 100) if total > 0 else 0
        }
    
    def get_tasks_by_date(self, target_date: date) -> List[Task]:
        """è·å–æŒ‡å®šæ—¥æœŸçš„ä»»åŠ¡"""
        return [task for task in self.tasks.values() if task.due_date == target_date]
    
    def get_upcoming_tasks(self, days: int = 7) -> List[Task]:
        """è·å–å³å°†åˆ°æœŸçš„ä»»åŠ¡"""
        upcoming = []
        for task in self.tasks.values():
            if task.due_date and task.status not in [Status.COMPLETED, Status.CANCELLED]:
                days_until = task.days_until_due()
                if days_until is not None and 0 <= days_until <= days:
                    upcoming.append(task)
        return sorted(upcoming, key=lambda t: t.due_date)
```

---

## å…«ã€æ€»ç»“

### 8.1 æ¨¡å—ç³»ç»Ÿçš„æ ¸å¿ƒæ¦‚å¿µ

1. **æ¨¡å—**ï¼šåŒ…å«Pythonä»£ç çš„æ–‡ä»¶
2. **åŒ…**ï¼šåŒ…å«å¤šä¸ªæ¨¡å—çš„ç›®å½•
3. **å¯¼å…¥**ï¼šä½¿ç”¨å…¶ä»–æ¨¡å—çš„åŠŸèƒ½
4. **å‘½åç©ºé—´**ï¼šé¿å…åç§°å†²çª
5. **æœç´¢è·¯å¾„**ï¼šPythonæŸ¥æ‰¾æ¨¡å—çš„ä½ç½®

### 8.2 æœ€ä½³å®è·µæ€»ç»“

1. **æ¨¡å—è®¾è®¡**ï¼š
   - å•ä¸€èŒè´£åŸåˆ™
   - æ¸…æ™°çš„æ¥å£è®¾è®¡
   - å®Œå–„çš„æ–‡æ¡£å­—ç¬¦ä¸²
   - åˆç†çš„é”™è¯¯å¤„ç†

2. **åŒ…ç»„ç»‡**ï¼š
   - é€»è¾‘æ¸…æ™°çš„ç›®å½•ç»“æ„
   - é€‚å½“çš„`__init__.py`æ–‡ä»¶
   - æ˜ç¡®çš„`__all__`å®šä¹‰

3. **å¯¼å…¥è§„èŒƒ**ï¼š
   - ä¼˜å…ˆä½¿ç”¨å…·ä½“å¯¼å…¥
   - é¿å…å¾ªç¯å¯¼å…¥
   - åˆç†ä½¿ç”¨åˆ«å

4. **ä»£ç è´¨é‡**ï¼š
   - ç¼–å†™å•å…ƒæµ‹è¯•
   - ä½¿ç”¨ç±»å‹æ³¨è§£
   - éµå¾ªPEP 8è§„èŒƒ






























